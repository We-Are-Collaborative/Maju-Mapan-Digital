/*
 *             Copyright (c) 2003-2025, CKSource Holding sp. z o.o. All rights reserved.
 *
 *
 *
 *
 *          +---------------------------------------------------------------------------------+
 *          |                                                                                 |
 *          |                                 Hello stranger!                                 |
 *          |                                                                                 |
 *          |                                                                                 |
 *          |   What you're currently looking at is the source code of a legally protected,   |
 *          |    proprietary software. Any attempts to deobfuscate / disassemble this code    |
 *          |               are forbidden and will result in legal consequences.              |
 *          |                                                                                 |
 *          |                                                                                 |
 *          +---------------------------------------------------------------------------------+
 *
 *
 *
 *
 */
const _0x36baa2=_0xfaee;function _0x3bfe(){const _0x5cbad2=['_prepareRequestHeaders','5452370OgLuDQ','prepareMessages','context_length_exceeded','stringify','4FzCioa','96czBeSC','ai.openAI.apiUrl','_requestHeaders','split','data:\x20','148rRvUzx','message','1545350ZVtsHA','https://api.openai.com/v1/chat/completions','gpt-3.5-turbo','_readStaticResponse','map','delta','ai.openAI.requestParameters','json','sendRequest','user','[DONE]','system','includes','signal','config','ai.openAI.requestHeaders','read','abortController','_apiUrl','_prepareRequestParameters','_readStreamableResponse','length','editor','text','body','AI_ERROR_CONTEXT_LENGTH','content','632394rggdBb','1764555gJKkdQ','filter','254HFvsLz','reject','locale','3452430LUAxuI','_cleanUpData','join','define','OpenAITextAdapter','\x0aYou\x20must\x20keep\x20the\x20text\x20formatting.\x0a\x0aContent:\x0a','stream','Instruction:\x0a','AI_ERROR_MODERATION','getReader','Your\x20task\x20is\x20to\x20generate\x20HTML\x20content\x20accordingly\x20to\x20the\x20given\x20instruction.\x20Never\x20include\x20<img>\x20tag\x20in\x20your\x20response\x20even\x20if\x20asked\x20for.\x20Your\x20answer\x20must\x20be\x20a\x20well-structured\x20and\x20properly\x20formatted\x20HTML\x20code.\x20Answer\x20only\x20with\x20the\x20generated\x20HTML\x20content.\x20Do\x20not\x20add\x20any\x20additional\x20remarks\x20or\x20notes.\x20Do\x20not\x20act\x20like\x20a\x20chatbot\x20or\x20a\x20real\x20person.','decode','get','choices','pluginName','resolve','POST','_isBufferIncomplete','Your\x20task\x20is\x20to\x20execute\x20the\x20instruction\x20using\x20the\x20provided\x20HTML\x20content.\x20Follow\x20the\x20instruction\x20closely.\x20Your\x20answer\x20must\x20be\x20a\x20properly\x20formatted\x20HTML\x20code.\x20Do\x20not\x20add\x20any\x20additional\x20remarks\x20or\x20notes.\x20Do\x20not\x20act\x20like\x20a\x20chatbot\x20or\x20a\x20real\x20person.','parse','Moderation','_requestParameters','538980avPjAz','replace'];_0x3bfe=function(){return _0x5cbad2;};return _0x3bfe();}(function(_0x114e0b,_0x4c57e9){const _0x436a53=_0xfaee,_0x17dfef=_0x114e0b();while(!![]){try{const _0x24fdfc=-parseInt(_0x436a53(0x1a7))/0x1*(-parseInt(_0x436a53(0x181))/0x2)+-parseInt(_0x436a53(0x17f))/0x3+parseInt(_0x436a53(0x1a1))/0x4*(parseInt(_0x436a53(0x1a9))/0x5)+parseInt(_0x436a53(0x184))/0x6+-parseInt(_0x436a53(0x19d))/0x7+-parseInt(_0x436a53(0x1a2))/0x8*(-parseInt(_0x436a53(0x17e))/0x9)+parseInt(_0x436a53(0x19a))/0xa;if(_0x24fdfc===_0x4c57e9)break;else _0x17dfef['push'](_0x17dfef['shift']());}catch(_0x565f31){_0x17dfef['push'](_0x17dfef['shift']());}}}(_0x3bfe,0x69c72));import{default as _0x17e8d9}from'./aitextadapter.js';function _0xfaee(_0x57ce3e,_0xd30272){const _0x3bfe49=_0x3bfe();return _0xfaee=function(_0xfaee45,_0xfe0404){_0xfaee45=_0xfaee45-0x17a;let _0x35a628=_0x3bfe49[_0xfaee45];return _0x35a628;},_0xfaee(_0x57ce3e,_0xd30272);}import{AIRequestError as _0x10edbb}from'./aiadapter.js';import{getTranslation as _0x1b1477}from'../utils/common-translations.js';export default class O extends _0x17e8d9{[_0x36baa2(0x1bb)];[_0x36baa2(0x1a4)];[_0x36baa2(0x199)];static get[_0x36baa2(0x192)](){const _0x434933=_0x36baa2;return _0x434933(0x188);}constructor(_0x345052){const _0x19292f=_0x36baa2;super(_0x345052),_0x345052[_0x19292f(0x1b7)][_0x19292f(0x187)](_0x19292f(0x1a3),_0x19292f(0x1aa)),_0x345052[_0x19292f(0x1b7)][_0x19292f(0x190)](_0x19292f(0x1af))||_0x345052[_0x19292f(0x1b7)][_0x19292f(0x187)](_0x19292f(0x1af),{'model':_0x19292f(0x1ab),'max_tokens':0x7d0,'temperature':0x1,'top_p':0x1,'stream':!0x0}),this[_0x19292f(0x1bb)]=_0x345052[_0x19292f(0x1b7)][_0x19292f(0x190)](_0x19292f(0x1a3)),this[_0x19292f(0x1a4)]=_0x345052[_0x19292f(0x1b7)][_0x19292f(0x190)](_0x19292f(0x1b8))||{},this[_0x19292f(0x199)]=_0x345052[_0x19292f(0x1b7)][_0x19292f(0x190)](_0x19292f(0x1af));}async[_0x36baa2(0x1b1)]({query:_0x264247,context:_0xacf74e,onData:_0x6283eb,actionId:_0x24129a}){const _0x50c716=_0x36baa2,_0x5d911c=this[_0x50c716(0x1bf)][_0x50c716(0x183)],_0x50dbb8=await this[_0x50c716(0x19e)](_0x264247,_0xacf74e,_0x24129a),_0x233fe5=await this[_0x50c716(0x19c)](this[_0x50c716(0x1a4)],_0x24129a),_0x5575b2=await this[_0x50c716(0x1bc)](this[_0x50c716(0x199)],_0x24129a),_0x3d7241={'messages':_0x50dbb8,..._0x5575b2},_0x3cd9cd={'method':_0x50c716(0x194),'headers':_0x233fe5,'body':JSON[_0x50c716(0x1a0)](_0x3d7241),'signal':this[_0x50c716(0x1ba)][_0x50c716(0x1b6)]},_0x233730=await fetch(this[_0x50c716(0x1bb)],_0x3cd9cd);if(_0x233730['ok'])return _0x5575b2[_0x50c716(0x18a)]?await this[_0x50c716(0x1bd)](_0x233730,_0x6283eb):await this[_0x50c716(0x1ac)](_0x233730,_0x6283eb),Promise[_0x50c716(0x193)]();{const _0x56589f=await _0x233730[_0x50c716(0x17a)]();return _0x56589f[_0x50c716(0x1b5)](_0x50c716(0x19f))?Promise[_0x50c716(0x182)](new _0x10edbb(_0x1b1477(_0x5d911c,_0x50c716(0x17c)))):_0x56589f[_0x50c716(0x1b5)](_0x50c716(0x198))?Promise[_0x50c716(0x182)](new _0x10edbb(_0x1b1477(_0x5d911c,_0x50c716(0x18c)))):Promise[_0x50c716(0x182)](new Error(_0x56589f));}}async[_0x36baa2(0x19e)](_0x761244,_0x1f175a,_0x18dfe8){const _0x5b9840=_0x36baa2;let _0x10ff9e,_0x365dc9;return _0x1f175a?(_0x10ff9e=_0x5b9840(0x196),_0x365dc9=_0x5b9840(0x18b)+_0x761244+_0x5b9840(0x189)+_0x1f175a):(_0x10ff9e=_0x5b9840(0x18e),_0x365dc9=_0x761244),[{'role':_0x5b9840(0x1b4),'content':_0x10ff9e},{'role':_0x5b9840(0x1b2),'content':_0x365dc9}];}async[_0x36baa2(0x1bd)](_0x5319f0,_0x59a93e){const _0x57b17f=_0x36baa2,_0x5b7bf3=_0x5319f0[_0x57b17f(0x17b)][_0x57b17f(0x18d)](),_0x5454b3=new TextDecoder();let _0x5e1456='',_0x50cd55='',_0x4a6cb='',_0x142262=!0x1;for(;!_0x142262;){const {done:_0x3d56f1,value:_0x1ab970}=await _0x5b7bf3[_0x57b17f(0x1b9)](),_0x5676bb=_0x5e1456+_0x5454b3[_0x57b17f(0x18f)](_0x1ab970);let _0x46ee2f='';_0x142262=_0x3d56f1;try{_0x46ee2f=this[_0x57b17f(0x185)](_0x5676bb),_0x5e1456='';}catch{_0x5e1456=_0x5676bb;continue;}_0x50cd55+=_0x46ee2f,!_0x142262&&this[_0x57b17f(0x195)](_0x50cd55)||_0x50cd55&&(_0x4a6cb+=_0x50cd55,_0x50cd55='',_0x59a93e(_0x4a6cb));}return Promise[_0x57b17f(0x193)]();}async[_0x36baa2(0x1ac)](_0x5f47f0,_0x20672e){const _0x22a760=_0x36baa2;return _0x20672e((await _0x5f47f0[_0x22a760(0x1b0)]())[_0x22a760(0x191)][0x0][_0x22a760(0x1a8)][_0x22a760(0x17d)]),Promise[_0x22a760(0x193)]();}[_0x36baa2(0x195)](_0x113547){const _0x108b50=_0x36baa2,_0x23d8c1=_0x113547[_0x108b50(0x1a5)]('<')[_0x108b50(0x1be)]!==_0x113547[_0x108b50(0x1a5)]('>')[_0x108b50(0x1be)],_0x18117f=_0x113547[_0x108b50(0x1be)]<0x1e;return _0x23d8c1&&_0x18117f;}[_0x36baa2(0x185)](_0x43d1db){const _0x4003ec=_0x36baa2;return _0x43d1db[_0x4003ec(0x1a5)](/\n(?![^{]*\})/g)[_0x4003ec(0x1ad)](_0x27db80=>_0x27db80[_0x4003ec(0x19b)](_0x4003ec(0x1a6),''))[_0x4003ec(0x180)](_0x1701db=>_0x1701db&&_0x1701db[_0x4003ec(0x1be)]>0x0&&_0x4003ec(0x1b3)!==_0x1701db)[_0x4003ec(0x1ad)](_0x1cf9f4=>{const _0x5bee19=_0x4003ec,{choices:_0x47f5eb}=JSON[_0x5bee19(0x197)](_0x1cf9f4);if(_0x47f5eb[0x0]?.[_0x5bee19(0x1ae)]?.[_0x5bee19(0x17d)])return _0x47f5eb[0x0][_0x5bee19(0x1ae)][_0x5bee19(0x17d)];})[_0x4003ec(0x180)](_0x42eb6f=>_0x42eb6f)[_0x4003ec(0x186)]('');}}