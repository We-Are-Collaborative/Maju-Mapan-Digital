/*
 *             Copyright (c) 2003-2025, CKSource Holding sp. z o.o. All rights reserved.
 *
 *
 *
 *
 *          +---------------------------------------------------------------------------------+
 *          |                                                                                 |
 *          |                                 Hello stranger!                                 |
 *          |                                                                                 |
 *          |                                                                                 |
 *          |   What you're currently looking at is the source code of a legally protected,   |
 *          |    proprietary software. Any attempts to deobfuscate / disassemble this code    |
 *          |               are forbidden and will result in legal consequences.              |
 *          |                                                                                 |
 *          |                                                                                 |
 *          +---------------------------------------------------------------------------------+
 *
 *
 *
 *
 */
import{Command as _0x148680,Plugin as _0x38796b}from'@ckeditor/ckeditor5-core/dist/index.js';import{ButtonView as _0x491edb,MenuBarMenuListItemButtonView as _0xca0ef1,SpinnerView as _0x28fe19,Notification as _0x3a69dd}from'@ckeditor/ckeditor5-ui/dist/index.js';import{collectStylesheets as _0xa4f56c}from'@ckeditor/ckeditor5-utils/dist/index.js';import{IconExportPdf as _0xa8b5d5}from'@ckeditor/ckeditor5-icons/dist/index.js';function d(_0x4e6f31,_0x26978c){const t=_0x4e6f31['t'];switch(_0x26978c){case'Export\x20to\x20PDF':return t('Export\x20to\x20PDF');case'An\x20error\x20occurred\x20while\x20generating\x20the\x20PDF.':return t('An\x20error\x20occurred\x20while\x20generating\x20the\x20PDF.');case'PDF\x20export\x20started':return t('PDF\x20export\x20started');case'PDF\x20export\x20failed':return t('PDF\x20export\x20failed');case'PDF\x20export\x20successful':return t('PDF\x20export\x20successful');case'Exporting\x20PDF\x20document':return t('Exporting\x20PDF\x20document');default:return _0x26978c;}}class i extends _0x148680{constructor(_0x5eaaea){super(_0x5eaaea),this['set']('isBusy',!0x1),this['affectsData']=!0x1;}['refresh'](){this['isEnabled']=!this['isBusy'],this['value']=this['isBusy']?'pending':void 0x0;}['execute'](_0xf160e5={}){const _0xc3e007=this['editor'],_0x46b657=_0xf160e5['converterUrl']||'https://pdf-converter.cke-cs.com/v1/convert/',_0xc0be6a=_0xf160e5['dataCallback']||(_0xa13fd9=>_0xa13fd9['data']['get']()),_0x2d887a=_0xc3e007['plugins']['get']('ExportPdf'),_0x113e39=_0xf160e5['token']||_0x2d887a['_token'];return this['isBusy']=!0x0,this['refresh'](),_0xa4f56c(_0xf160e5['stylesheets']||['EDITOR_STYLES'])['then'](async _0x5494b6=>{if(_0xc3e007['ui']['ariaLiveAnnouncer']['announce'](d(_0xc3e007['locale'],'PDF\x20export\x20started')),_0xc3e007['plugins']['has']('MergeFields')){_0xf160e5['converterOptions']||(_0xf160e5['converterOptions']={});const _0x58d883=_0xc3e007['plugins']['get']('MergeFieldsEditing'),_0x22c683=_0x58d883['previewMode'],{prefix:_0x24e97a,suffix:_0x415070}=_0xc3e007['config']['get']('mergeFields'),_0x30f69a='data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAQAAAC1HAwCAAAAC0lEQVR42mP88B8AAuUB8e2ujYwAAAAASUVORK5CYII=',_0x112148={'prefix':_0x24e97a,'suffix':_0x415070,'data':{}};if('$labels'===_0x22c683){for(const _0x828981 of _0x58d883['getMergeFieldsIds']())'image'===_0x58d883['getMergeFieldType'](_0x828981)?_0x112148['data'][_0x828981]=_0x30f69a:_0x112148['data'][_0x828981]=_0x58d883['wrapInAffixes'](_0x58d883['getLabel'](_0x828981)||_0x828981);}else{const _0x1d98f5='$defaultValues'===_0x22c683?_0x58d883['getDefaultValues']():_0x58d883['getDataSetValues'](_0x22c683,!0x0);for(const _0x5c70af of Object['entries'](_0x1d98f5)){const [_0x32ed3d,_0x521549]=_0x5c70af;'image'===_0x58d883['getMergeFieldType'](_0x32ed3d)?_0x112148['data'][_0x32ed3d]=null!==_0x521549?_0x521549:_0x30f69a:_0x112148['data'][_0x32ed3d]=null!==_0x521549?_0x521549:_0x58d883['getLabel'](_0x32ed3d)||_0x32ed3d;}}_0xf160e5['converterOptions']['merge_fields']=_0x112148;}const _0x5de5d6={'html':'<html>\x0a\x09\x09\x09\x09\x09\x09<head>\x0a\x09\x09\x09\x09\x09\x09\x09<title>CKEditor\x205\x20PDF\x20document</title>\x0a\x09\x09\x09\x09\x09\x09\x09<meta\x20charset=\x22utf-8\x22>\x0a\x09\x09\x09\x09\x09\x09</head>\x0a\x09\x09\x09\x09\x09\x09<body>\x0a\x09\x09\x09\x09\x09\x09\x09<div\x20class=\x22ck-content\x22\x20dir=\x22'+_0xc3e007['locale']['contentLanguageDirection']+'\x22>\x0a\x09\x09\x09\x09\x09\x09\x09\x09'+await _0xc0be6a(_0xc3e007)+'\x0a\x09\x09\x09\x09\x09\x09\x09</div>\x0a\x09\x09\x09\x09\x09\x09</body>\x0a\x09\x09\x09\x09\x09</html>','css':_0x5494b6,'options':_0xf160e5['converterOptions']},_0x3df7f6={'method':'POST','headers':{'Content-Type':'application/json','Accept':'application/pdf',..._0x113e39?{'Authorization':_0x113e39['value']}:null,'x-cs-app-id':_0xf160e5['appID']||'cke5'},'body':JSON['stringify'](_0x5de5d6)};return window['fetch'](_0x46b657,_0x3df7f6)['then'](_0x306747=>{if(0xc8!==_0x306747['status'])throw _0x306747;return _0x306747['blob']();})['then'](_0x2f0eda=>{_0xc3e007['ui']['ariaLiveAnnouncer']['announce'](d(_0xc3e007['locale'],'PDF\x20export\x20successful'));const _0x2cd330='function'==typeof _0xf160e5['fileName']?_0xf160e5['fileName']():_0xf160e5['fileName'];this['_downloadFile'](_0x2f0eda,_0x2cd330||'document.pdf');});})['catch'](_0x48c19d=>{const _0x34f271=_0xc3e007['plugins']['get']('Notification');throw _0xc3e007['ui']['ariaLiveAnnouncer']['announce'](d(_0xc3e007['locale'],'PDF\x20export\x20failed'),{'politeness':'assertive'}),_0x34f271['showWarning'](d(_0xc3e007['locale'],'An\x20error\x20occurred\x20while\x20generating\x20the\x20PDF.')),_0x48c19d;})['finally'](()=>{this['isBusy']=!0x1,this['refresh']();});}['_downloadFile'](_0xad80da,_0x51ae4e){const _0x116382=document['createElement']('a');_0x116382['href']=window['URL']['createObjectURL'](_0xad80da),_0x116382['download']=_0x51ae4e,_0x116382['click'](),_0x116382['remove']();}}class s extends _0x38796b{static get['pluginName'](){return'ExportPdfUI';}static get['isOfficialPlugin'](){return!0x0;}static get['isPremiumPlugin'](){return!0x0;}['init'](){const _0x37b232=this['editor'];_0x37b232['ui']['componentFactory']['add']('exportPdf',()=>{const _0x39c921=this['_createButton'](_0x491edb),_0x303407=_0x37b232['commands']['get']('exportPdf');return _0x39c921['set']({'tooltip':!0x0}),_0x39c921['bind']('isOn')['to'](_0x303407,'isBusy'),_0x39c921;}),_0x37b232['ui']['componentFactory']['add']('menuBar:exportPdf',()=>this['_createButton'](_0xca0ef1));}['_createButton'](_0x36495f){const _0x456488=this['editor'],_0xb31669=_0x456488['config']['get']('exportPdf')||{},_0x488292=_0x456488['commands']['get']('exportPdf'),_0x47d7ca=new _0x36495f(_0x456488['locale']),_0x229580=new _0x28fe19();return _0x47d7ca['children']['add'](_0x229580),_0x229580['bind']('isVisible')['to'](_0x488292,'isBusy'),_0x47d7ca['iconView']['bind']('isVisible')['to'](_0x488292,'isBusy',_0x44773f=>!_0x44773f),_0x47d7ca['set']({'icon':_0xa8b5d5}),_0x47d7ca['bind']('isEnabled')['to'](_0x488292,'isEnabled'),_0x47d7ca['bind']('label')['to'](_0x488292,'isBusy',_0x2fd81f=>d(_0x456488['locale'],_0x2fd81f?'Exporting\x20PDF\x20document':'Export\x20to\x20PDF')),this['listenTo'](_0x47d7ca,'execute',()=>{_0x456488['execute']('exportPdf',_0xb31669),_0x456488['editing']['view']['focus']();}),_0x47d7ca;}}class o extends _0x38796b{['_token'];static get['pluginName'](){return'ExportPdf';}static get['isOfficialPlugin'](){return!0x0;}static get['isPremiumPlugin'](){return!0x0;}static get['requires'](){return['CloudServices',_0x3a69dd,s];}['init'](){const _0x573f99=this['editor'],_0x517f68=_0x573f99['config']['get']('exportPdf')||{};_0x573f99['commands']['add']('exportPdf',new i(_0x573f99));const _0x4207f7=_0x573f99['plugins']['get']('CloudServices');!0x1===_0x517f68['tokenUrl']?this['_token']=null:_0x517f68['tokenUrl']?_0x4207f7['registerTokenUrl'](_0x517f68['tokenUrl'])['then'](_0x5249d1=>{this['_token']=_0x5249d1;}):this['_token']=_0x4207f7['token'];}}export{o as ExportPdf};