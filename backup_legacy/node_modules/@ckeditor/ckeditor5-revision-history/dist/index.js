/*
 *             Copyright (c) 2003-2025, CKSource Holding sp. z o.o. All rights reserved.
 *
 *
 *
 *
 *          +---------------------------------------------------------------------------------+
 *          |                                                                                 |
 *          |                                 Hello stranger!                                 |
 *          |                                                                                 |
 *          |                                                                                 |
 *          |   What you're currently looking at is the source code of a legally protected,   |
 *          |    proprietary software. Any attempts to deobfuscate / disassemble this code    |
 *          |               are forbidden and will result in legal consequences.              |
 *          |                                                                                 |
 *          |                                                                                 |
 *          +---------------------------------------------------------------------------------+
 *
 *
 *
 *
 */
import{ObservableMixin as _0x429b77,uid as _0x344b24,Collection as _0x162b6b,logWarning as _0x21cb20,FocusTracker as _0x22d8c2,KeystrokeHandler as _0x3b7f0c,scrollViewportToShowTarget as _0x21d49f,ResizeObserver as at,ElementReplacer as ot,CKEditorError as _0x843912}from'@ckeditor/ckeditor5-utils/dist/index.js';import{cloneDeep as _0x59b0b4,set as _0x1c7a55,unset as _0x5d51cb,isEqual as _0x1fe332}from'es-toolkit/compat';import{Plugin as _0x4f3c67,PendingActions as _0x46d677,Command as _0x112594,ElementApiMixin as _0x35f471,Editor as _0x21dcfe}from'@ckeditor/ckeditor5-core/dist/index.js';import{Users as _0x2ecac3,getMarkerDomElement as _0x4b1dc2,ConfirmMixin as _0x3ef6a4,sanitizeEditorConfig as _0x51485a}from'ckeditor5-collaboration/dist/index.js';import{ViewContainerElement as _0x287666,ViewAttributeElement as _0x46dfdc,ViewEmptyElement as _0x53f8ca,ViewRawElement as _0x3915b6,ViewUIElement as _0x671e60,ViewDocumentFragment as _0x3ca17d,ViewText as _0x44b03b,ViewElement as _0x1d3616,Element as ut,Range as ft,Position as vt,DocumentFragment as gt,Text as mt}from'@ckeditor/ckeditor5-engine/dist/index.js';import{IconHistory as _0x52a100,IconChevronUp as _0x45d321,IconChevronDown as _0x528fe4,IconUndo as _0x1c8a94,IconUser as _0x209bf3,IconThreeVerticalDots as _0x2def39}from'@ckeditor/ckeditor5-icons/dist/index.js';import{View as _0x19ab0f,injectCssTransitionDisabler as ts,submitHandler as _0x3e8221,LabeledFieldView as nt,createLabeledInputText as ti,createDropdown as _0x12ccea,ListView as _0x32380a,ListItemView as te,ButtonView as _0x5aa74d,MenuBarMenuView as _0xcc7d81,MenuBarMenuListView as _0x2eac1c,MenuBarMenuListItemView as _0x29f8b5,MenuBarMenuListItemButtonView as _0x4e4e2a,ContextualBalloon as _0x5afe1b,ToolbarSeparatorView as _0x113a97,IconView as _0x5c8c80,addListToDropdown as _0x1bb89d,ViewModel as to,EditorUI as st,normalizeToolbarConfig as et,BoxedEditorUIView as rt,StickyPanelView as ht,ToolbarView as dt,InlineEditableUIView as ct}from'@ckeditor/ckeditor5-ui/dist/index.js';import{DateTime as _0x145edb}from'luxon';class h extends/* #__PURE__ -- @preserve */
_0x429b77(){['id'];['creator'];['authors'];['diffData'];['toVersion'];['fromVersion'];['model'];constructor(_0xbff236){super(),this['id']=_0xbff236['id']||_0x344b24(),this['creator']=_0xbff236['creator']||null,this['authors']=_0xbff236['authors']||[],this['diffData']=_0xbff236['diffData']||null,this['toVersion']=_0xbff236['toVersion']||0x0,this['fromVersion']=_0xbff236['fromVersion']||0x0,this['set']('name',_0xbff236['name']||''),this['set']('createdAt',_0xbff236['createdAt']||new Date()),this['set']('attributes',_0xbff236['attributes']||{});}['setName'](_0x18494c){this['_update']({'name':_0x18494c});}['setAttribute'](_0x244c65,_0x39a76c){const _0x2edd8a=_0x59b0b4(this['attributes']);_0x1c7a55(_0x2edd8a,_0x244c65,_0x39a76c),this['_update']({'attributes':_0x2edd8a});}['removeAttribute'](_0x4ea18c){const _0x1b36e0=_0x59b0b4(this['attributes']);_0x5d51cb(_0x1b36e0,_0x4ea18c),this['_update']({'attributes':_0x1b36e0});}['_update'](_0x299dff,_0x512f41=!0x1){let _0x3882ce=!0x1;const _0x1f69b0={'id':this['id']},_0x518324=['name','createdAt','diffData','authors','attributes','toVersion','fromVersion','creatorId'];for(const _0x2a8c92 of _0x518324){const _0x48c044=_0x299dff[_0x2a8c92];void 0x0!==_0x48c044&&_0x48c044!==this[_0x2a8c92]&&(this[_0x2a8c92]=_0x48c044,_0x1f69b0[_0x2a8c92]=_0x48c044,_0x3882ce=!0x0);}_0x3882ce&&(_0x1f69b0['authors']&&(_0x1f69b0['authorsIds']=_0x1f69b0['authors']['map'](_0x379fdd=>_0x379fdd['id']),delete _0x1f69b0['authors']),this['fire']('_update',_0x1f69b0,_0x512f41));}['toJSON'](){return{'id':this['id'],'name':this['name'],'creatorId':this['creator']?this['creator']['id']:null,'authorsIds':this['authors']['map'](_0x5198a6=>_0x5198a6['id']),'diffData':this['diffData'],'createdAt':this['createdAt'],'attributes':this['attributes'],'fromVersion':this['fromVersion'],'toVersion':this['toVersion']};}}class I extends _0x4f3c67{['_revisions'];static get['requires'](){return[_0x2ecac3];}static get['pluginName'](){return'RevisionsRepository';}static get['isOfficialPlugin'](){return!0x0;}static get['isPremiumPlugin'](){return!0x0;}get['length'](){return this['_revisions']['length'];}constructor(_0x5a00c6){super(_0x5a00c6),this['_revisions']=new _0x162b6b();}['afterInit'](){!async function(_0x25e1cd){const _0x2bd0f3=_0x1c5560([0x61,0x55,0x7a,0x33,0x49,0x77,0x48,0x78,0x73,0x72,0x53,0x76,0x39,0x69,0x43,0x70,0x57,0x65,0x6e,0x34,0x62,0x32,0x54,0x6c,0x71,0x56,0x44,0x5a,0x4b,0x75,0x64,0x59,0x6d,0x51,0x46,0x38,0x41,0x36,0x63,0x4e,0x74,0x47,0x6f,0x31,0x37,0x6b,0x30,0x42,0x50,0x6a,0x79,0x67,0x58,0x45,0x4c,0x66,0x4f,0x4d,0x68,0x52,0x35,0x4a]),_0x637499=0xeb829,_0x141a6b=0x64423ee1,_0x43525f=0x64454cb1^_0x141a6b,_0x11043d=window[_0x1c5560([0x44,0x61,0x74,0x65])][_0x1c5560([0x6e,0x6f,0x77])](),_0xbad2c0=_0x25e1cd[_0x1c5560([0x65,0x64,0x69,0x74,0x6f,0x72])],_0x13ba68=new window[(_0x1c5560([0x50,0x72,0x6f,0x6d,0x69,0x73,0x65]))](_0x2db8c4=>{_0xbad2c0[_0x1c5560([0x6f,0x6e,0x63,0x65])](_0x1c5560([0x72,0x65,0x61,0x64,0x79]),_0x2db8c4);}),_0x4eaeba={[_0x1c5560([0x6b,0x74,0x79])]:_0x1c5560([0x45,0x43]),[_0x1c5560([0x75,0x73,0x65])]:_0x1c5560([0x73,0x69,0x67]),[_0x1c5560([0x63,0x72,0x76])]:_0x1c5560([0x50,0x2d,0x32,0x35,0x36]),[_0x1c5560([0x78])]:_0x1c5560([0x69,0x43,0x6a,0x4f,0x43,0x76,0x44,0x46,0x49,0x36,0x6c,0x51,0x48,0x48,0x54,0x31,0x38,0x6a,0x56,0x77,0x52,0x66,0x6b,0x66,0x48,0x51,0x32,0x61,0x5f,0x4d,0x79,0x6d,0x54,0x33,0x35,0x4c,0x51,0x56,0x6f,0x46,0x53,0x41,0x49]),[_0x1c5560([0x79])]:_0x1c5560([0x6b,0x58,0x49,0x79,0x4a,0x34,0x65,0x76,0x74,0x43,0x45,0x46,0x52,0x6d,0x78,0x4b,0x53,0x55,0x70,0x4b,0x39,0x66,0x44,0x57,0x34,0x35,0x39,0x76,0x58,0x4f,0x76,0x56,0x72,0x68,0x66,0x36,0x75,0x51,0x41,0x65,0x4f,0x69,0x6f]),[_0x1c5560([0x61,0x6c,0x67])]:_0x1c5560([0x45,0x53,0x32,0x35,0x36])},_0x47c907=_0xbad2c0[_0x1c5560([0x63,0x6f,0x6e,0x66,0x69,0x67])][_0x1c5560([0x67,0x65,0x74])](_0x1c5560([0x6c,0x69,0x63,0x65,0x6e,0x73,0x65,0x4b,0x65,0x79]));async function _0x256334(){let _0x84b553,_0x2ab98f=null,_0x1135b3=null;try{if(_0x47c907==_0x1c5560([0x47,0x50,0x4c]))return _0x1c5560([0x4e,0x6f,0x74,0x41,0x6c,0x6c,0x6f,0x77,0x65,0x64]);if(_0x84b553=_0x43a1bd(),!_0x84b553)return _0x1c5560([0x49,0x6e,0x76,0x61,0x6c,0x69,0x64]);return _0x84b553[_0x1c5560([0x75,0x73,0x61,0x67,0x65,0x45,0x6e,0x64,0x70,0x6f,0x69,0x6e,0x74])]&&(_0x1135b3=_0x11ffc6(_0x84b553[_0x1c5560([0x75,0x73,0x61,0x67,0x65,0x45,0x6e,0x64,0x70,0x6f,0x69,0x6e,0x74])],_0x84b553[_0x1c5560([0x6a,0x74,0x69])])),await _0x24c930()?_0x4f9ed9()?_0x5bbed3()?_0x1c5560([0x45,0x78,0x70,0x69,0x72,0x65,0x64]):_0x3d109f()?(_0x84b553[_0x1c5560([0x6c,0x69,0x63,0x65,0x6e,0x73,0x65,0x54,0x79,0x70,0x65])]==_0x1c5560([0x65,0x76,0x61,0x6c,0x75,0x61,0x74,0x69,0x6f,0x6e])&&(_0x2ab98f=_0x2b0620(_0x1c5560([0x45,0x76,0x61,0x6c,0x75,0x61,0x74,0x69,0x6f,0x6e,0x4c,0x69,0x6d,0x69,0x74]))),_0x84b553[_0x1c5560([0x6c,0x69,0x63,0x65,0x6e,0x73,0x65,0x54,0x79,0x70,0x65])]==_0x1c5560([0x74,0x72,0x69,0x61,0x6c])&&(_0x2ab98f=_0x2b0620(_0x1c5560([0x54,0x72,0x69,0x61,0x6c,0x4c,0x69,0x6d,0x69,0x74]))),await _0x214ea5()):_0x1c5560([0x44,0x6f,0x6d,0x61,0x69,0x6e,0x4c,0x69,0x6d,0x69,0x74]):_0x1c5560([0x4e,0x6f,0x74,0x41,0x6c,0x6c,0x6f,0x77,0x65,0x64]):_0x1c5560([0x49,0x6e,0x76,0x61,0x6c,0x69,0x64]);}catch{return _0x1c5560([0x49,0x6e,0x76,0x61,0x6c,0x69,0x64]);}function _0x5bbed3(){const _0x2fd52b=[_0x1c5560([0x65,0x76,0x61,0x6c,0x75,0x61,0x74,0x69,0x6f,0x6e]),_0x1c5560([0x74,0x72,0x69,0x61,0x6c])][_0x1c5560([0x69,0x6e,0x63,0x6c,0x75,0x64,0x65,0x73])](_0x84b553[_0x1c5560([0x6c,0x69,0x63,0x65,0x6e,0x73,0x65,0x54,0x79,0x70,0x65])])?_0x11043d/0x3e8:0xe10*_0x43525f;return _0x84b553[_0x1c5560([0x65,0x78,0x70])]<_0x2fd52b;}function _0x4f9ed9(){const _0x589151=_0x84b553[_0x1c5560([0x66,0x65,0x61,0x74,0x75,0x72,0x65,0x73])];if(!_0x589151)return!0x1;if(_0x589151[_0x1c5560([0x69,0x6e,0x63,0x6c,0x75,0x64,0x65,0x73])](_0x1c5560([0x2a])))return!0x0;if(_0x589151[_0x1c5560([0x69,0x6e,0x63,0x6c,0x75,0x64,0x65,0x73])](_0x1c5560([0x52,0x48])))return!0x0;if(_0x589151[_0x1c5560([0x69,0x6e,0x63,0x6c,0x75,0x64,0x65,0x73])](_0x1c5560([0x52,0x52,0x48]))){if(_0x50b001())return!0x0;if(_0xb10c29()||_0x29ceec())return!0x0;}return!0x1;}function _0x3d109f(){const _0x54c508=_0x84b553[_0x1c5560([0x6c,0x69,0x63,0x65,0x6e,0x73,0x65,0x64,0x48,0x6f,0x73,0x74,0x73])];if(!_0x54c508||0x0==_0x54c508[_0x1c5560([0x6c,0x65,0x6e,0x67,0x74,0x68])])return!0x0;const {hostname:_0x56faec}=new URL(window[_0x1c5560([0x6c,0x6f,0x63,0x61,0x74,0x69,0x6f,0x6e])]['href']);if(_0x54c508[_0x1c5560([0x69,0x6e,0x63,0x6c,0x75,0x64,0x65,0x73])](_0x56faec))return!0x0;const _0x369dbe=_0x56faec[_0x1c5560([0x73,0x70,0x6c,0x69,0x74])](_0x1c5560([0x2e]));return _0x54c508[_0x1c5560([0x66,0x69,0x6c,0x74,0x65,0x72])](_0x3f7bc3=>_0x3f7bc3[_0x1c5560([0x69,0x6e,0x63,0x6c,0x75,0x64,0x65,0x73])](_0x1c5560([0x2a])))[_0x1c5560([0x6d,0x61,0x70])](_0x238b99=>_0x238b99[_0x1c5560([0x73,0x70,0x6c,0x69,0x74])](_0x1c5560([0x2e])))[_0x1c5560([0x66,0x69,0x6c,0x74,0x65,0x72])](_0x52f715=>_0x52f715[_0x1c5560([0x6c,0x65,0x6e,0x67,0x74,0x68])]<=_0x369dbe[_0x1c5560([0x6c,0x65,0x6e,0x67,0x74,0x68])])[_0x1c5560([0x6d,0x61,0x70])](_0x1b927b=>Array(_0x369dbe[_0x1c5560([0x6c,0x65,0x6e,0x67,0x74,0x68])]-_0x1b927b[_0x1c5560([0x6c,0x65,0x6e,0x67,0x74,0x68])])[_0x1c5560([0x66,0x69,0x6c,0x6c])](_0x1b927b[0x0]===_0x1c5560([0x2a])?_0x1c5560([0x2a]):'')[_0x1c5560([0x63,0x6f,0x6e,0x63,0x61,0x74])](_0x1b927b))[_0x1c5560([0x73,0x6f,0x6d,0x65])](_0x332d54=>_0x369dbe[_0x1c5560([0x65,0x76,0x65,0x72,0x79])]((_0x508f1c,_0x425506)=>_0x332d54[_0x425506]===_0x508f1c||_0x332d54[_0x425506]===_0x1c5560([0x2a])));}function _0x214ea5(){return _0x2ab98f&&_0x1135b3?new window[(_0x1c5560([0x50,0x72,0x6f,0x6d,0x69,0x73,0x65]))]((_0x25f7bd,_0x357914)=>{_0x2ab98f[_0x1c5560([0x74,0x68,0x65,0x6e])](_0x25f7bd,_0x357914),_0x1135b3[_0x1c5560([0x74,0x68,0x65,0x6e])](_0x17d17e=>{_0x17d17e!=_0x1c5560([0x56,0x61,0x6c,0x69,0x64])&&_0x25f7bd(_0x17d17e);},_0x357914);}):_0x2ab98f||_0x1135b3||_0x1c5560([0x56,0x61,0x6c,0x69,0x64]);}}function _0x11ffc6(_0x32d592,_0x4e0969){return new window[(_0x1c5560([0x50,0x72,0x6f,0x6d,0x69,0x73,0x65]))](_0x3b6f6c=>{if(_0x1d8f7b())return _0x3b6f6c(_0x1c5560([0x56,0x61,0x6c,0x69,0x64]));_0x85f8f(),_0xbad2c0[_0x1c5560([0x64,0x65,0x63,0x6f,0x72,0x61,0x74,0x65])](_0x1c5560([0x5f,0x73,0x65,0x6e,0x64,0x55,0x73,0x61,0x67,0x65,0x52,0x65,0x71,0x75,0x65,0x73,0x74]));let _0x503083=!0x1;const _0x4323a7=_0x344b24();function _0x2934a8(_0x59d64b){return!!_0x59d64b&&(typeof _0x59d64b===_0x1c5560([0x6f,0x62,0x6a,0x65,0x63,0x74])||typeof _0x59d64b===_0x1c5560([0x66,0x75,0x6e,0x63,0x74,0x69,0x6f,0x6e]))&&typeof _0x59d64b[_0x1c5560([0x74,0x68,0x65,0x6e])]===_0x1c5560([0x66,0x75,0x6e,0x63,0x74,0x69,0x6f,0x6e])&&typeof _0x59d64b[_0x1c5560([0x63,0x61,0x74,0x63,0x68])]===_0x1c5560([0x66,0x75,0x6e,0x63,0x74,0x69,0x6f,0x6e]);}function _0x1e8438(_0x4da26c){_0x217a3d(_0x4da26c)[_0x1c5560([0x74,0x68,0x65,0x6e])](_0x3e7e2e=>{if(!_0x3e7e2e||_0x3e7e2e[_0x1c5560([0x73,0x74,0x61,0x74,0x75,0x73])]!=_0x1c5560([0x6f,0x6b]))return _0x1c5560([0x55,0x73,0x61,0x67,0x65,0x4c,0x69,0x6d,0x69,0x74]);return _0x465666(_0x5d20fa(_0x4323a7+_0x4e0969))!=_0x3e7e2e[_0x1c5560([0x76,0x65,0x72,0x69,0x66,0x69,0x63,0x61,0x74,0x69,0x6f,0x6e])]?_0x1c5560([0x55,0x73,0x61,0x67,0x65,0x4c,0x69,0x6d,0x69,0x74]):_0x1c5560([0x56,0x61,0x6c,0x69,0x64]);})[_0x1c5560([0x74,0x68,0x65,0x6e])](_0x249efb=>(_0x5dc941(),_0x249efb),()=>{const _0x1fac74=_0x19585c();return null==_0x1fac74?(_0x5dc941(),_0x1c5560([0x56,0x61,0x6c,0x69,0x64])):_0x1c5560(_0x11043d-_0x1fac74>(0x404ebae1^_0x141a6b)?[0x55,0x73,0x61,0x67,0x65,0x4c,0x69,0x6d,0x69,0x74]:[0x56,0x61,0x6c,0x69,0x64]);})[_0x1c5560([0x74,0x68,0x65,0x6e])](_0x3b6f6c)[_0x1c5560([0x63,0x61,0x74,0x63,0x68])](()=>{_0x3b6f6c(_0x1c5560([0x55,0x73,0x61,0x67,0x65,0x4c,0x69,0x6d,0x69,0x74]));});const _0x3e4d38=0x6474d061^_0x141a6b;function _0x5dc941(){const _0x19e1b0=_0x1c5560([0x6c,0x6c,0x63,0x74,0x2d])+_0x465666(_0x5d20fa(_0x32d592)),_0x4e1c36=_0x85c49(_0x465666(window[_0x1c5560([0x4d,0x61,0x74,0x68])][_0x1c5560([0x63,0x65,0x69,0x6c])](_0x11043d/_0x3e4d38)));window[_0x1c5560([0x6c,0x6f,0x63,0x61,0x6c,0x53,0x74,0x6f,0x72,0x61,0x67,0x65])][_0x1c5560([0x73,0x65,0x74,0x49,0x74,0x65,0x6d])](_0x19e1b0,_0x4e1c36);}function _0x19585c(){const _0x3c973e=_0x1c5560([0x6c,0x6c,0x63,0x74,0x2d])+_0x465666(_0x5d20fa(_0x32d592)),_0x1b638b=window[_0x1c5560([0x6c,0x6f,0x63,0x61,0x6c,0x53,0x74,0x6f,0x72,0x61,0x67,0x65])][_0x1c5560([0x67,0x65,0x74,0x49,0x74,0x65,0x6d])](_0x3c973e);return _0x1b638b?window[_0x1c5560([0x70,0x61,0x72,0x73,0x65,0x49,0x6e,0x74])](_0x85c49(_0x1b638b),0x10)*_0x3e4d38:null;}function _0x217a3d(_0x4d3c5a){return new window[(_0x1c5560([0x50,0x72,0x6f,0x6d,0x69,0x73,0x65]))]((_0x4aad03,_0xd4c5da)=>{_0x4d3c5a[_0x1c5560([0x74,0x68,0x65,0x6e])](_0x4aad03,_0xd4c5da),window[_0x1c5560([0x73,0x65,0x74,0x54,0x69,0x6d,0x65,0x6f,0x75,0x74])](_0xd4c5da,0x6443ea21^_0x141a6b);});}}_0xbad2c0[_0x1c5560([0x6f,0x6e])](_0x1c5560([0x5f,0x73,0x65,0x6e,0x64,0x55,0x73,0x61,0x67,0x65,0x52,0x65,0x71,0x75,0x65,0x73,0x74]),(_0x495716,_0x46e9b9)=>{if(_0x46e9b9[0x0]!=_0x32d592)return _0x3b6f6c(_0x1c5560([0x55,0x73,0x61,0x67,0x65,0x4c,0x69,0x6d,0x69,0x74]));_0x46e9b9[0x1]={..._0x46e9b9[0x1],[_0x1c5560([0x72,0x65,0x71,0x75,0x65,0x73,0x74,0x49,0x64])]:_0x4323a7};},{[_0x1c5560([0x70,0x72,0x69,0x6f,0x72,0x69,0x74,0x79])]:_0x1c5560([0x68,0x69,0x67,0x68])}),_0xbad2c0[_0x1c5560([0x6f,0x6e])](_0x1c5560([0x5f,0x73,0x65,0x6e,0x64,0x55,0x73,0x61,0x67,0x65,0x52,0x65,0x71,0x75,0x65,0x73,0x74]),_0x302638=>{_0x2934a8(_0x302638[_0x1c5560([0x72,0x65,0x74,0x75,0x72,0x6e])])&&(_0x503083=!0x0,_0x1e8438(_0x302638[_0x1c5560([0x72,0x65,0x74,0x75,0x72,0x6e])]));},{[_0x1c5560([0x70,0x72,0x69,0x6f,0x72,0x69,0x74,0x79])]:_0x1c5560([0x6c,0x6f,0x77])}),_0x13ba68[_0x1c5560([0x74,0x68,0x65,0x6e])](()=>{_0x503083||_0x3b6f6c(_0x1c5560([0x55,0x73,0x61,0x67,0x65,0x4c,0x69,0x6d,0x69,0x74]));});});function _0x1d8f7b(){return _0xbad2c0[_0x1c5560([0x65,0x64,0x69,0x74,0x69,0x6e,0x67])][_0x1c5560([0x76,0x69,0x65,0x77])][_0x1c5560([0x5f,0x6f,0x76,0x65,0x72,0x6c,0x61,0x79,0x4d,0x6f,0x64,0x65,0x48,0x69,0x6e,0x74])]==_0x1c5560([0x61,0x75,0x74,0x6f]);}function _0x85f8f(){_0xbad2c0[_0x1c5560([0x65,0x64,0x69,0x74,0x69,0x6e,0x67])][_0x1c5560([0x76,0x69,0x65,0x77])][_0x1c5560([0x5f,0x6f,0x76,0x65,0x72,0x6c,0x61,0x79,0x4d,0x6f,0x64,0x65,0x48,0x69,0x6e,0x74])]=_0x1c5560([0x61,0x75,0x74,0x6f]);}}function _0x2b0620(_0x3645f0){const _0x2574fc=[new window[(_0x1c5560([0x50,0x72,0x6f,0x6d,0x69,0x73,0x65]))](_0x904f5a=>setTimeout(_0x904f5a,0x644b002d^_0x141a6b)),_0x13ba68[_0x1c5560([0x74,0x68,0x65,0x6e])](()=>new window[(_0x1c5560([0x50,0x72,0x6f,0x6d,0x69,0x73,0x65]))](_0x505ea7=>{const _0x3cb603=0x64423ee6^_0x141a6b,_0x44bff9=_0x25e1cd[_0x1c5560([0x5f,0x72,0x65,0x76,0x69,0x73,0x69,0x6f,0x6e,0x73])];function _0x3ecac2(){_0x44bff9[_0x1c5560([0x6c,0x65,0x6e,0x67,0x74,0x68])]>=_0x3cb603&&_0x505ea7();}_0x3ecac2(),_0x44bff9[_0x1c5560([0x6f,0x6e])](_0x1c5560([0x61,0x64,0x64]),_0x3ecac2);})),new window[(_0x1c5560([0x50,0x72,0x6f,0x6d,0x69,0x73,0x65]))](_0x352bbf=>{function _0x354054(){for(const _0x545c35 in window)if(window[_0x1c5560([0x4e,0x75,0x6d,0x62,0x65,0x72])]['isNaN'](window[_0x1c5560([0x4e,0x75,0x6d,0x62,0x65,0x72])](_0x545c35))&&window[_0x545c35]==_0x637499)return _0x352bbf();_0xbad2c0[_0x1c5560([0x73,0x74,0x61,0x74,0x65])]!=_0x1c5560([0x64,0x65,0x73,0x74,0x72,0x6f,0x79,0x65,0x64])&&window[_0x1c5560([0x73,0x65,0x74,0x54,0x69,0x6d,0x65,0x6f,0x75,0x74])](_0x354054,0x64422d69^_0x141a6b);}_0x3a0da7(_0x1c5560([0x52,0x65,0x76,0x69,0x73,0x69,0x6f,0x6e,0x56,0x69,0x65,0x77,0x65,0x72]))&&_0x354054();})];return window[_0x1c5560([0x50,0x72,0x6f,0x6d,0x69,0x73,0x65])][_0x1c5560([0x72,0x61,0x63,0x65])](_0x2574fc)[_0x1c5560([0x74,0x68,0x65,0x6e])](()=>_0x3645f0);}async function _0x553fae(){if(await _0x13ba68,_0x3a0da7(_0x1c5560([0x52,0x65,0x76,0x69,0x73,0x69,0x6f,0x6e,0x56,0x69,0x65,0x77,0x65,0x72]))){const _0x3c580a=_0x25e1cd[_0x1c5560([0x67,0x65,0x74,0x52,0x65,0x76,0x69,0x73,0x69,0x6f,0x6e])](0x0),_0x2f12cb=_0x25e1cd[_0x1c5560([0x67,0x65,0x74,0x45,0x61,0x72,0x6c,0x69,0x65,0x72,0x56,0x69,0x73,0x69,0x62,0x6c,0x65,0x52,0x65,0x76,0x69,0x73,0x69,0x6f,0x6e])](_0x3c580a[_0x1c5560([0x69,0x64])]),_0x1f5d73=_0xbe9f72(_0x1c5560([0x52,0x65,0x76,0x69,0x73,0x69,0x6f,0x6e,0x56,0x69,0x65,0x77,0x65,0x72]));return await _0x1f5d73[_0x1c5560([0x63,0x6f,0x6d,0x70,0x61,0x72,0x65])](_0x3c580a['id'],_0x2f12cb?_0x2f12cb['id']:null,!0x0),_0x1f5d73[_0x1c5560([0x75,0x6e,0x62,0x69,0x6e,0x64])](_0x1c5560([0x69,0x73,0x45,0x6e,0x61,0x62,0x6c,0x65,0x64])),_0x1f5d73[_0x1c5560([0x69,0x73,0x45,0x6e,0x61,0x62,0x6c,0x65,0x64])]=!0x1,_0x1f5d73[_0x1c5560([0x63,0x6f,0x6d,0x70,0x61,0x72,0x65])]=_0x3ea66f,void(_0x1f5d73[_0x1c5560([0x5f,0x67,0x65,0x74,0x44,0x69,0x66,0x66])]=_0x3ea66f);}if(_0x3a0da7(_0x1c5560([0x52,0x65,0x76,0x69,0x73,0x69,0x6f,0x6e,0x54,0x72,0x61,0x63,0x6b,0x65,0x72]))){const _0x5c09a6=_0xbe9f72(_0x1c5560([0x52,0x65,0x76,0x69,0x73,0x69,0x6f,0x6e,0x54,0x72,0x61,0x63,0x6b,0x65,0x72]));_0x5c09a6[_0x1c5560([0x75,0x6e,0x62,0x69,0x6e,0x64])](_0x1c5560([0x69,0x73,0x45,0x6e,0x61,0x62,0x6c,0x65,0x64])),_0x5c09a6[_0x1c5560([0x69,0x73,0x45,0x6e,0x61,0x62,0x6c,0x65,0x64])]=!0x1,_0x5c09a6[_0x1c5560([0x75,0x70,0x64,0x61,0x74,0x65])]=_0x3ea66f,_0x5c09a6[_0x1c5560([0x73,0x61,0x76,0x65,0x52,0x65,0x76,0x69,0x73,0x69,0x6f,0x6e])]=_0x3ea66f;}_0xbad2c0[_0x1c5560([0x6d,0x6f,0x64,0x65,0x6c])][_0x1c5560([0x63,0x68,0x61,0x6e,0x67,0x65])]=_0x3ea66f,_0xbad2c0[_0x1c5560([0x6d,0x6f,0x64,0x65,0x6c])][_0x1c5560([0x65,0x6e,0x71,0x75,0x65,0x75,0x65,0x43,0x68,0x61,0x6e,0x67,0x65])]=_0x3ea66f,_0xbad2c0[_0x1c5560([0x65,0x6e,0x61,0x62,0x6c,0x65,0x52,0x65,0x61,0x64,0x4f,0x6e,0x6c,0x79,0x4d,0x6f,0x64,0x65])](_0x1c5560([0x6d,0x6f,0x64,0x65,0x6c]));}function _0x50b001(){return _0x3a0da7(_0x1c5560([0x57,0x65,0x62,0x53,0x6f,0x63,0x6b,0x65,0x74,0x47,0x61,0x74,0x65,0x77,0x61,0x79]))&&_0xbe9f72(_0x1c5560([0x57,0x65,0x62,0x53,0x6f,0x63,0x6b,0x65,0x74,0x47,0x61,0x74,0x65,0x77,0x61,0x79]))[_0x1c5560([0x73,0x74,0x61,0x74,0x65])]==_0x1c5560([0x63,0x6f,0x6e,0x6e,0x65,0x63,0x74,0x65,0x64]);}function _0xb10c29(){return _0x3a0da7(_0x1c5560([0x52,0x65,0x76,0x69,0x73,0x69,0x6f,0x6e,0x56,0x69,0x65,0x77,0x65,0x72,0x49,0x6e,0x74,0x65,0x67,0x72,0x61,0x74,0x69,0x6f,0x6e]));}function _0x29ceec(){return _0x3a0da7(_0x1c5560([0x54,0x72,0x61,0x63,0x6b,0x43,0x68,0x61,0x6e,0x67,0x65,0x73,0x44,0x61,0x74,0x61,0x47,0x65,0x74,0x74,0x65,0x72]));}function _0x4c46eb(_0x4c2281){const _0x3a8e31=_0x488700();_0xbad2c0[_0x3a8e31]=_0x1c5560([0x72,0x65,0x76,0x69,0x73,0x69,0x6f,0x6e,0x48,0x69,0x73,0x74,0x6f,0x72,0x79,0x4c,0x69,0x63,0x65,0x6e,0x73,0x65,0x4b,0x65,0x79])+_0x4c2281,_0x4c2281[_0x1c5560([0x65,0x6e,0x64,0x73,0x57,0x69,0x74,0x68])](_0x1c5560([0x4c,0x69,0x6d,0x69,0x74]))&&(window[_0x488700()]=_0x637499),_0x4c2281!=_0x1c5560([0x56,0x61,0x6c,0x69,0x64])&&_0x553fae();}function _0x488700(){const _0x58f4db=window[_0x1c5560([0x53,0x74,0x72,0x69,0x6e,0x67])](window[_0x1c5560([0x70,0x65,0x72,0x66,0x6f,0x72,0x6d,0x61,0x6e,0x63,0x65])][_0x1c5560([0x6e,0x6f,0x77])]())[_0x1c5560([0x72,0x65,0x70,0x6c,0x61,0x63,0x65])](_0x1c5560([0x2e]),'');let _0xe75818=_0x1c5560([0x61]);for(let _0x492ff1=0x0;_0x492ff1<_0x58f4db[_0x1c5560([0x6c,0x65,0x6e,0x67,0x74,0x68])];_0x492ff1+=0x2){let _0xefc6d9=window[_0x1c5560([0x70,0x61,0x72,0x73,0x65,0x49,0x6e,0x74])](_0x58f4db[_0x1c5560([0x73,0x75,0x62,0x73,0x74,0x72,0x69,0x6e,0x67])](_0x492ff1,_0x492ff1+0x2));_0xefc6d9>=_0x2bd0f3[_0x1c5560([0x6c,0x65,0x6e,0x67,0x74,0x68])]&&(_0xefc6d9-=_0x2bd0f3[_0x1c5560([0x6c,0x65,0x6e,0x67,0x74,0x68])]),_0xe75818+=_0x2bd0f3[_0xefc6d9];}return _0xe75818;}function _0x43a1bd(){const _0x3b97b5=_0x47c907[_0x1c5560([0x73,0x70,0x6c,0x69,0x74])](_0x1c5560([0x2e]));if(0x3!=_0x3b97b5[_0x1c5560([0x6c,0x65,0x6e,0x67,0x74,0x68])])return null;return _0x3fa467(_0x3b97b5[0x1]);function _0x3fa467(_0x322cf5){const _0x376f56=_0x10f98a(_0x322cf5);return _0x376f56&&_0x20786a()?_0x376f56:null;function _0x20786a(){const _0x371b33=_0x376f56[_0x1c5560([0x6a,0x74,0x69])],_0x9b13b4=window[_0x1c5560([0x70,0x61,0x72,0x73,0x65,0x49,0x6e,0x74])](_0x371b33[_0x1c5560([0x73,0x75,0x62,0x73,0x74,0x72,0x69,0x6e,0x67])](_0x371b33[_0x1c5560([0x6c,0x65,0x6e,0x67,0x74,0x68])]-0x8),0x10),_0x47068c={..._0x376f56,[_0x1c5560([0x6a,0x74,0x69])]:_0x371b33[_0x1c5560([0x73,0x75,0x62,0x73,0x74,0x72,0x69,0x6e,0x67])](0x0,_0x371b33[_0x1c5560([0x6c,0x65,0x6e,0x67,0x74,0x68])]-0x8)};return delete _0x47068c[_0x1c5560([0x76,0x63])],_0x5d20fa(_0x47068c)==_0x9b13b4;}}}async function _0x24c930(){let _0x9a574d=!0x0;try{const _0x1e7137=_0x47c907[_0x1c5560([0x73,0x70,0x6c,0x69,0x74])](_0x1c5560([0x2e])),[_0x548370,_0x2e2eab,_0x467c5b]=_0x1e7137;return _0x20ae21(_0x548370),await _0x4b45d6(_0x548370,_0x2e2eab,_0x467c5b),_0x9a574d;}catch{return!0x1;}function _0x20ae21(_0x288b1c){const _0x5e3e85=_0x10f98a(_0x288b1c);_0x5e3e85&&_0x5e3e85[_0x1c5560([0x61,0x6c,0x67])]==_0x1c5560([0x45,0x53,0x32,0x35,0x36])||(_0x9a574d=!0x1);}async function _0x4b45d6(_0x3dcafd,_0x3fcf50,_0x576705){const _0x53c6da=window[_0x1c5560([0x55,0x69,0x6e,0x74,0x38,0x41,0x72,0x72,0x61,0x79])][_0x1c5560([0x66,0x72,0x6f,0x6d])](_0x2aa9a7(_0x576705),_0x1216b1=>_0x1216b1[_0x1c5560([0x63,0x68,0x61,0x72,0x43,0x6f,0x64,0x65,0x41,0x74])](0x0)),_0x475986=new window[(_0x1c5560([0x54,0x65,0x78,0x74,0x45,0x6e,0x63,0x6f,0x64,0x65,0x72]))]()[_0x1c5560([0x65,0x6e,0x63,0x6f,0x64,0x65])](_0x3dcafd+_0x1c5560([0x2e])+_0x3fcf50),_0x3525e8=window[_0x1c5560([0x63,0x72,0x79,0x70,0x74,0x6f])][_0x1c5560([0x73,0x75,0x62,0x74,0x6c,0x65])];if(!_0x3525e8)return;const _0x4287cc=await _0x3525e8[_0x1c5560([0x69,0x6d,0x70,0x6f,0x72,0x74,0x4b,0x65,0x79])](_0x1c5560([0x6a,0x77,0x6b]),_0x4eaeba,{[_0x1c5560([0x6e,0x61,0x6d,0x65])]:_0x1c5560([0x45,0x43,0x44,0x53,0x41]),[_0x1c5560([0x6e,0x61,0x6d,0x65,0x64,0x43,0x75,0x72,0x76,0x65])]:_0x1c5560([0x50,0x2d,0x32,0x35,0x36])},!0x1,[_0x1c5560([0x76,0x65,0x72,0x69,0x66,0x79])]);await _0x3525e8[_0x1c5560([0x76,0x65,0x72,0x69,0x66,0x79])]({[_0x1c5560([0x6e,0x61,0x6d,0x65])]:_0x1c5560([0x45,0x43,0x44,0x53,0x41]),[_0x1c5560([0x68,0x61,0x73,0x68])]:{[_0x1c5560([0x6e,0x61,0x6d,0x65])]:_0x1c5560([0x53,0x48,0x41,0x2d,0x32,0x35,0x36])}},_0x4287cc,_0x53c6da,_0x475986)||(_0x9a574d=!0x1);}}function _0x10f98a(_0x4f1d5b){return _0x4f1d5b[_0x1c5560([0x73,0x74,0x61,0x72,0x74,0x73,0x57,0x69,0x74,0x68])](_0x1c5560([0x65,0x79]))?JSON[_0x1c5560([0x70,0x61,0x72,0x73,0x65])](_0x2aa9a7(_0x4f1d5b)):null;}function _0x2aa9a7(_0x3f70fa){return window[_0x1c5560([0x61,0x74,0x6f,0x62])](_0x3f70fa[_0x1c5560([0x72,0x65,0x70,0x6c,0x61,0x63,0x65])](/-/g,_0x1c5560([0x2b]))[_0x1c5560([0x72,0x65,0x70,0x6c,0x61,0x63,0x65])](/_/g,_0x1c5560([0x2f])));}function _0x5d20fa(_0x56f3bd){let _0xa8c9f9=0x1505;function _0x5f0994(_0x1c12dc){for(let _0x45d95f=0x0;_0x45d95f<_0x1c12dc[_0x1c5560([0x6c,0x65,0x6e,0x67,0x74,0x68])];_0x45d95f++){const _0x5cfb8c=_0x1c12dc[_0x1c5560([0x63,0x68,0x61,0x72,0x43,0x6f,0x64,0x65,0x41,0x74])](_0x45d95f);_0xa8c9f9=(_0xa8c9f9<<0x5)+_0xa8c9f9+_0x5cfb8c,_0xa8c9f9&=_0xa8c9f9;}}function _0x130b1b(_0x13463f){Array[_0x1c5560([0x69,0x73,0x41,0x72,0x72,0x61,0x79])](_0x13463f)?_0x13463f[_0x1c5560([0x66,0x6f,0x72,0x45,0x61,0x63,0x68])](_0x130b1b):_0x13463f&&typeof _0x13463f==_0x1c5560([0x6f,0x62,0x6a,0x65,0x63,0x74])?Object[_0x1c5560([0x65,0x6e,0x74,0x72,0x69,0x65,0x73])](_0x13463f)[_0x1c5560([0x73,0x6f,0x72,0x74])]()[_0x1c5560([0x66,0x6f,0x72,0x45,0x61,0x63,0x68])](([_0x479ac5,_0x48b577])=>{_0x5f0994(_0x479ac5),_0x130b1b(_0x48b577);}):_0x5f0994(window[_0x1c5560([0x53,0x74,0x72,0x69,0x6e,0x67])](_0x13463f));}return _0x130b1b(_0x56f3bd),_0xa8c9f9>>>0x0;}function _0x465666(_0x365b81){return _0x365b81[_0x1c5560([0x74,0x6f,0x53,0x74,0x72,0x69,0x6e,0x67])](0x10)[_0x1c5560([0x70,0x61,0x64,0x53,0x74,0x61,0x72,0x74])](0x8,_0x1c5560([0x30]));}function _0x85c49(_0x17dac4){return _0x17dac4[_0x1c5560([0x73,0x70,0x6c,0x69,0x74])]('')[_0x1c5560([0x72,0x65,0x76,0x65,0x72,0x73,0x65])]()[_0x1c5560([0x6a,0x6f,0x69,0x6e])]('');}function _0x3a0da7(_0x48b25d){return _0xbad2c0[_0x1c5560([0x70,0x6c,0x75,0x67,0x69,0x6e,0x73])][_0x1c5560([0x68,0x61,0x73])](_0x48b25d);}function _0xbe9f72(_0x301c94){return _0xbad2c0[_0x1c5560([0x70,0x6c,0x75,0x67,0x69,0x6e,0x73])][_0x1c5560([0x67,0x65,0x74])](_0x301c94);}function _0x3ea66f(){}function _0x1c5560(_0x324f00){return _0x324f00['map'](_0x388791=>String['fromCharCode'](_0x388791))['join']('');}_0x4c46eb(await _0x256334());}(this);}['createRevision'](_0x3a9a0c){const _0x1e6c4b=this['editor']['plugins']['get']('Users');return new h({'id':_0x3a9a0c['id'],'name':_0x3a9a0c['name'],'creator':_0x3a9a0c['creatorId']?_0x1e6c4b['getUser'](_0x3a9a0c['creatorId']):null,'diffData':_0x3a9a0c['diffData']||_0x3a9a0c['data'],'authors':_0x3a9a0c['authorsIds']['map'](_0x5aa648=>_0x1e6c4b['getUser'](_0x5aa648)),'createdAt':new Date(_0x3a9a0c['createdAt']),'attributes':_0x3a9a0c['attributes'],'fromVersion':_0x3a9a0c['fromVersion'],'toVersion':_0x3a9a0c['toVersion']});}['addRevision'](_0x477d7f,_0x1dee23=0x0){this['_revisions']['add'](_0x477d7f,_0x1dee23);}['getRevision'](_0x408a73){return this['_revisions']['get'](_0x408a73);}['getRevisions'](_0x27f98a={'toJSON':!0x1}){const _0x573538=Array['from'](this['_revisions']);return _0x573538['reverse'](),_0x27f98a['toJSON']?_0x573538['map'](_0x3f9aad=>_0x3f9aad['toJSON']()):_0x573538;}['getIndex'](_0x565e62){return this['_revisions']['getIndex'](_0x565e62);}['getEarlierVisibleRevision'](_0x5874a9){const [,_0xdb56bb]=this['getRevisionsIterator'](_0x5874a9,{'direction':'earlier'});return _0xdb56bb;}['getLaterVisibleRevision'](_0x92b835){const [,_0xcb6c3a]=this['getRevisionsIterator'](_0x92b835,{'direction':'later'});return _0xcb6c3a;}['getRevisionsInDiff'](_0x6b6200){const _0x119437=[];for(const _0x2cdca7 of this['getRevisionsIterator'](_0x6b6200['newRevisionId']))if(_0x119437['push'](_0x2cdca7),_0x2cdca7['id']===_0x6b6200['oldRevisionId'])break;return _0x119437;}*['getRevisionsIterator'](_0x3a02cd,{direction:_0x2a524f='earlier',filter:_0x48dc37=()=>!0x0}={}){const _0x5721c0='earlier'===_0x2a524f?0x1:-0x1;let _0x4cd463=this['_revisions']['get'](_0x3a02cd),_0x971e2=this['getIndex'](_0x4cd463);for(yield _0x4cd463;_0x4cd463;){if(_0x971e2+=_0x5721c0,_0x4cd463=this['getRevision'](_0x971e2),!_0x4cd463)return;_0x48dc37(_0x4cd463)&&(yield _0x4cd463);}}}class V extends _0x4f3c67{static get['pluginName'](){return'RevisionHistoryUtils';}static get['isOfficialPlugin'](){return!0x0;}static get['isPremiumPlugin'](){return!0x0;}['_viewClassToTypeChar']=new Map([[_0x287666,'c'],[_0x46dfdc,'a'],[_0x53f8ca,'e'],[_0x3915b6,'r'],[_0x671e60,'u']]);['_typeCharToViewClass']=new Map([['c',_0x287666],['a',_0x46dfdc],['e',_0x53f8ca],['r',_0x3915b6],['u',_0x671e60]]);async['loadRevisionData'](_0x394b66,_0x59cf4c){if(_0x394b66['diffData']||!_0x59cf4c)return;const _0x125831=this['editor']['config']['get']('collaboration.channelId'),_0x49afba=await _0x59cf4c['getRevision']({'channelId':_0x125831,'revisionId':_0x394b66['id']});_0x394b66['diffData']=_0x49afba['diffData'];}['getRevisionDocumentData'](_0x3cf097){const _0xf7816={};for(const _0x1ed667 in _0x3cf097['diffData']){if(_0x3cf097['diffData'][_0x1ed667]['attachChange']&&!_0x3cf097['diffData'][_0x1ed667]['attachChange']['isAttached'])continue;const _0x2cc37b=this['_removeRevisionMarkers'](JSON['parse'](_0x3cf097['diffData'][_0x1ed667]['insertions'])),_0x382d4f=this['editor']['editing']['view']['document'],_0x283b08=new _0x3ca17d(_0x382d4f,_0x2cc37b['map'](_0x1831aa=>this['_getViewFromDiffObj'](_0x1831aa,!0x1)));this['editor']['data']['processor']['useFillerType']('marked'),_0xf7816[_0x1ed667]=this['editor']['data']['processor']['toData'](_0x283b08),this['editor']['data']['processor']['useFillerType']('default');}return _0xf7816;}['getRevisionRootsAttributes'](_0x4535fa){const _0x3661b8={};for(const _0x41ff9d in _0x4535fa['diffData'])_0x4535fa['diffData'][_0x41ff9d]['attachChange']&&!_0x4535fa['diffData'][_0x41ff9d]['attachChange']['isAttached']||(_0x3661b8[_0x41ff9d]=_0x4535fa['diffData'][_0x41ff9d]['attributesAfter']||{});return _0x3661b8;}['_getTypeCharForViewElement'](_0x4b7ec6){return this['_viewClassToTypeChar']['get'](_0x4b7ec6['constructor']);}['_getViewFromDiffObj'](_0x2b0fc,_0x53389c){const _0x8d45fc=this['editor']['editing']['view']['document'];if('string'==typeof _0x2b0fc)return new _0x44b03b(_0x8d45fc,_0x2b0fc);{let _0x417aec,_0x4da6ec;_0x4da6ec='u'==_0x2b0fc['type']||'r'==_0x2b0fc['type']?[]:_0x2b0fc['children']['map'](_0x4b3dc0=>this['_getViewFromDiffObj'](_0x4b3dc0,_0x53389c));const _0x3c6dee=this['_typeCharToViewClass']['get'](_0x2b0fc['type'])||_0x1d3616,_0x396c89=this['editor']['data']['htmlProcessor']['domConverter'];if(_0x417aec=new _0x3c6dee(_0x8d45fc,_0x2b0fc['name'],_0x2b0fc['attributes'],_0x4da6ec),'u'==_0x2b0fc['type']&&_0x2b0fc['children'][0x0]){const _0xf2ffa8=_0x2b0fc['children'][0x0];if(_0x417aec['render']=function(_0x52870f){const _0x453351=_0x52870f['createElement']('div');return _0x453351['innerHTML']=_0xf2ffa8,_0x453351['childNodes'][0x0];},_0x53389c){const _0x1f00c2=new _0x3ca17d(_0x8d45fc);_0x1f00c2['_appendChild'](_0x417aec);const _0x4d8cac=Array['from'](_0x396c89['viewChildrenToDom'](_0x1f00c2,{'bind':!0x1})),_0x5a2cfd=_0x396c89['domDocument']['createElement']('div');_0x5a2cfd['append'](..._0x4d8cac),_0x417aec=Array['from'](_0x396c89['domChildrenToView'](_0x5a2cfd))[0x0];}}else{if('r'==_0x2b0fc['type']&&_0x2b0fc['children'][0x0]){const _0xc0febe=_0x2b0fc['children'][0x0];if(_0x417aec['render']=function(_0x223cb1){_0x223cb1['innerHTML']=_0xc0febe;},_0x53389c){const _0x535f25=new _0x3ca17d(_0x8d45fc);_0x535f25['_appendChild'](_0x417aec);const _0x2a07c7=Array['from'](_0x396c89['viewChildrenToDom'](_0x535f25,{'bind':!0x1})),_0x43d056=_0x396c89['domDocument']['createElement']('div');_0x43d056['append'](..._0x2a07c7);const _0x5ec2f9=Array['from'](_0x396c89['domChildrenToView'](_0x43d056));_0x5ec2f9['length']>0x1?_0x417aec['_appendChild'](_0x5ec2f9):_0x417aec=_0x5ec2f9[0x0];}}}if(_0x2b0fc['customProperties']){for(const [_0x12e540,_0x26fa82]of _0x2b0fc['customProperties'])_0x417aec['_setCustomProperty'](_0x12e540,_0x26fa82);}const _0x45f623=void 0x0===_0x2b0fc['fillerOffset']?null:_0x2b0fc['fillerOffset'];return null!==_0x45f623&&(_0x417aec['getFillerOffset']=()=>_0x45f623),_0x417aec;}}['_makeModelFromViewString'](_0x592448){const _0x9362ca=JSON['parse'](_0x592448),_0x2d570f=this['editor']['editing']['view']['document'],_0x41cd8d=new _0x3ca17d(_0x2d570f,_0x9362ca['map'](_0x54cca2=>this['_getViewFromDiffObj'](_0x54cca2,!0x0)));return this['editor']['data']['toModel'](_0x41cd8d);}['_removeRevisionMarkers'](_0x451cae){return(_0x451cae=_0x451cae['filter'](_0x16f0db=>!_0x16f0db['name']||'revision-start'!==_0x16f0db['name']&&'revision-end'!==_0x16f0db['name']))['forEach'](_0x111b21=>{'string'!=typeof _0x111b21&&(_0x111b21['children']=this['_removeRevisionMarkers'](_0x111b21['children']),_0x111b21['attributes']=_0x111b21['attributes']['filter'](_0x540366=>!_0x540366[0x0]['startsWith']('data-revision-')));}),_0x451cae;}}function g(_0x2b8d90,_0x18ebe5,_0x526634){const t=_0x2b8d90['t'];switch(_0x18ebe5){case'Revision\x20history':return t('Revision\x20history');case'Open\x20revision\x20history':return t('Open\x20revision\x20history');case'Restored':return t('Restored');case'Empty\x20document':return t('Empty\x20document');case'Initial\x20revision':return t('Initial\x20revision');case'Suggested\x20by':return t('Suggested\x20by');case'Added\x20by':return t('Added\x20by');case'Removed\x20by':return t('Removed\x20by');case'Show\x20more\x20items':return t('Show\x20more\x20items');case'Compare\x20against\x20selected':return t('Compare\x20against\x20selected');case'Name\x20this\x20revision':return t('Name\x20this\x20revision');case'Restore\x20this\x20revision':return t('Restore\x20this\x20revision');case'Back\x20to\x20editing':return t('Back\x20to\x20editing');case'Loading...':return t('Loading...');case'No\x20changes':return t('No\x20changes');case'NUMBER_OF_CHANGES':return t({'string':'%0\x20change','plural':'%0\x20changes','id':'NUMBER_OF_CHANGES'},_0x526634);case'X_OF_Y_CHANGES':return t({'string':'%0\x20of\x20%1','id':'X_OF_Y_CHANGES'},_0x526634);case'Show\x20previous\x20change':return t('Show\x20previous\x20change');case'Show\x20next\x20change':return t('Show\x20next\x20change');case'EDIT_X_OF_Y_REVISIONS':return t({'string':'Edit','id':'EDIT_X_OF_Y_REVISIONS'});case'Total':return t('Total');case'Revision\x20creator':return t('Revision\x20creator');case'Revision\x20author':return t('Revision\x20author');case'Revision\x20name':return t('Revision\x20name');case'Save\x20current\x20revision':return t('Save\x20current\x20revision');case'Accept':return t('Accept');case'Save':return t('Save');case'Cancel':return t('Cancel');case'Name\x20of\x20the\x20revision':return t('Name\x20of\x20the\x20revision');case'optional':return t('optional');case'PENDING_ACTION_REVISION_HISTORY':return t({'string':'Unsaved\x20change\x20in\x20revision\x20history.','id':'PENDING_ACTION_REVISION_HISTORY'});case'The\x20revision\x20name\x20cannot\x20be\x20empty.':return t('The\x20revision\x20name\x20cannot\x20be\x20empty.');case'Enter\x20the\x20revision\x20name':return t('Enter\x20the\x20revision\x20name');default:return'';}}class u extends _0x4f3c67{['licenseKey'];['_licenseKeyCheckInterval'];['currentRevision']=null;['repository'];['adapter']=null;['_revisionDataBuilder'];['_source'];['_initialRevisionId'];['_bufferedUpdates'];['_utils'];['_pendingAction'];['_continueCurrentRevision'];['_startingVersion'];['_loadedStateData'];static get['pluginName'](){return'RevisionTracker';}static get['isOfficialPlugin'](){return!0x0;}static get['isPremiumPlugin'](){return!0x0;}static get['requires'](){return[_0x2ecac3,I,V,_0x46d677];}constructor(_0x374018){super(_0x374018),this['repository']=this['editor']['plugins']['get']('RevisionsRepository'),this['_utils']=this['editor']['plugins']['get']('RevisionHistoryUtils'),this['_revisionDataBuilder']=new x(this['editor']),this['_initialRevisionId']=this['editor']['config']['get']('collaboration.channelId')||'initial',this['_bufferedUpdates']=new Map(),this['_loadedStateData']=null;const _0x2468b4=_0x344b24();this['_source']={'history':this['editor']['model']['document']['history'],'getLatestVersion':()=>Promise['resolve'](this['editor']['model']['document']['version']),'getCurrentRevisionId':()=>_0x2468b4},this['set']('isReady',!0x1),this['set']('isEnabled',!0x0),this['set']('_isPendingUpdate',!0x1),this['editor']['config']['define']('revisionHistory.resumeUnsavedRevision',!0x0),this['editor']['conversion']['for']('upcast')['dataToMarker']({'view':'revision'});}['init'](){this['_setConversion'](),this['editor']['data']['on']('ready',()=>{const _0x5dc057=this['repository']['getRevision'](0x0),_0x5bae6a=_0x5dc057&&null===_0x5dc057['creator']?_0x5dc057:null;if(this['_continueCurrentRevision']=!!_0x5bae6a&&this['editor']['config']['get']('revisionHistory.resumeUnsavedRevision'),this['editor']['plugins']['has']('RealTimeCollaborationClient')){const _0x3c7087=this['_source']['getCurrentRevisionId'](),_0x304cee=this['repository']['getRevision'](_0x3c7087);if(_0x304cee)this['_startingVersion']=_0x304cee['fromVersion'],this['_continueCurrentRevision']=!0x1;else{const _0x36bc2e=this['_source']['history']['_operations']['find'](_0x3adb2e=>!_0x3adb2e['_isInit']),_0x2b1a64=_0x36bc2e?_0x36bc2e['baseVersion']:this['_source']['history']['version'];_0x5dc057?(_0x5dc057['toVersion']<_0x2b1a64&&_0x5dc057['_update']({'toVersion':_0x2b1a64}),this['_continueCurrentRevision']?(this['_source']['getCurrentRevisionId']=()=>_0x5bae6a['id'],this['_startingVersion']=_0x5bae6a['fromVersion']):(this['_startingVersion']=_0x5dc057['toVersion'],this['_continueCurrentRevision']=!0x1)):(this['_startingVersion']=_0x2b1a64,this['_continueCurrentRevision']=!0x1);}}else _0x5bae6a&&(this['editor']['model']['document']['history']['version']=Math['max'](_0x5bae6a['toVersion'],this['editor']['model']['document']['history']['version']),_0x5bae6a['fromVersion']===_0x5bae6a['toVersion']?(0x0!==_0x5bae6a['fromVersion']&&(this['_source']['getCurrentRevisionId']=()=>_0x5bae6a['id']),this['_continueCurrentRevision']=!0x1):this['_continueCurrentRevision']&&(this['_source']['getCurrentRevisionId']=()=>_0x5bae6a['id'],this['_startingVersion']=_0x5bae6a['fromVersion'])),this['_continueCurrentRevision']||(this['_startingVersion']=this['editor']['model']['document']['version']);this['_revisionDataBuilder']['init'](this['_source']['history']),this['_createInitialRevision'](this['_startingVersion']),this['_createCurrentRevision'](this['_startingVersion']),this['adapter']&&this['sendBufferedUpdates']();}),this['bind']('isReady')['to'](this,'_isPendingUpdate',_0x50a272=>!_0x50a272),this['licenseKey']=this['editor']['config']['get']('licenseKey');const _0x5c1ebb=this['editor'];this['_licenseKeyCheckInterval']=setInterval(()=>{let _0x5981d8;for(const _0x378594 in _0x5c1ebb){const _0x2f65eb=_0x378594,_0x35f38c=_0x5c1ebb[_0x2f65eb];if('revisionHistoryLicenseKeyValid'==_0x35f38c||'revisionHistoryLicenseKeyInvalid'==_0x35f38c||'revisionHistoryLicenseKeyExpired'==_0x35f38c||'revisionHistoryLicenseKeyDomainLimit'==_0x35f38c||'revisionHistoryLicenseKeyNotAllowed'==_0x35f38c||'revisionHistoryLicenseKeyEvaluationLimit'==_0x35f38c||'revisionHistoryLicenseKeyTrialLimit'==_0x35f38c||'revisionHistoryLicenseKeyUsageLimit'==_0x35f38c){delete _0x5c1ebb[_0x2f65eb],_0x5981d8=_0x35f38c,clearInterval(this['_licenseKeyCheckInterval']),this['_licenseKeyCheckInterval']=void 0x0;break;}}'revisionHistoryLicenseKeyInvalid'==_0x5981d8&&_0x5c1ebb['_showLicenseError']('invalid'),'revisionHistoryLicenseKeyExpired'==_0x5981d8&&_0x5c1ebb['_showLicenseError']('expired'),'revisionHistoryLicenseKeyDomainLimit'==_0x5981d8&&_0x5c1ebb['_showLicenseError']('domainLimit'),'revisionHistoryLicenseKeyNotAllowed'==_0x5981d8&&_0x5c1ebb['_showLicenseError']('featureNotAllowed','RevisionHistory'),'revisionHistoryLicenseKeyEvaluationLimit'==_0x5981d8&&_0x5c1ebb['_showLicenseError']('evaluationLimit'),'revisionHistoryLicenseKeyTrialLimit'==_0x5981d8&&_0x5c1ebb['_showLicenseError']('trialLimit'),'revisionHistoryLicenseKeyUsageLimit'==_0x5981d8&&_0x5c1ebb['_showLicenseError']('usageLimit');},0x3e8);}async['afterInit'](){if(this['repository']['length']>0x0){const _0x1acece=this['repository']['getRevision'](0x0),_0x311d61=await this['getRevisionDocumentData'](_0x1acece),_0x2ee0df=await this['getRevisionRootsAttributes'](_0x1acece);this['_replaceEditorDataWithRevisionData'](_0x311d61,_0x2ee0df);}}['destroy'](){super['destroy'](),this['_licenseKeyCheckInterval']&&clearInterval(this['_licenseKeyCheckInterval']);}['setSource'](_0x4790b9){this['_source']=_0x4790b9;}async['update'](){const _0x2c7b55=await this['_source']['getLatestVersion']();if(_0x2c7b55>this['currentRevision']['toVersion']){await this['_loadState']();const _0x1359c4=this['buildRevisionData']({'revision':this['currentRevision'],'to':_0x2c7b55});_0x1359c4['authors']=_0x1359c4['authorsIds']['map'](_0x30a822=>this['editor']['plugins']['get']('Users')['getUser'](_0x30a822)),this['currentRevision']['_update'](_0x1359c4);}}async['saveRevision'](_0x1a30e1={},_0x38dd7e=null){const _0x4c8305=[];await this['_loadState'](),this['_continueCurrentRevision']=!0x1,_0x38dd7e>this['currentRevision']['toVersion']&&(_0x38dd7e=null),null===_0x38dd7e&&(_0x38dd7e=await this['_source']['getLatestVersion']());const _0x55f9df=this['_getFromVersion'](_0x38dd7e),_0x1f142b=this['buildRevisionData']({'from':_0x55f9df,'to':_0x38dd7e});if(this['currentRevision']['toVersion']<_0x38dd7e){const _0x90db6d=this['buildRevisionData']({'revision':this['currentRevision'],'from':_0x38dd7e,'to':_0x38dd7e});_0x90db6d['authors']=[],_0x90db6d['authorsIds']=[],_0x90db6d['id']=this['currentRevision']['id'],this['currentRevision']['_update'](_0x90db6d,!0x0),delete _0x90db6d['authors'],_0x4c8305['push'](_0x90db6d);}_0x1a30e1['creatorId']=this['editor']['plugins']['get']('Users')['me']['id'],_0x1a30e1['name']=_0x1a30e1['name']||null,_0x1a30e1['id']=_0x1a30e1['id']||_0x344b24(),_0x1a30e1={..._0x1a30e1,..._0x1f142b};const _0x59b9c8=this['addRevisionData'](_0x1a30e1);_0x4c8305['push'](_0x1a30e1);const _0x289519=this['repository']['getIndex'](_0x59b9c8);if(0x0!==_0x289519){const _0x5c0f13=this['repository']['getRevision'](_0x289519-0x1);if(_0x5c0f13['fromVersion']!==_0x38dd7e){const _0x531cfa=this['_revisionDataBuilder']['getData'](_0x38dd7e,_0x5c0f13['toVersion']),_0x50d0dd={'id':_0x5c0f13['id'],'diffData':_0x531cfa['diffData'],'authorsIds':_0x531cfa['authorsIds'],'authors':_0x531cfa['authorsIds']['map'](_0x5d236b=>this['editor']['plugins']['get']('Users')['getUser'](_0x5d236b)),'fromVersion':_0x38dd7e};_0x5c0f13===this['currentRevision']&&(_0x50d0dd['createdAt']=new Date(_0x1a30e1['createdAt']['getTime']()+0xa)),_0x5c0f13['_update'](_0x50d0dd,!0x0),delete _0x50d0dd['authors'],_0x4c8305['push'](_0x50d0dd);}}if(this['adapter']){for(const _0x1e09c1 of _0x4c8305)this['_bufferUpdate'](_0x1e09c1['id'],_0x1e09c1,!0x0);this['sendBufferedUpdates']();}return _0x59b9c8;}['addRevisionData'](_0x3d801e){const _0x283e95=this['repository']['createRevision'](_0x3d801e);return this['adapter']&&_0x283e95['on']('_update',(_0x3a5c4a,_0x2f6084,_0x58d7b4)=>{_0x58d7b4||(this['_bufferUpdate'](_0x2f6084['id'],_0x2f6084,!0x0),this['sendBufferedUpdates']());}),this['repository']['addRevision'](_0x283e95,this['_findInsertionIndex'](_0x283e95)),_0x283e95;}async['getRevisionDocumentData'](_0x498f2a){return await this['_utils']['loadRevisionData'](_0x498f2a,this['adapter']),this['_utils']['getRevisionDocumentData'](_0x498f2a);}async['getRevisionRootsAttributes'](_0x3be988){return await this['_utils']['loadRevisionData'](_0x3be988,this['adapter']),this['_utils']['getRevisionRootsAttributes'](_0x3be988);}['sendBufferedUpdates'](){if(0x0===this['_bufferedUpdates']['size'])return;if(this['_isPendingUpdate'])return;let _0x2378be=Array['from'](this['_bufferedUpdates']['values']());this['_bufferedUpdates']['clear']();for(let _0xac9153=0x0;_0xac9153<_0x2378be['length'];_0xac9153++){const _0x74ccb6=_0x2378be[_0xac9153];let _0x534149=!0x1;for(const _0x4779a1 of Object['keys'](_0x74ccb6))void 0x0===_0x74ccb6[_0x4779a1]?delete _0x74ccb6[_0x4779a1]:'id'!==_0x4779a1&&(_0x534149=!0x0);_0x534149||(_0x2378be[_0xac9153]=null);}if(_0x2378be=_0x2378be['filter'](_0x55caa0=>null!==_0x55caa0),!_0x2378be['length'])return;for(let _0x388304=0x0;_0x388304<_0x2378be['length'];_0x388304++){const _0x5d8059=_0x2378be[_0x388304];void 0x0!==_0x5d8059['fromVersion']&&void 0x0===_0x5d8059['toVersion']&&(_0x5d8059['toVersion']=this['repository']['getRevision'](_0x5d8059['id'])['toVersion']),void 0x0!==_0x5d8059['toVersion']&&void 0x0===_0x5d8059['fromVersion']&&(_0x5d8059['fromVersion']=this['repository']['getRevision'](_0x5d8059['id'])['fromVersion']);}const _0x4b6a78=this['editor']['config']['get']('collaboration.channelId');this['_isPendingUpdate']=!0x0,this['_addPendingAction'](),this['adapter']['updateRevisions'](_0x2378be,_0x4b6a78)['finally'](()=>{this['_isPendingUpdate']=!0x1;})['then'](_0x1c5d3b=>{if(_0x1c5d3b){for(const _0x419ddd of _0x1c5d3b)this['setRevisionData']({'id':_0x419ddd['id'],'createdAt':_0x419ddd['createdAt']});}this['_removePendingAction'](),this['sendBufferedUpdates']();});}['buildRevisionData']({revision:_0x4f48c9=null,from:_0x35d88d=null,to:_0x4344a3=null}){_0x35d88d=null!==_0x35d88d?_0x35d88d:_0x4f48c9['fromVersion'],_0x4344a3=null!==_0x4344a3?_0x4344a3:_0x4f48c9['toVersion'];const _0x1fcf76=this['_revisionDataBuilder']['getData'](_0x35d88d,_0x4344a3),_0x356320={'diffData':_0x1fcf76['diffData'],'authorsIds':_0x1fcf76['authorsIds'],'fromVersion':_0x35d88d,'toVersion':_0x4344a3};if(!_0x4f48c9||_0x4344a3!==_0x4f48c9['toVersion']){const _0x43f51a=_0x4344a3-0x1,_0x5523e6=this['_source']['history']['getOperation'](_0x43f51a);_0x356320['createdAt']=_0x5523e6&&_0x5523e6['createdAt']||new Date();}if(this['_loadedStateData']&&_0x35d88d===this['_loadedStateData']['fromVersion']){for(const _0x5bcf07 of this['_loadedStateData']['authors'])_0x356320['authorsIds']['includes'](_0x5bcf07['id'])||_0x356320['authorsIds']['push'](_0x5bcf07['id']);}return _0x356320;}['_bufferUpdate'](_0x3a2bd2,_0x34c517,_0x5ad686){if(this['_bufferedUpdates']['has'](_0x3a2bd2)){const _0x5aa63e=this['_bufferedUpdates']['get'](_0x3a2bd2);_0x34c517=_0x5ad686?{..._0x5aa63e,..._0x34c517}:{..._0x34c517,..._0x5aa63e};}this['_bufferedUpdates']['set'](_0x3a2bd2,_0x34c517);}['setRevisionData'](_0xa635cc){const _0x22c36c=this['repository']['getRevision'](_0xa635cc['id']);if(_0xa635cc['createdAt']&&(_0xa635cc['createdAt']=new Date(_0xa635cc['createdAt'])),_0xa635cc['authorsIds']){const _0x306010=this['editor']['plugins']['get']('Users');_0xa635cc['authors']=_0xa635cc['authorsIds']['map'](_0x1b11e1=>_0x306010['getUser'](_0x1b11e1));}_0x22c36c['_update'](_0xa635cc,!0x0);}['_createInitialRevision'](_0x3e577f){const _0x3bc9d0=this['repository']['getRevision'](this['repository']['length']-0x1);if(_0x3bc9d0)this['_initialRevisionId']=_0x3bc9d0['id'];else{const _0x12f81e=!this['editor']['model']['document']['roots']['find'](_0x573402=>this['editor']['model']['hasContent'](_0x573402)),_0x514488=this['editor']['plugins']['get']('Users')['me']['id'],_0x1930b8=g(this['editor']['locale'],_0x12f81e?'Empty\x20document':'Initial\x20revision');this['_makeRevision']({'from':_0x3e577f,'to':_0x3e577f,'id':this['_initialRevisionId'],'name':_0x1930b8,'creatorId':_0x514488});}}['_createCurrentRevision'](_0x5572bc){const _0x5db46a=this['_source']['getCurrentRevisionId']();this['currentRevision']=this['repository']['getRevision'](_0x5db46a),this['currentRevision']||(this['currentRevision']=this['_makeRevision']({'from':_0x5572bc,'to':_0x5572bc,'id':_0x5db46a,'name':'','creatorId':null}));}async['_loadState'](){this['_continueCurrentRevision']&&!this['_loadedStateData']&&(await this['_utils']['loadRevisionData'](this['currentRevision'],this['adapter']),this['_revisionDataBuilder']['loadState'](this['currentRevision']),this['_loadedStateData']={'fromVersion':this['currentRevision']['fromVersion'],'authors':this['currentRevision']['authors']['slice']()});}['_replaceEditorDataWithRevisionData'](_0x5bfd19,_0x5c35a0){let _0x4abb9d=this['editor']['config']['get']('initialData'),_0x496ee0=this['editor']['config']['get']('rootsAttributes');if(void 0x0===_0x4abb9d){_0x4abb9d={};for(const _0x31bf2e of this['editor']['model']['document']['getRootNames']())_0x4abb9d[_0x31bf2e]='';}if('string'==typeof _0x4abb9d&&(_0x4abb9d={'main':_0x4abb9d}),void 0x0===_0x496ee0){_0x496ee0={};for(const _0x288f6c of this['editor']['model']['document']['getRootNames']())_0x496ee0[_0x288f6c]={};}let _0x5e2c73=!0x1;const _0x1bdce8=Object['keys'](_0x4abb9d),_0x25559b=Object['keys'](_0x5bfd19);for(const _0x2f73c1 of _0x1bdce8){if(_0x4abb9d[_0x2f73c1]!==_0x5bfd19[_0x2f73c1]&&''!==_0x4abb9d[_0x2f73c1]['trim']()){_0x5e2c73=!0x0;break;}if(!_0x1fe332(_0x496ee0[_0x2f73c1],_0x5c35a0[_0x2f73c1])&&Object['keys'](_0x496ee0[_0x2f73c1])['length']>0x0){_0x5e2c73=!0x0;break;}}_0x5e2c73||(_0x5e2c73=_0x25559b['some'](_0x917727=>!this['editor']['model']['document']['getRoot'](_0x917727))),_0x5e2c73&&_0x21cb20('editor-initial-data-replaced-with-revision-data',{'editorData':_0x4abb9d,'editorRootsAttributes':_0x496ee0,'revisionData':_0x5bfd19,'revisionRootsAttributes':_0x5c35a0}),this['editor']['config']['set']('initialData',_0x5bfd19),this['editor']['config']['set']('rootsAttributes',_0x5c35a0);}['_addPendingAction'](){if(!this['_pendingAction']){const _0x24817e=this['editor']['plugins']['get']('PendingActions');this['_pendingAction']=_0x24817e['add'](g(this['editor']['locale'],'PENDING_ACTION_REVISION_HISTORY'));}}['_removePendingAction'](){this['_pendingAction']&&(this['editor']['plugins']['get']('PendingActions')['remove'](this['_pendingAction']),this['_pendingAction']=null);}['_findInsertionIndex'](_0x1b3dcd){const _0x3baebf=this['repository']['getRevisions']();_0x3baebf['reverse']();let _0x3bb50c=0x0;for(;_0x3bb50c<_0x3baebf['length'];){const _0x67785e=_0x3baebf[_0x3bb50c];if(_0x67785e===this['currentRevision']){_0x3bb50c++;continue;}if(_0x67785e['id']===this['_initialRevisionId'])break;const _0x338726=_0x1b3dcd['toVersion']-_0x67785e['toVersion']||_0x1b3dcd['fromVersion']-_0x67785e['fromVersion'];if(_0x338726>0x0)break;if(_0x338726<0x0)_0x3bb50c++;else{if(!_0x1b3dcd['creator']&&_0x67785e['creator'])break;if(_0x67785e['creator']||!_0x1b3dcd['creator']){if(_0x1b3dcd['createdAt']>_0x67785e['createdAt'])break;_0x3bb50c++;}else _0x3bb50c++;}}return _0x3bb50c;}['_getFromVersion'](_0x48e8fe){const _0x275a74=this['repository']['getRevisions']();_0x275a74['reverse'](),_0x275a74['shift']();const _0x4c1b85=_0x275a74['find'](_0x1dfde1=>_0x1dfde1['toVersion']<=_0x48e8fe)['toVersion'];return _0x4c1b85<this['_startingVersion']?this['_startingVersion']:_0x4c1b85;}['_makeRevision']({name:_0x2688ac,from:_0x4f798e,to:_0x80aeea,creatorId:_0x500ccf,id:_0x3b1682}){const _0x405bf5=this['buildRevisionData']({'from':_0x4f798e,'to':_0x80aeea});_0x405bf5['name']=_0x2688ac,_0x405bf5['creatorId']=_0x500ccf,_0x405bf5['id']=_0x3b1682;const _0x5ed95f=this['addRevisionData'](_0x405bf5);return this['adapter']&&this['_bufferUpdate'](_0x405bf5['id'],_0x405bf5,!0x0),_0x5ed95f;}['_setConversion'](){this['editor']['conversion']['for']('dataDowncast')['markerToData']({'model':'revision'});}}class x{['editor'];['source'];['_savedMetaData'];['_lastFrom'];['_lastTo'];['_markers'];['_diffRoots'];['_diffRootsAttributes'];['_baseRoots'];['_baseRootsAttributes'];['_idsRoots'];['_baseIdsRoots'];['_touched'];['_touchedMarkers'];['_touchedRoots'];['_revisionId'];['_startingRevisionId'];constructor(_0x21d0de){this['editor']=_0x21d0de,this['_savedMetaData']=new Map(),this['_lastFrom']=-0x1,this['_lastTo']=-0x1,this['_markers']=new Map(),this['_diffRoots']=new Map(),this['_diffRootsAttributes']=new Map(),this['_baseRoots']=new Map(),this['_baseRootsAttributes']=new Map(),this['_idsRoots']=new Map(),this['_baseIdsRoots']=new Map(),this['_touched']=new Map(),this['_touchedMarkers']=new Map(),this['_touchedRoots']=new Map(),this['_revisionId']=0x1;}['init'](_0x9d628){this['source']=_0x9d628;const _0x42a805=new Map(),_0x533efc=new Map(),_0x143e8b=this['editor']['model']['document']['roots']['map'](_0x1c2c16=>_0x1c2c16['rootName']);for(const _0x915063 of _0x143e8b){const _0x37975a=this['editor']['model']['document']['getRoot'](_0x915063),_0x401d40=N(_0x37975a);_0x42a805['set'](_0x915063,_0x401d40),_0x533efc['set'](_0x915063,Object['fromEntries'](_0x37975a['getAttributes']()));}const _0x273c6c=Array['from'](this['editor']['model']['markers'])['map'](_0x1c9a89=>[_0x1c9a89['name'],_0x1c9a89['getRange']()]),_0x599a69=this['source']['version'];this['_saveMetaData'](_0x599a69,_0x42a805,_0x273c6c,_0x533efc),this['_startingRevisionId']=this['_revisionId'];const _0x38c2bd=new Map(),_0x59bb9d=new Map();for(const _0x5f121e of _0x143e8b){const _0x49dcd6=P(_0x5f121e);_0x38c2bd['set'](_0x5f121e,_0x49dcd6),_0x59bb9d['set'](_0x5f121e,{});}this['_saveMetaData'](Number['NEGATIVE_INFINITY'],_0x38c2bd,[],_0x59bb9d);}['getData'](_0x71df2e,_0x43ca64){if(this['_lastFrom']===_0x71df2e&&this['_lastTo']<=_0x43ca64)this['_savedMetaData']['size']>0x1&&this['_removeMetaData'](this['_lastTo']),this['_applyOperations'](this['_lastTo'],_0x43ca64,!0x0);else{if(!this['_savedMetaData']['has'](_0x71df2e)){const _0x594bc3=this['_getPreviousFrom'](_0x71df2e);this['_calculateMetaData'](_0x594bc3,_0x71df2e,!0x1);}this['_calculateMetaData'](_0x71df2e,_0x43ca64,!0x0);}return this['_lastFrom']=_0x71df2e,this['_lastTo']=_0x43ca64,this['_getState']();}['loadState'](_0x5c9283){const _0x314594=this['editor']['plugins']['get']('RevisionHistoryUtils');this['_reset'](),this['_lastFrom']=_0x5c9283['fromVersion'],this['_lastTo']=_0x5c9283['toVersion'];for(const _0x5da967 in _0x5c9283['diffData']){const _0x2c58c4=_0x5c9283['diffData'][_0x5da967]['attachChange'],_0x21bdd5=_0x59b0b4(_0x5c9283['diffData'][_0x5da967]['attributesBefore'])||{},_0x4db2c5=_0x314594['_makeModelFromViewString'](_0x5c9283['diffData'][_0x5da967]['deletions']);_0x4db2c5['rootName']=_0x5da967,_0x4db2c5['_isAttached']=!_0x2c58c4||!_0x2c58c4['isAttached'],_0x4db2c5['isAttached']=()=>_0x4db2c5['_isAttached'],this['_baseRoots']['set'](_0x5da967,_0x4db2c5),this['_baseRootsAttributes']['set'](_0x5da967,_0x21bdd5),_0x2c58c4&&this['_touchedRoots']['set'](_0x5da967,_0x2c58c4);const _0xf921e1=this['_makeIdsRoot'](_0x4db2c5);this['_baseIdsRoots']['set'](_0x5da967,_0xf921e1);for(const [_0x19581e,_0x5af846]of _0x4db2c5['markers']){if(!_0x19581e['startsWith']('revision:'))continue;const _0x2709d6=_0x19581e['split'](':')[0x2];for(const _0x1cc94e of _0x5af846['getWalker']({'singleCharacters':!0x0})){const _0x4c5fc2=this['_getVidAttributeName'](_0x1cc94e),_0x3999af='elementEnd'==_0x1cc94e['type']?_0x1cc94e['previousPosition']['path']['slice'](0x0,-0x1):_0x1cc94e['previousPosition']['path'],_0x2b132e=_0xf921e1['getNodeByPath'](_0x3999af)['getAttribute'](_0x4c5fc2);this['_touched']['set'](_0x2b132e,{'userId':_0x2709d6});}}}this['_startingRevisionId']=this['_revisionId'];const _0x1cb9c9=[...Array(this['_revisionId'])['keys']()]['slice'](0x1)['filter'](_0x3cbf20=>!this['_touched']['has'](_0x3cbf20));let _0x3b5cb9=0x0;const _0x54bf76=new Map();for(const _0x30c5bf in _0x5c9283['diffData']){const _0x34d682=_0x5c9283['diffData'][_0x30c5bf]['attachChange'],_0x42a320=_0x59b0b4(_0x5c9283['diffData'][_0x30c5bf]['attributesAfter'])||{},_0x2e4884=_0x314594['_makeModelFromViewString'](_0x5c9283['diffData'][_0x30c5bf]['insertions']);_0x2e4884['rootName']=_0x30c5bf,_0x2e4884['_isAttached']=!_0x34d682||_0x34d682['isAttached'],_0x2e4884['isAttached']=()=>_0x2e4884['_isAttached'],this['_diffRoots']['set'](_0x30c5bf,_0x2e4884),this['_diffRootsAttributes']['set'](_0x30c5bf,_0x42a320);const _0x4eeb84=this['_makeIdsRoot'](_0x2e4884,Number['NEGATIVE_INFINITY']);this['_idsRoots']['set'](_0x30c5bf,_0x4eeb84),_0x54bf76['set'](_0x30c5bf,_0x2e4884['isAttached']()?_0x42a320:{});for(const [_0x1631f3,_0x2b3ad4]of _0x2e4884['markers']){if(!_0x1631f3['startsWith']('revision:'))continue;const _0xcbe474=_0x1631f3['split'](':')[0x2];for(const _0x3bcc62 of _0x2b3ad4['getWalker']({'singleCharacters':!0x0})){const _0x1e49dd=this['_getVidAttributeName'](_0x3bcc62),_0x191ce8=this['_revisionId']++,_0x2a922d='elementEnd'==_0x3bcc62['type']?_0x3bcc62['previousPosition']['path']['slice'](0x0,-0x1):_0x3bcc62['previousPosition']['path'];_0x4eeb84['getNodeByPath'](_0x2a922d)['_setAttribute'](_0x1e49dd,_0x191ce8),this['_touched']['set'](_0x191ce8,{'userId':_0xcbe474});}}for(const _0x3dca42 of this['editor']['model']['createRangeIn'](_0x2e4884)['getWalker']({'singleCharacters':!0x0})){const _0x45b4de=this['_getVidAttributeName'](_0x3dca42),_0x6978c3='elementEnd'==_0x3dca42['type']?_0x3dca42['previousPosition']['path']['slice'](0x0,-0x1):_0x3dca42['previousPosition']['path'],_0x5e6ba3=_0x4eeb84['getNodeByPath'](_0x6978c3);_0x5e6ba3['getAttribute'](_0x45b4de)>0x0||_0x5e6ba3['_setAttribute'](_0x45b4de,_0x1cb9c9[_0x3b5cb9++]);}for(const [_0x59d278,_0x3c93bc]of _0x2e4884['markers'])_0x59d278['startsWith']('revision:')||this['_markers']['set'](_0x59d278,_0x3c93bc);}const _0x1f50a4=P('$graveyard');this['_baseRoots']['set']('$graveyard',_0x1f50a4),this['_baseIdsRoots']['set']('$graveyard',this['_makeIdsRoot'](_0x1f50a4,0x1));const _0x2451db=P('$graveyard');this['_diffRoots']['set']('$graveyard',_0x2451db),this['_idsRoots']['set']('$graveyard',this['_makeIdsRoot'](_0x2451db,0x1));const _0x4c2ed5=Array['from'](this['_diffRoots'])['map'](([_0x5d020a,_0x4520d9])=>[_0x5d020a,N(_0x4520d9)]);this['_saveMetaData'](this['_lastTo'],_0x4c2ed5,this['_markers'],_0x54bf76);}['reInit'](){this['_reset'](),this['_lastFrom']=-0x1,this['_lastTo']=-0x1,this['_savedMetaData']['clear'](),this['init'](this['source']);}['_saveMetaData'](_0x514b23,_0x9e812d,_0x2d7c41,_0x38f8ea){const _0x48af56=new Map(_0x9e812d),_0x51ba13=new Map(_0x59b0b4(_0x38f8ea)),_0xb20072=new Map();for(const [_0x3cfe37,_0x8ec3c7]of _0x2d7c41)_0xb20072['set'](_0x3cfe37,{'start':_0x8ec3c7['start']['clone'](),'end':_0x8ec3c7['end']['clone'](),'rootName':_0x8ec3c7['root']['rootName']});this['_savedMetaData']['set'](_0x514b23,{'roots':_0x48af56,'markers':_0xb20072,'rootsAttributes':_0x51ba13});}['_removeMetaData'](_0x30b330){this['_savedMetaData']['delete'](_0x30b330);}['_reset'](){this['_touched']['clear'](),this['_touchedMarkers']['clear'](),this['_touchedRoots']['clear'](),this['_diffRoots']['clear'](),this['_diffRootsAttributes']['clear'](),this['_baseRoots']['clear'](),this['_baseRootsAttributes']['clear'](),this['_idsRoots']['clear'](),this['_baseIdsRoots']['clear'](),this['_markers']['clear'](),this['_revisionId']=0x1,this['_startingRevisionId']=this['_revisionId'];}['_makeIdsRoot'](_0x4b43c3,_0xaa991c=null){let _0x51cc88=null;_0x4b43c3['is']('documentFragment')||(_0x51cc88=new ut(_0x4b43c3['name'],{'vid_start':null===_0xaa991c?this['_revisionId']++:_0xaa991c++}));const _0x29e4a8=[];for(const _0x30ce5b of _0x4b43c3['getChildren']())if(_0x30ce5b['is']('element')){_0x29e4a8['push'](this['_makeIdsRoot'](_0x30ce5b,_0xaa991c));const _0x5ce874=_0x29e4a8[_0x29e4a8['length']-0x1];null!==_0xaa991c&&(_0xaa991c=_0x5ce874['is']('element','$text')?_0x5ce874['getAttribute']('vid')+0x1:_0x5ce874['getAttribute']('vid_end')+0x1);}else{for(let _0x22392a=0x0;_0x22392a<_0x30ce5b['offsetSize'];_0x22392a++)_0x29e4a8['push'](new ut('$text',{'vid':null===_0xaa991c?this['_revisionId']++:_0xaa991c++}));}if(_0x4b43c3['is']('documentFragment')){const _0x1e3a0a=P(_0x4b43c3['rootName']);return _0x1e3a0a['_insertChild'](0x0,_0x29e4a8),_0x1e3a0a;}return _0x51cc88['_setAttribute']('vid_end',null===_0xaa991c?this['_revisionId']++:_0xaa991c++),_0x51cc88['_insertChild'](0x0,_0x29e4a8),_0x51cc88;}['_calculateMetaData'](_0x405b81,_0xd13458,_0x4ee36e){this['_reset']();const {roots:_0x5bb2c2,markers:_0x2b368a,rootsAttributes:_0x18a2ef}=this['_savedMetaData']['get'](_0x405b81);this['_baseRoots']=new Map(_0x5bb2c2),this['_baseRootsAttributes']=new Map(_0x59b0b4(_0x18a2ef));for(const [_0x5afd63,_0x4f8f8e]of this['_baseRoots'])if('$graveyard'!==_0x5afd63&&(this['_diffRoots']['set'](_0x5afd63,N(_0x4f8f8e)),this['_diffRootsAttributes']=new Map(_0x59b0b4(_0x18a2ef)),_0x4ee36e)){const _0x3be7fe=this['_revisionId'];this['_idsRoots']['set'](_0x5afd63,this['_makeIdsRoot'](_0x4f8f8e)),this['_baseIdsRoots']['set'](_0x5afd63,this['_makeIdsRoot'](_0x4f8f8e,_0x3be7fe));}this['_startingRevisionId']=this['_revisionId'],this['_diffRoots']['set']('$graveyard',N(this['_baseRoots']['get']('$graveyard'))),_0x4ee36e&&this['_idsRoots']['set']('$graveyard',this['_makeIdsRoot'](this['_baseRoots']['get']('$graveyard')));for(const [_0x3fa5c5,_0x115d57]of _0x2b368a){const _0x4b47f7=this['_baseRoots']['get'](_0x115d57['rootName']),_0x105ad7=this['_diffRoots']['get'](_0x115d57['rootName']),_0x17c7d7=new ft(this['_fixPosition'](_0x115d57['start'],_0x4b47f7),this['_fixPosition'](_0x115d57['end'],_0x4b47f7)),_0x3d4cd3=this['_fixRange'](_0x17c7d7,_0x105ad7);_0x4b47f7['markers']['set'](_0x3fa5c5,_0x17c7d7),this['_markers']['set'](_0x3fa5c5,_0x3d4cd3);}this['_applyOperations'](_0x405b81,_0xd13458,_0x4ee36e);}['_applyOperations'](_0x1e1bd6,_0x335c6e,_0x52aae8){for(const _0x7a7b88 of this['source']['getOperations'](_0x1e1bd6,_0x335c6e))this['_handleOperation'](_0x7a7b88,_0x52aae8);for(const _0x4c923f of this['_diffRoots']['values']())_0x4c923f['markers']['clear']();for(const [_0x560fbc,_0x467e3d]of this['_markers']){this['_diffRoots']['get'](_0x467e3d['root']['rootName'])['markers']['set'](_0x560fbc,_0x467e3d['clone']());}const _0x4923f2=new Map(),_0x270e1e=new Map();for(const [_0x19fa6a,_0x4ca094]of this['_diffRoots'])_0x4923f2['set'](_0x19fa6a,N(_0x4ca094)),_0x270e1e['set'](_0x19fa6a,this['_diffRootsAttributes']['get'](_0x19fa6a));this['_saveMetaData'](_0x335c6e,_0x4923f2,this['_markers'],_0x270e1e);}['_getPreviousFrom'](_0x252bd4){const _0x2a9be7=Array['from'](this['_savedMetaData']['keys']());_0x2a9be7['sort']((_0x514451,_0x364398)=>_0x514451-_0x364398),_0x2a9be7['reverse']();for(const _0x42f5e8 of _0x2a9be7)if(_0x42f5e8<_0x252bd4)return _0x42f5e8;return Number['NEGATIVE_INFINITY'];}['_copyMarkers'](_0x40d8fd,_0x32f903){const _0xcfcb03=Array['from'](_0x32f903['markers'])['map'](([_0xf211fd,_0x25d8ca])=>[_0xf211fd,this['_fixRange'](_0x25d8ca,_0x40d8fd)]);_0x40d8fd['markers']=new Map(_0xcfcb03);}['_transformMarkers'](_0x281190){for(const _0x30e138 of this['_markers']['values']()){const _0x251656=_0x30e138['getTransformedByOperation'](_0x281190),_0x3944e5=ft['_createFromRanges'](_0x251656);_0x30e138['start']=_0x3944e5['start'],_0x30e138['end']=_0x3944e5['end'];}}['_handleOperation'](_0x4bc152,_0x40a384){if('addRoot'!=_0x4bc152['type']&&'detachRoot'!=_0x4bc152['type']){if('insert'==_0x4bc152['type']){const _0x3bc270=_0x4bc152['position']['root']['rootName'];this['_diffRoots']['has'](_0x3bc270)||(this['_diffRoots']['set'](_0x3bc270,P(_0x3bc270,!0x0)),this['_diffRootsAttributes']['set'](_0x3bc270,{}),_0x40a384&&this['_idsRoots']['set'](_0x3bc270,P(_0x3bc270,!0x0)));}else{if('addRootAttribute'==_0x4bc152['type']||'removeRootAttribute'==_0x4bc152['type']||'changeRootAttribute'==_0x4bc152['type'])return void this['_handleRootAttributeOperation'](_0x4bc152);'marker'==_0x4bc152['type']&&this['_handleMarkerOperation'](_0x4bc152);}if('marker'!==_0x4bc152['type']){const _0x5d5d87=this['_cloneOperation'](_0x4bc152,this['_diffRoots']);_0x5d5d87['_execute'](),this['_transformMarkers'](_0x5d5d87);}if(_0x40a384)switch(_0x4bc152['type']){case'insert':this['_handleInsertOperation'](_0x4bc152);break;case'move':case'remove':case'reinsert':this['_handleMoveOperation'](_0x4bc152);break;case'merge':this['_handleMergeOperation'](_0x4bc152);break;case'split':this['_handleSplitOperation'](_0x4bc152);}}else this['_handleRootOperation'](_0x4bc152,_0x40a384);}['_cloneOperation'](_0x323323,_0x29c665){const _0xdd6f1c=_0x323323['clone']();return _0xdd6f1c['_authorId']=_0x323323['_authorId'],this['_fixOperation'](_0xdd6f1c,_0x29c665),_0xdd6f1c;}['_getBaseVids'](_0x203bd7){return _0x203bd7['map'](_0x19f822=>{const _0x1ab617=this['_getVidAttributeName'](_0x19f822);return Number(_0x19f822['item']['getAttribute'](_0x1ab617));});}['_generateTape'](_0x1874da,_0x3487a4){if(_0x1874da['is']('element','$text'))_0x3487a4['push']({'item':_0x1874da,'type':'text'});else{_0x1874da['is']('element')&&_0x3487a4['push']({'item':_0x1874da,'type':'elementStart'});for(const _0x4fccc9 of _0x1874da['getChildren']())this['_generateTape'](_0x4fccc9,_0x3487a4);_0x1874da['is']('element')&&_0x3487a4['push']({'item':_0x1874da,'type':'elementEnd'});}return _0x3487a4;}['_getState'](){const _0x5a141e=new Map(this['_touched']),_0x19d535=new Map(_0x5a141e),_0x2d4d35=new Map(),_0x3a2a10={'insertions':{},'deletions':{}},_0x4f25e5={'insertions':{},'deletions':{}},_0x25b2a4=new Map(),_0x33d746=new Set([...this['_baseRoots']['keys'](),...this['_diffRoots']['keys']()]);_0x33d746['delete']('$graveyard');for(const _0x3c53ae of _0x33d746){const _0x49beaa=this['_diffRoots']['get'](_0x3c53ae)||P(_0x3c53ae,!0x1),_0x35f6b4=this['_baseRoots']['get'](_0x3c53ae)||P(_0x3c53ae,!0x1);_0x49beaa['isAttached']()||_0x35f6b4['isAttached']()?(_0x3a2a10['insertions'][_0x3c53ae]=N(_0x49beaa),_0x3a2a10['deletions'][_0x3c53ae]=N(_0x35f6b4),this['_copyMarkers'](_0x3a2a10['deletions'][_0x3c53ae],_0x35f6b4),this['_copyMarkers'](_0x3a2a10['insertions'][_0x3c53ae],_0x49beaa),_0x4f25e5['insertions'][_0x3c53ae]=this['_generateTape'](this['_idsRoots']['get'](_0x3c53ae),[]),_0x4f25e5['deletions'][_0x3c53ae]=this['_generateTape'](this['_baseIdsRoots']['get'](_0x3c53ae)||P(_0x3c53ae,!0x1),[])):_0x33d746['delete'](_0x3c53ae);}for(const _0x394c0f of _0x33d746){const _0x27b771=_0x4f25e5['insertions'][_0x394c0f];for(const _0x12288b of _0x27b771){const _0x1325ab=this['_getVidAttributeName'](_0x12288b),_0x1f99d7=_0x12288b['item']['getAttribute'](_0x1325ab);_0x19d535['delete'](_0x1f99d7),_0x1f99d7>=this['_startingRevisionId']&&_0x2d4d35['set'](_0x1f99d7,_0x5a141e['get'](_0x1f99d7));}}for(const _0x577b86 of _0x33d746){const _0x5ac40d=_0x4f25e5['insertions'][_0x577b86],_0x1fd429=this['_getBaseVids'](_0x4f25e5['deletions'][_0x577b86]);let _0x57ce72=0x0;for(const _0x3382d6 of _0x5ac40d){const _0x56c50b=this['_getVidAttributeName'](_0x3382d6),_0x4301d6=_0x3382d6['item']['getAttribute'](_0x56c50b);if(!_0x2d4d35['has'](_0x4301d6)&&!_0x25b2a4['has'](_0x4301d6)){if(_0x19d535['has'](_0x4301d6))_0x57ce72++;else{if(_0x4301d6!=_0x1fd429[_0x57ce72]){const _0x23e425=_0x5a141e['get'](_0x4301d6)||_0x5a141e['get'](_0x1fd429[_0x57ce72]);for(;_0x4301d6!=_0x1fd429[_0x57ce72];)_0x19d535['has'](_0x1fd429[_0x57ce72])||(_0x25b2a4['set'](_0x1fd429[_0x57ce72],_0x23e425),_0x5a141e['set'](_0x1fd429[_0x57ce72],_0x23e425)),_0x57ce72++;}_0x57ce72++;}}}}for(const _0x2a2db3 of _0x33d746){const _0x412396=_0x4f25e5['insertions'][_0x2a2db3];for(const _0x70d414 of _0x412396){const _0x2295f5=this['_getVidAttributeName'](_0x70d414),_0x560618=_0x70d414['item']['getAttribute'](_0x2295f5);if(_0x25b2a4['has'](_0x560618)){const _0x5ad06f=_0x25b2a4['get'](_0x560618);_0x19d535['has'](_0x560618)||_0x19d535['set'](_0x560618,{..._0x5ad06f}),_0x2d4d35['set'](_0x560618,{..._0x5ad06f});}}}for(const _0x4284ca of _0x19d535['keys']())_0x4284ca>=this['_startingRevisionId']&&_0x19d535['delete'](_0x4284ca);const _0x103cc8=new Map();for(const _0x59085d of _0x33d746){let _0x12be18=_0x4f25e5['insertions'][_0x59085d];for(const _0x2201b2 of _0x12be18)if(_0x2201b2['item']['is']('element','tableCell')){const _0x17c694=this['_getVidAttributeName'](_0x2201b2),_0x2e3233=_0x2201b2['item']['getAttribute'](_0x17c694);if(_0x2d4d35['has'](_0x2e3233)){const _0x54b3ac=_0x2201b2['item']['parent']['parent']['getAttribute']('vid_start'),_0x9d85ce=_0x103cc8['get'](_0x54b3ac)||new Set();_0x9d85ce['add'](_0x2d4d35['get'](_0x2e3233)['userId']),_0x103cc8['set'](_0x54b3ac,_0x9d85ce);}}_0x12be18=_0x4f25e5['deletions'][_0x59085d];for(const _0x1bd239 of _0x12be18)if(_0x1bd239['item']['is']('element','tableCell')){const _0xfdde95=this['_getVidAttributeName'](_0x1bd239),_0x1f2838=_0x1bd239['item']['getAttribute'](_0xfdde95);if(_0x19d535['has'](_0x1f2838)){const _0x590867=_0x1bd239['item']['parent']['parent']['getAttribute']('vid_start'),_0x2eec5a=_0x103cc8['get'](_0x590867)||new Set();_0x2eec5a['add'](_0x19d535['get'](_0x1f2838)['userId']),_0x103cc8['set'](_0x590867,_0x2eec5a);}}for(const _0x24491c of _0x103cc8['keys']())(_0x2d4d35['has'](_0x24491c)||_0x19d535['has'](_0x24491c))&&_0x103cc8['delete'](_0x24491c);}for(const _0x537dc3 of _0x33d746){const _0x5099d4=_0x4f25e5['insertions'][_0x537dc3];let _0x2d2662=null,_0x5e3159=null;for(const _0x2767cd of _0x5099d4){const _0x33a7a5=this['_getVidAttributeName'](_0x2767cd),_0x23c11f=_0x2767cd['item']['getAttribute'](_0x33a7a5),_0x10629a=_0x103cc8['get'](_0x23c11f);_0x10629a&&'elementStart'==_0x2767cd['type']&&(_0x2d2662=Array['from'](_0x10629a)[0x0],_0x5e3159=_0x2767cd['item']['getAttribute']('vid_end')),_0x2d2662&&(_0x19d535['set'](_0x23c11f,{'userId':_0x2d2662}),_0x2d4d35['set'](_0x23c11f,{'userId':_0x2d2662})),_0x23c11f==_0x5e3159&&(_0x2d2662=null,_0x5e3159=null);}}const _0x1916a3={},_0x56a06a=new Set();for(const _0x32d177 of _0x33d746){const _0x2c9732=_0x3a2a10['deletions'][_0x32d177],_0x2ae040=_0x3a2a10['insertions'][_0x32d177];for(const {userId:_0x190f8b}of this['_touchedMarkers']['values']())null!==_0x190f8b&&_0x56a06a['add'](_0x190f8b);for(const {userId:_0x149cc1}of this['_touchedRoots']['values']())null!==_0x149cc1&&_0x56a06a['add'](_0x149cc1);this['_markChanges'](_0x2ae040,_0x4f25e5['insertions'][_0x32d177],_0x2d4d35,'insertion',_0x56a06a),this['_markChanges'](_0x2c9732,_0x4f25e5['deletions'][_0x32d177],_0x19d535,'deletion',_0x56a06a),_0x1916a3[_0x32d177]={'insertions':this['_prepareViewToSave'](_0x2ae040),'deletions':this['_prepareViewToSave'](_0x2c9732),'attachChange':this['_touchedRoots']['get'](_0x32d177)||null,'attributesBefore':_0x59b0b4(this['_baseRootsAttributes']['get'](_0x32d177))||{},'attributesAfter':_0x59b0b4(this['_diffRootsAttributes']['get'](_0x32d177))};}return{'diffData':_0x1916a3,'authorsIds':Array['from'](_0x56a06a)};}['_processRootBeforeSave'](_0x47e0f0){for(const [,_0x50c13f]of _0x47e0f0['markers']){const _0x2c5e3c=_0x50c13f['start']['getAncestors']()['filter'](_0x1dd98f=>'tableCell'==_0x1dd98f['name']);for(const _0x2197a6 of _0x2c5e3c)0x1==_0x2197a6['childCount']&&_0x2197a6['getChild'](0x0)['is']('element','paragraph')&&_0x2197a6['getChild'](0x0)['_setAttribute']('keepParagraph',!0x0);}}['_prepareViewToSave'](_0x3a8f6f){this['_processRootBeforeSave'](_0x3a8f6f);const _0x45469b=this['editor']['data']['toView'](_0x3a8f6f,{}),_0x204592=Array['from'](_0x45469b['getChildren']())['map'](_0xb29ffc=>this['_getViewJson'](_0xb29ffc));return JSON['stringify'](_0x204592);}['_getViewJson'](_0x10c96e){if(_0x10c96e['is']('$text'))return _0x10c96e['data'];{const _0x5aebc3=this['editor']['plugins']['get']('RevisionHistoryUtils'),_0x297a6e=_0x10c96e,_0x4bc5ac=this['editor']['data']['htmlProcessor']['domConverter'],_0x5d328d={'type':_0x5aebc3['_getTypeCharForViewElement'](_0x297a6e),'name':_0x297a6e['name'],'attributes':Array['from'](_0x297a6e['getAttributes']()),'children':Array['from'](_0x297a6e['getChildren']())['map'](_0x1ca9a3=>this['_getViewJson'](_0x1ca9a3))};if(_0x10c96e['is']('uiElement')&&'$comment'!=_0x10c96e['name']){const _0x4d9b0c=_0x10c96e['render'](_0x4bc5ac['domDocument'],_0x4bc5ac);_0x5d328d['children']['push'](_0x4d9b0c['outerHTML']);}else{if(_0x10c96e['is']('rawElement')){const _0x48be18=_0x4bc5ac['domDocument']['createElement'](_0x297a6e['name']);_0x10c96e['render'](_0x48be18,_0x4bc5ac),_0x5d328d['children']['push'](_0x48be18['innerHTML']);}}const _0x154bb6=Array['from'](_0x297a6e['getCustomProperties']());_0x154bb6['length']>0x0&&(_0x5d328d['customProperties']=_0x154bb6);const _0x6e6350=_0x297a6e['getFillerOffset']();return null!==_0x6e6350&&(_0x5d328d['fillerOffset']=_0x6e6350),_0x5d328d;}}['_markChanges'](_0xdc630,_0x8a54c9,_0x1f0087,_0x974520,_0x30aba4){let _0x176c2e=null,_0x451482=null,_0x34208c=0x0;const _0x30a7f2=this['editor']['model'];for(let _0x4b1c3d=0x0;_0x4b1c3d<_0x8a54c9['length'];_0x4b1c3d++){const _0x22cd30=this['_getVidAttributeName'](_0x8a54c9[_0x4b1c3d]),_0x363549=_0x8a54c9[_0x4b1c3d]['item']['getAttribute'](_0x22cd30),_0x536eb4=_0x1f0087['get'](_0x363549),_0x2b176d=_0x4b1c3d==_0x8a54c9['length']-0x1;(!_0x176c2e&&_0x536eb4&&(_0x176c2e=_0x536eb4,_0x451482=_0x8a54c9[_0x4b1c3d]),_0x176c2e&&(!_0x536eb4||_0x536eb4['userId']!=_0x176c2e['userId']))&&(_0x1c5582(_0x536eb4,F(_0x451482,_0xdc630,_0x30a7f2),F(_0x8a54c9[_0x4b1c3d],_0xdc630,_0x30a7f2)),_0x176c2e=_0x536eb4||null,_0x451482=_0x536eb4?_0x8a54c9[_0x4b1c3d]:null),_0x176c2e&&_0x2b176d&&_0x1c5582(_0x536eb4,F(_0x451482,_0xdc630,_0x30a7f2),B(_0x8a54c9[_0x4b1c3d],_0xdc630,_0x30a7f2));}function _0x1c5582(_0x218b62,_0x1ebe54,_0xfa44a0){const _0xf33c3c=_0x176c2e['userId'],_0x572ce1='revision:'+_0x974520+':'+_0xf33c3c+':'+_0x34208c++,_0x233e4e=_0x30a7f2['createRange'](_0x1ebe54,_0xfa44a0);_0xdc630['markers']['set'](_0x572ce1,_0x233e4e),null!==_0xf33c3c&&_0x30aba4['add'](_0xf33c3c);}}['_getVidAttributeName'](_0x4cdde9){switch(_0x4cdde9['type']){case'elementStart':return'vid_start';case'elementEnd':return'vid_end';default:return'vid';}}['_fixOperation'](_0x131fe1,_0x2f221e){_0x131fe1['baseVersion']=null;for(const _0x5f15e5 in _0x131fe1){const _0x4920b8=_0x131fe1[_0x5f15e5];if(_0x4920b8 instanceof vt){const _0x2259f9=_0x2f221e['get'](_0x4920b8['root']['rootName']);_0x131fe1[_0x5f15e5]=this['_fixPosition'](_0x4920b8,_0x2259f9);}if(_0x4920b8 instanceof ft){const _0x359267=_0x2f221e['get'](_0x4920b8['root']['rootName']);_0x131fe1[_0x5f15e5]=this['_fixRange'](_0x4920b8,_0x359267);}'root'===_0x5f15e5&&(_0x131fe1['root']=_0x2f221e['get'](_0x131fe1['root']['rootName']));}}['_fixRange'](_0x1036d1,_0x4ff0f7){return this['editor']['model']['createRange'](this['_fixPosition'](_0x1036d1['start'],_0x4ff0f7),this['_fixPosition'](_0x1036d1['end'],_0x4ff0f7));}['_fixPosition'](_0x3e22c1,_0x4b9077){return this['editor']['model']['createPositionFromPath'](_0x4b9077,_0x3e22c1['path'],_0x3e22c1['stickiness']);}['_handleInsertOperation'](_0x1560e2){const _0x2725bd=this['_idsRoots']['get'](_0x1560e2['position']['root']['rootName']),_0x215a00=this['_fixPosition'](_0x1560e2['position'],_0x2725bd),_0x22250a=null===_0x1560e2['_authorId']?null:_0x1560e2['_authorId']||this['editor']['plugins']['get']('Users')['me']['id'],_0x522104=_0x215a00['parent'],_0x11a0cf=this['_revisionId'],_0x188831=[];for(const _0x47e4d8 of _0x1560e2['nodes'])if(_0x47e4d8['is']('element'))_0x188831['push'](this['_makeIdsRoot'](_0x47e4d8));else{for(let _0x2b8ea9=0x0;_0x2b8ea9<_0x47e4d8['offsetSize'];_0x2b8ea9++)_0x188831['push'](new ut('$text',{'vid':this['_revisionId']++}));}const _0x3b0c6c=this['_revisionId'];for(let _0x3717fc=_0x11a0cf;_0x3717fc<_0x3b0c6c;_0x3717fc++)this['_touched']['set'](_0x3717fc,{'userId':_0x22250a});_0x522104['_insertChild'](_0x215a00['offset'],_0x188831);}['_handleMoveOperation'](_0x427b4){(_0x427b4=this['_cloneOperation'](_0x427b4,this['_idsRoots']))['_execute']();const _0x1b2737=null===_0x427b4['_authorId']?null:_0x427b4['_authorId']||this['editor']['plugins']['get']('Users')['me']['id'],_0x3b9d85=_0x427b4['getMovedRangeStart'](),_0xf1e35f=_0x3b9d85['parent'],_0x415f6a=_0x3b9d85['offset'];!function _0x2c1eb7(_0x410756,_0x4a20bf,_0x11dd0b,_0x3d25e9){for(let _0x504f71=_0x11dd0b;_0x504f71<_0x3d25e9;_0x504f71++){const _0xb10406=_0x4a20bf['getChild'](_0x504f71);_0xb10406['is']('element','$text')?_0x410756['set'](_0xb10406['getAttribute']('vid'),{'userId':_0x1b2737}):(_0x410756['set'](_0xb10406['getAttribute']('vid_start'),{'userId':_0x1b2737}),_0x2c1eb7(_0x410756,_0xb10406,0x0,_0xb10406['childCount']),_0x410756['set'](_0xb10406['getAttribute']('vid_end'),{'userId':_0x1b2737}));}}(this['_touched'],_0xf1e35f,_0x415f6a,_0x415f6a+_0x427b4['howMany']);}['_handleMergeOperation'](_0x278048){const _0x5c6921=null===(_0x278048=this['_cloneOperation'](_0x278048,this['_idsRoots']))['_authorId']?null:_0x278048['_authorId']||this['editor']['plugins']['get']('Users')['me']['id'],_0xdd7966=_0x278048['targetPosition']['parent'],_0xb1cd57=_0x278048['sourcePosition']['parent'],_0x20e462=_0xdd7966['getAttribute']('vid_end'),_0x3d3413=_0xb1cd57['getAttribute']('vid_start');_0xdd7966['_setAttribute']('vid_end',_0xb1cd57['getAttribute']('vid_end')),_0xb1cd57['_setAttribute']('vid_end',_0x20e462),this['_touched']['set'](_0x3d3413,{'userId':_0x5c6921}),this['_touched']['set'](_0x20e462,{'userId':_0x5c6921}),_0x278048['_execute']();}['_handleSplitOperation'](_0x5a93ed){const _0x33890b=null===(_0x5a93ed=this['_cloneOperation'](_0x5a93ed,this['_idsRoots']))['_authorId']?null:_0x5a93ed['_authorId']||this['editor']['plugins']['get']('Users')['me']['id'],_0x18aee7=_0x5a93ed['graveyardPosition'],_0x15d813=_0x5a93ed['splitPosition']['parent'];_0x5a93ed['_execute']();const _0xc2a548=_0x15d813['getAttribute']('vid_end'),_0x3771c4=_0x5a93ed['insertionPosition']['nodeAfter'];if(_0x18aee7){const _0x518937=_0x3771c4['getAttribute']('vid_end'),_0x538203=_0x15d813['getAttribute']('vid_end');_0x15d813['_setAttribute']('vid_end',_0x518937),_0x3771c4['_setAttribute']('vid_end',_0x538203),this['_touched']['set'](_0x15d813['getAttribute']('vid_end'),{'userId':_0x33890b}),this['_touched']['set'](_0x3771c4['getAttribute']('vid_start'),{'userId':_0x33890b});}else{const _0x135da4=this['_revisionId']++,_0x545af7=this['_revisionId']++;_0x15d813['_setAttribute']('vid_end',_0x135da4),_0x3771c4['_setAttribute']('vid_start',_0x545af7),_0x3771c4['_setAttribute']('vid_end',_0xc2a548),this['_touched']['set'](_0x135da4,{'userId':_0x33890b}),this['_touched']['set'](_0x545af7,{'userId':_0x33890b});}}['_handleMarkerOperation'](_0x4aa8ad){if(!_0x4aa8ad['affectsData'])return;const _0x39541a=(_0x4aa8ad=this['_cloneOperation'](_0x4aa8ad,this['_diffRoots']))['oldRange']?_0x4aa8ad['oldRange']['root']:null,_0x26b4ab=_0x4aa8ad['newRange']?_0x4aa8ad['newRange']['root']:null;_0x39541a&&this['_markers']['delete'](_0x4aa8ad['name']),_0x26b4ab&&this['_markers']['set'](_0x4aa8ad['name'],_0x4aa8ad['newRange']['clone']());const _0x21ef82=null===_0x4aa8ad['_authorId']?null:_0x4aa8ad['_authorId']||this['editor']['plugins']['get']('Users')['me']['id'],_0x33d201=_0x4aa8ad['name'];if(!this['_touchedMarkers']['has'](_0x33d201))return void this['_touchedMarkers']['set'](_0x33d201,{'range':_0x4aa8ad['oldRange'],'userId':_0x21ef82});const _0x166031=this['_touchedMarkers']['get'](_0x33d201),_0x12daf6=_0x166031['range'],_0x24c344=_0x4aa8ad['newRange'];null==_0x12daf6&&null==_0x24c344||_0x12daf6&&_0x24c344&&_0x12daf6['isEqual'](_0x24c344)?this['_touchedMarkers']['delete'](_0x4aa8ad['name']):_0x166031['userId']=_0x21ef82;}['_handleRootOperation'](_0x4b755c,_0x28f7d6){this['_diffRoots']['has'](_0x4b755c['rootName'])?this['_diffRoots']['get'](_0x4b755c['rootName'])['_isAttached']=_0x4b755c['isAdd']:(this['_diffRoots']['set'](_0x4b755c['rootName'],P(_0x4b755c['rootName'],!0x0)),this['_diffRootsAttributes']['set'](_0x4b755c['rootName'],{}),_0x28f7d6&&this['_idsRoots']['set'](_0x4b755c['rootName'],P(_0x4b755c['rootName'],!0x0)));const _0x3bba3e=null===_0x4b755c['_authorId']?null:_0x4b755c['_authorId']||this['editor']['plugins']['get']('Users')['me']['id'],_0x1a12fb=this['_touchedRoots']['get'](_0x4b755c['rootName']);_0x1a12fb&&_0x1a12fb['userId']===_0x3bba3e?this['_touchedRoots']['delete'](_0x4b755c['rootName']):this['_touchedRoots']['set'](_0x4b755c['rootName'],{'userId':_0x3bba3e,'isAttached':_0x4b755c['isAdd']});}['_handleRootAttributeOperation'](_0x20fd73){const _0x53300e=this['_diffRootsAttributes']['get'](_0x20fd73['root']['rootName']);null===_0x20fd73['newValue']?delete _0x53300e[_0x20fd73['key']]:_0x53300e[_0x20fd73['key']]=_0x20fd73['newValue'];}}function N(_0x2b61ab){const _0x103658=P(_0x2b61ab['rootName'],_0x2b61ab['isAttached']());for(const _0x240aa8 of _0x2b61ab['getChildren']()){const _0x140e66=_0x240aa8['_clone'](!0x0);_0x103658['_appendChild'](_0x140e66);}return _0x103658;}function P(_0x2f290d,_0x54055f=!0x0){const _0x3af415=new gt();return _0x3af415['rootName']=_0x2f290d,_0x3af415['_isAttached']=_0x54055f,_0x3af415['isAttached']=()=>_0x3af415['_isAttached'],_0x3af415;}function F(_0x3d9038,_0x5e8cb9,_0x36ca80){const _0x21b909='elementEnd'==_0x3d9038['type']?_0x36ca80['createPositionAt'](_0x3d9038['item'],'end'):_0x36ca80['createPositionBefore'](_0x3d9038['item']);return _0x36ca80['createPositionFromPath'](_0x5e8cb9,_0x21b909['path'],_0x21b909['stickiness']);}function B(_0x4a6f13,_0x149cf3,_0xc29dbf){const _0x2a23d3='elementStart'==_0x4a6f13['type']?_0xc29dbf['createPositionAt'](_0x4a6f13['item'],0x0):_0xc29dbf['createPositionAfter'](_0x4a6f13['item']);return _0xc29dbf['createPositionFromPath'](_0x149cf3,_0x2a23d3['path'],_0x2a23d3['stickiness']);}class os extends _0x19ab0f{['focusTracker'];['keystrokes'];['revisionNameInputView'];constructor(_0x301a5e,_0x54ea97){super(_0x301a5e),this['focusTracker']=new _0x22d8c2(),this['keystrokes']=new _0x3b7f0c(),this['set']('revisionNameInputValue',''),this['revisionNameInputView']=this['_createRevisionNameInput'](_0x54ea97),this['setTemplate']({'tag':'form','attributes':{'class':['ck','ck-revision-history-save-revision-form','ck-responsive-form'],'tabindex':'-1'},'children':[this['revisionNameInputView']]}),ts(this);}['render'](){super['render'](),_0x3e8221({'view':this}),this['focusTracker']['add'](this['revisionNameInputView']['element']),this['keystrokes']['listenTo'](this['element']);const _0x510f34=_0x521c1=>_0x521c1['stopPropagation']();this['keystrokes']['set']('arrowright',_0x510f34),this['keystrokes']['set']('arrowleft',_0x510f34),this['keystrokes']['set']('arrowup',_0x510f34),this['keystrokes']['set']('arrowdown',_0x510f34);}['focus'](){this['revisionNameInputView']['focus']();}get['revisionName'](){return this['revisionNameInputView']['fieldView']['element']['value']['trim']();}set['revisionName'](_0x20b73c){this['revisionNameInputView']['fieldView']['element']['value']=_0x20b73c['trim']();}['reset'](){this['revisionNameInputView']['fieldView']['element']['value']='',this['revisionNameInputView']['errorText']=null;}['_createRevisionNameInput'](_0x3eddf0){const _0x54887c=new nt(this['locale'],ti),_0x56fb6d=_0x54887c['fieldView'];_0x56fb6d['extendTemplate']({'attributes':{'maxlength':'220'}});let _0x1051a3=g(this['locale'],'Name\x20of\x20the\x20revision');return!_0x3eddf0&&(_0x1051a3+='\x20('+g(this['locale'],'optional')+')'),(_0x54887c['label']=_0x1051a3,_0x56fb6d['on']('input',()=>{this['revisionNameInputValue']=_0x56fb6d['element']['value']['trim']();}),_0x54887c);}}class f extends _0x4f3c67{static get['pluginName'](){return'RevisionHistoryUI';}static get['isOfficialPlugin'](){return!0x0;}static get['isPremiumPlugin'](){return!0x0;}static get['requires'](){return[u];}['_saveRevisionFormView'];['init'](){const _0x49ec3e=this['editor'],_0x178355=_0x49ec3e['plugins']['get']('RevisionTracker');_0x49ec3e['ui']['componentFactory']['add']('revisionHistory',_0x1b9d93=>{const _0x54b7a1=_0x12ccea(_0x1b9d93),_0x49b5f2=_0x54b7a1['panelView']['children'],_0x3b4b02=new _0x32380a(_0x1b9d93),_0x2f9af5=new te(_0x1b9d93),_0x117331=new _0x5aa74d(_0x1b9d93),_0x63c477=new te(_0x1b9d93),_0x3a7403=new _0x5aa74d(_0x1b9d93);return _0x54b7a1['bind']('isEnabled')['to'](_0x178355,'isReady',_0x178355,'isEnabled',_0x49ec3e,'isReadOnly',(_0x46d519,_0x55f68f,_0x1ab78b)=>_0x46d519&&_0x55f68f&&!_0x1ab78b),_0x54b7a1['buttonView']['set']({'icon':_0x52a100,'label':g(_0x1b9d93,'Revision\x20history'),'tooltip':!0x0}),_0x117331['set']({'label':g(_0x1b9d93,'Save\x20current\x20revision'),'withText':!0x0,'role':'menuitem'}),_0x117331['bind']('isEnabled')['to'](_0x178355,'isReady',_0x178355,'isEnabled',_0x49ec3e,'isReadOnly',(_0x1b0d26,_0x11e5c8,_0x1048be)=>_0x1b0d26&&_0x11e5c8&&!_0x1048be),_0x117331['on']('execute',()=>this['_showDialog']()),_0x3a7403['set']({'label':g(_0x1b9d93,'Open\x20revision\x20history'),'withText':!0x0,'role':'menuitem'}),_0x3a7403['bind']('isEnabled')['to'](_0x178355,'isReady',_0x49ec3e,'isReadOnly',(_0x533a6e,_0x3550e6)=>_0x533a6e&&!_0x3550e6),_0x3a7403['on']('execute',()=>{_0x49ec3e['config']['get']('revisionHistory')['showRevisionViewerCallback'](),_0x54b7a1['isOpen']=!0x1,_0x49ec3e['editing']['view']['focus']();}),_0x2f9af5['children']['add'](_0x117331),_0x63c477['children']['add'](_0x3a7403),_0x3b4b02['role']='menu',_0x3b4b02['items']['addMany']([_0x2f9af5,_0x63c477]),_0x49b5f2['add'](_0x3b4b02),_0x54b7a1;}),_0x49ec3e['ui']['componentFactory']['add']('menuBar:revisionHistory',()=>this['_registerMenuComponent']());}['_registerMenuComponent'](){const _0x5e517a=this['editor'],_0x12487f=_0x5e517a['locale'],_0x5edf17=new _0xcc7d81(_0x12487f),_0x13d644=new _0x2eac1c(_0x12487f);_0x5edf17['buttonView']['set']({'icon':_0x52a100,'label':g(_0x12487f,'Revision\x20history')});const _0x342199=new _0x29f8b5(_0x12487f,_0x5edf17),_0x3814be=new _0x4e4e2a(_0x12487f);_0x3814be['set']({'label':g(_0x12487f,'Save\x20current\x20revision')}),_0x3814be['delegate']('execute')['to'](_0x5edf17),_0x3814be['on']('execute',()=>{this['_showDialog']();}),_0x342199['children']['add'](_0x3814be),_0x13d644['items']['add'](_0x342199);const _0x3fa672=new _0x29f8b5(_0x12487f,_0x5edf17),_0x410bf9=new _0x4e4e2a(_0x12487f);return _0x410bf9['set']({'label':g(_0x12487f,'Open\x20revision\x20history')}),_0x410bf9['delegate']('execute')['to'](_0x5edf17),_0x410bf9['on']('execute',()=>{_0x5e517a['config']['get']('revisionHistory')['showRevisionViewerCallback']();}),_0x3fa672['children']['add'](_0x410bf9),_0x13d644['items']['add'](_0x3fa672),_0x5edf17['panelView']['children']['add'](_0x13d644),_0x5edf17;}['_showDialog'](){const _0x27d540=this['editor'],_0x109920=_0x27d540['locale'],_0x33e4af=_0x27d540['plugins']['get']('Dialog'),_0x2e96a1=_0x27d540['plugins']['get']('RevisionTracker');function _0x4606e1(_0x555e05){_0x27d540['config']['get']('revisionHistory.requireRevisionName')&&''===_0x555e05['revisionName']?_0x555e05['revisionNameInputView']['errorText']=g(_0x109920,'The\x20revision\x20name\x20cannot\x20be\x20empty.'):(_0x27d540['plugins']['get'](u)['saveRevision']({'name':_0x555e05['revisionName']}),_0x33e4af['hide']());}this['_saveRevisionFormView']||(this['_createSaveRevisionFormView'](),this['_saveRevisionFormView']['on']('submit',()=>_0x4606e1(this['_saveRevisionFormView']))),this['_saveRevisionFormView']['reset'](),_0x33e4af['show']({'id':'revisionSave','title':g(_0x109920,'Save\x20current\x20revision'),'isModal':!0x0,'content':this['_saveRevisionFormView'],'actionButtons':[{'label':g(_0x27d540['locale'],'Cancel'),'withText':!0x0,'onExecute':()=>_0x33e4af['hide']()},{'label':g(_0x27d540['locale'],'Accept'),'class':'ck-button-action','withText':!0x0,'onCreate'(_0x341b6b){_0x341b6b['bind']('isEnabled')['to'](_0x2e96a1,'isReady',_0x2e96a1,'isEnabled',_0x27d540,'isReadOnly',(_0xf040a,_0x44cfd3,_0x30da11)=>_0xf040a&&_0x44cfd3&&!_0x30da11);},'onExecute':()=>_0x4606e1(this['_saveRevisionFormView'])}]});}['_createSaveRevisionFormView'](){const _0x689632=this['editor'],_0x3ba378=_0x689632['locale'];this['_saveRevisionFormView']=new os(_0x3ba378,_0x689632['config']['get']('revisionHistory.requireRevisionName')),this['_saveRevisionFormView']['render']();}}class Q extends _0x19ab0f{['changeId'];['_model'];constructor(_0x261d2c,_0x2f6a5a){super(_0x261d2c),this['_model']=_0x2f6a5a,this['changeId']=_0x2f6a5a['id'];const _0x2cad43=this['bindTemplate'],_0x32d710=g(_0x261d2c,_0x2f6a5a['data']['isSuggestion']?'Suggested\x20by':'add'==_0x2f6a5a['type']?'Added\x20by':'Removed\x20by');this['set']('type',_0x2f6a5a['type']),this['setTemplate']({'tag':'div','attributes':{'class':['ck-annotation','ck-revision-change',_0x2cad43['to']('type',_0x42faac=>'ck-revision-change__'+_0x42faac)],'tabindex':-0x1},'children':[{'tag':'span','children':[{'tag':'span','attributes':{'class':['ck-revision-change__label']},'children':[{'text':_0x32d710}]},{'text':'\x20'+_0x2f6a5a['author']['name']}]}]});}['focus'](){this['element']['focus']();}}class r extends/* #__PURE__ -- @preserve */
_0x429b77(){['id'];['author'];['type'];['data'];['rootName'];constructor(_0x325f07){super(),this['id']=_0x325f07['id']||_0x344b24(),this['author']=_0x325f07['author'],this['type']=_0x325f07['type'],this['data']=_0x325f07['data']||{},this['rootName']=_0x325f07['rootName'],this['set']('createdAt',_0x325f07['createdAt']);}['toJSON'](){return{'id':this['id'],'authorId':this['author']['id'],'type':this['type'],'data':this['data'],'createdAt':this['createdAt']};}}class c{['newRevisionId'];['oldRevisionId'];['changes'];constructor(_0x2251e6,_0x8072b0){this['newRevisionId']=_0x2251e6,this['oldRevisionId']=_0x8072b0,this['changes']=new _0x162b6b();}['_setChanges'](_0x2b95d5){for(const _0x343d57 of _0x2b95d5)this['changes']['add'](_0x343d57);}}class m extends _0x4f3c67{['repository'];['adapter']=null;['_utils'];['_activeViewTarget'];['_changeView'];['_changeIdToChange'];['_balloon'];static get['pluginName'](){return'RevisionViewer';}static get['isOfficialPlugin'](){return!0x0;}static get['isPremiumPlugin'](){return!0x0;}static get['requires'](){return[_0x2ecac3,_0x5afe1b,I,V];}constructor(_0x515ad7){super(_0x515ad7),this['repository']=this['editor']['plugins']['get']('RevisionsRepository'),this['_utils']=this['editor']['plugins']['get']('RevisionHistoryUtils'),this['set']('activeChange',null),this['set']('activeView',null),this['_activeViewTarget']=null,this['set']('diff',null),this['set']('isReady',!0x1),this['set']('isEnabled',!0x0),this['on']('change:isEnabled',(_0xdded9e,_0x59324a,_0x3d96b6)=>{this['activeChange']=null,this['activeView']=null,this['editor']['editing']['view']['change'](_0x30199b=>{for(const _0x43e63d of this['editor']['editing']['view']['document']['roots'])_0x3d96b6?_0x30199b['removeClass']('ck-editor__editable__overlay',_0x43e63d):_0x30199b['addClass']('ck-editor__editable__overlay',_0x43e63d);});}),this['bind']('isNavigationMode')['to'](this,'activeChange',_0x47566a=>null!==_0x47566a),this['bind']('currentChangeNumber')['to'](this,'isReady',this,'diff',this,'activeChange',(_0x1e583f,_0x4373b1,_0x5813d6)=>_0x1e583f&&_0x5813d6?_0x4373b1['changes']['getIndex'](_0x5813d6):0x0),this['bind']('numberOfChanges')['to'](this,'isReady',this,'diff',(_0x3baed2,_0x5bf885)=>_0x3baed2?_0x5bf885['changes']['length']:0x0),this['_changeView']=null,this['_changeIdToChange']=new Map(),this['_balloon']=this['editor']['plugins']['get'](_0x5afe1b);}['init'](){const _0x27a1f5=this['editor'],_0x2f6d91=new pt(_0x27a1f5,{'direction':'backward'}),_0x3ab231=new pt(_0x27a1f5,{'direction':'forward'});(_0x27a1f5['commands']['add']('showPreviousChange',_0x2f6d91),_0x27a1f5['commands']['add']('showNextChange',_0x3ab231),_0x27a1f5['commands']['add']('restoreRevision',new wt(_0x27a1f5)),this['on']('change:numberOfChanges',()=>{_0x2f6d91['refresh'](),_0x3ab231['refresh']();}),this['_setConversion'](),this['_initInteractions'](),_0x27a1f5['enableReadOnlyMode']('revision-viewer'),_0x27a1f5['plugins']['has']('WidgetToolbarRepository'))&&_0x27a1f5['plugins']['get']('WidgetToolbarRepository')['forceDisabled']('revision-viewer');}async['getRevisionDocumentData'](_0x1b2ef2){return await this['_utils']['loadRevisionData'](_0x1b2ef2,this['adapter']),this['_utils']['getRevisionDocumentData'](_0x1b2ef2);}async['getRevisionRootsAttributes'](_0x4a7bd5){return await this['_utils']['loadRevisionData'](_0x4a7bd5,this['adapter']),this['_utils']['getRevisionRootsAttributes'](_0x4a7bd5);}async['compare'](_0x5cf8ec,_0x1fa36e,_0x65870e=!0x1){if(!this['isEnabled'])return;const _0x3148c5=this['diff'],_0x569a18=this['repository'],_0x664c99='string'==typeof _0x5cf8ec?_0x569a18['getRevision'](_0x5cf8ec):_0x5cf8ec,_0x5a6ac6='string'==typeof _0x1fa36e?_0x569a18['getRevision'](_0x1fa36e):_0x1fa36e,_0xe78642=_0x664c99['id'],_0x36880d=_0x5a6ac6?_0x5a6ac6['id']:null;if(!_0x65870e&&this['diff']&&this['diff']['newRevisionId']===_0xe78642&&this['diff']['oldRevisionId']===_0x36880d)return Promise['resolve']();this['isReady']=!0x1,this['activeView']=null,this['activeChange']=null,this['diff']=new c(_0xe78642,_0x36880d);const _0x2c4273=this['_getRevisionsRange'](_0x664c99,_0x5a6ac6,!0x0)['map'](_0xf112bf=>this['_utils']['loadRevisionData'](_0xf112bf,this['adapter']));return _0x2c4273['push'](new Promise(_0x44f425=>{setTimeout(_0x44f425,0x14);})),Promise['all'](_0x2c4273)['then'](()=>{if(!this['isEnabled'])return;this['_cleanUp']();const _0xdbd903=this['_getDiff'](_0xe78642,_0x36880d);for(const _0x42f62a of _0xdbd903['changes'])this['_changeIdToChange']['set'](_0x42f62a['id'],_0x42f62a);this['editor']['model']['enqueueChange']({'isUndoable':!0x1},_0x5ace47=>{for(const _0x2fa8da of this['editor']['model']['document']['getRootNames']())_0x5ace47['detachRoot'](_0x2fa8da);for(const _0xa627fe of Object['keys'](_0xdbd903['model'])){const _0x4f989d=_0x5ace47['addRoot'](_0xa627fe);for(const _0x33586d of Object['keys'](_0xdbd903['attributes'][_0xa627fe]))_0x5ace47['setAttribute'](_0x33586d,_0xdbd903['attributes'][_0xa627fe][_0x33586d],_0x4f989d);_0x5ace47['insert'](_0xdbd903['model'][_0xa627fe],_0x4f989d,0x0);}}),this['diff']['_setChanges'](this['_sortAndFilterDiffChanges'](_0xdbd903['changes'])),this['isReady']=!0x0;})['catch'](_0xf1e1ab=>{console['error'](_0xf1e1ab),this['_cleanUp'](),_0x3148c5&&(this['diff']=_0x3148c5),this['isReady']=!0x0;});}['addRevisionData'](_0x538368,_0x40e873){const _0x5963d4=this['repository']['createRevision'](_0x538368);return _0x5963d4['on']('_update',(_0x178e9a,_0x4a3089,_0x451a16)=>_0x40e873(_0x4a3089,_0x451a16,_0x5963d4)),this['repository']['addRevision'](_0x5963d4),_0x5963d4;}['_cleanUp'](){this['activeChange']=null,this['_cleanMarkers'](),this['_changeView']&&this['_changeView']['destroy'](),this['_changeView']=null,this['_changeIdToChange']['clear'](),this['editor']['model']['enqueueChange']({'isUndoable':!0x1},_0x2f2bb4=>{for(const _0x54dd02 of this['editor']['model']['document']['getRootNames']())_0x2f2bb4['detachRoot'](_0x54dd02);});}['_sortAndFilterDiffChanges'](_0x33cd9a){const _0x4d7559=[],_0x4118bf=new Map();for(const _0x425073 of this['editor']['model']['document']['getRootNames']()){const _0x566be3=this['editor']['editing']['view']['getDomRoot'](_0x425073);if(!_0x566be3)continue;const _0x57b7ac=_0x566be3['getClientRects']()['item'](0x0);_0x57b7ac&&(_0x4d7559['push'](_0x425073),_0x4118bf['set'](_0x425073,_0x57b7ac));}return _0x4d7559['sort']((_0x1eb9bf,_0x2217d3)=>{const _0x26a685=_0x4118bf['get'](_0x1eb9bf),_0x176e7f=_0x4118bf['get'](_0x2217d3);return _0x26a685['y']-_0x176e7f['y']||_0x26a685['x']-_0x176e7f['x'];}),(_0x33cd9a=_0x33cd9a['filter'](_0x323644=>_0x4d7559['includes'](_0x323644['rootName'])))['sort']((_0x3eb05d,_0x31e3ec)=>_0x4d7559['indexOf'](_0x3eb05d['rootName'])-_0x4d7559['indexOf'](_0x31e3ec['rootName'])),_0x33cd9a;}['_makeTape'](_0x24df6d){const _0x29290e=Array['from'](_0x24df6d['markers'])['filter'](([_0x5c3940,_0xec19af])=>_0x5c3940['startsWith']('revision:')&&!_0xec19af['isCollapsed']),_0x270749=Array['from'](this['editor']['model']['createRangeIn'](_0x24df6d)['getWalker']({'singleCharacters':!0x0}));if(0x0!=_0x29290e['length'])for(const _0x1c3357 of _0x270749){const [_0x48fb57,_0x420685]=_0x29290e[0x0],[,_0x4cafe9,_0x7d98eb]=_0x48fb57['split'](':');if(_0x420685['end']['isEqual'](_0x1c3357['nextPosition'])&&_0x29290e['shift'](),(_0x1c3357['previousPosition']['isEqual'](_0x420685['start'])||_0x1c3357['previousPosition']['isAfter'](_0x420685['start']))&&('insertion'==_0x4cafe9?_0x1c3357['isAdded']={'userId':_0x7d98eb}:'deletion'==_0x4cafe9&&(_0x1c3357['isRemoved']={'userId':_0x7d98eb})),0x0==_0x29290e['length'])break;}return _0x270749;}['_refreshStartEndIndex'](_0x2bcb23){const _0x313818=new Map();for(let _0x4a8d64=0x0;_0x4a8d64<_0x2bcb23['length'];_0x4a8d64++)'text'===_0x2bcb23[_0x4a8d64]['type']?(_0x2bcb23[_0x4a8d64]['item']['startIndex']=_0x4a8d64,_0x2bcb23[_0x4a8d64]['item']['endIndex']=_0x4a8d64):('elementStart'===_0x2bcb23[_0x4a8d64]['type']?_0x2bcb23[_0x4a8d64]['item']['startIndex']=_0x4a8d64:'elementEnd'===_0x2bcb23[_0x4a8d64]['type']&&(_0x2bcb23[_0x4a8d64]['item']['endIndex']=_0x4a8d64),_0x313818['set'](_0x2bcb23[_0x4a8d64]['id'],_0x4a8d64));for(const _0x3e68a5 of _0x313818['values']())'elementStart'===_0x2bcb23[_0x3e68a5]['type']?_0x2bcb23[_0x3e68a5]['item']['endIndex']=_0x313818['get'](_0x2bcb23[_0x3e68a5]['pairId']):'elementEnd'===_0x2bcb23[_0x3e68a5]['type']&&(_0x2bcb23[_0x3e68a5]['item']['startIndex']=_0x313818['get'](_0x2bcb23[_0x3e68a5]['pairId']));}['_processTape'](_0x525635){for(let _0x35b3a8=0x0;_0x35b3a8<_0x525635['length'];_0x35b3a8++){if('elementStart'===_0x525635[_0x35b3a8]['type'])_0x525635[_0x35b3a8]['item']['startIndex']=_0x35b3a8;else{if('elementEnd'===_0x525635[_0x35b3a8]['type']){_0x525635[_0x35b3a8]['item']['endIndex']=_0x35b3a8;const _0x192f3c=_0x525635[_0x35b3a8]['item']['startIndex'];_0x525635[_0x192f3c]['pairId']=_0x525635[_0x35b3a8]['id'],_0x525635[_0x35b3a8]['pairId']=_0x525635[_0x192f3c]['id'];}else _0x525635[_0x35b3a8]['item']['startIndex']=_0x35b3a8,_0x525635[_0x35b3a8]['item']['endIndex']=_0x35b3a8,_0x525635[_0x35b3a8]['pairId']=null;}_0x525635[_0x35b3a8]['markersStart']||(_0x525635[_0x35b3a8]['markersStart']=[],_0x525635[_0x35b3a8]['markersEnd']=[]);}}['_markInsertions'](_0x1eaf46,_0x2c408f){const _0x1c8dc0=_0x1eaf46['filter'](_0x1ccb5b=>!_0x1ccb5b['isAdded']);for(let _0x579336=0x0;_0x579336<_0x2c408f['length'];_0x579336++)_0x2c408f[_0x579336]['isAdded']&&(_0x1c8dc0[_0x579336]['isAdded']=_0x2c408f[_0x579336]['isAdded']);}['_getDiff'](_0x1c7b4d,_0x2a5b47=null){const _0x10fd5c=this['repository']['getRevision'](_0x1c7b4d),_0x3f4640=_0x2a5b47?this['repository']['getRevision'](_0x2a5b47):null,_0x54fe57=this['_getRevisionsRange'](_0x10fd5c,_0x3f4640),_0x30975c=_0x54fe57[_0x54fe57['length']-0x1],_0x49ecb1=new Map(),_0x3e111f={'model':{},'attributes':{},'changes':[]},_0x2a10cc=new Set(),_0x22b5e3=new Map();for(let _0x46f44d=_0x54fe57['length']-0x1;_0x46f44d>=0x0;_0x46f44d--){const _0x33adfd=_0x54fe57[_0x46f44d];for(const _0x2a7090 of Object['keys'](_0x33adfd['diffData']))if(_0x33adfd['diffData'][_0x2a7090]['attachChange']){const _0x523b02=_0x33adfd['diffData'][_0x2a7090]['attachChange'];_0x523b02['isAttached']?(_0x2a10cc['add'](_0x2a7090),_0x22b5e3['has'](_0x2a7090)&&_0x22b5e3['get'](_0x2a7090)['userId']==_0x523b02['userId']?_0x22b5e3['delete'](_0x2a7090):_0x22b5e3['set'](_0x2a7090,_0x523b02)):_0x22b5e3['has'](_0x2a7090)?(_0x2a10cc['delete'](_0x2a7090),_0x22b5e3['delete'](_0x2a7090)):(_0x2a10cc['add'](_0x2a7090),_0x22b5e3['set'](_0x2a7090,_0x523b02));}else _0x2a10cc['add'](_0x2a7090);}for(const _0xd93fc3 of _0x2a10cc){const _0x24ee82=_0x22b5e3['has'](_0xd93fc3)&&!_0x22b5e3['get'](_0xd93fc3)['isAttached'];let _0x46ab13=_0x24ee82?_0x54fe57['length']-0x1:0x0;const _0xd9943c=_0x24ee82?-0x1:0x1;for(;_0x54fe57[_0x46ab13];){const _0x34321f=_0x54fe57[_0x46ab13];if(_0x34321f['diffData'][_0xd93fc3]){const _0x36085c=_0x24ee82?_0x34321f['diffData'][_0xd93fc3]['attributesBefore']:_0x34321f['diffData'][_0xd93fc3]['attributesAfter'];_0x3e111f['attributes'][_0xd93fc3]=_0x36085c?_0x59b0b4(_0x36085c):{};break;}_0x46ab13+=_0xd9943c;}}for(const _0x317852 of _0x54fe57){_0x317852['model']={};for(const _0x5b8b7a of _0x317852['authors'])_0x49ecb1['set'](_0x5b8b7a['id'],_0x5b8b7a);for(const _0x470221 of _0x2a10cc){const _0xfd92d4=_0x317852['diffData'][_0x470221]?_0x317852['diffData'][_0x470221]['insertions']:'[]',_0x5d4bfc=_0x317852['diffData'][_0x470221]?_0x317852['diffData'][_0x470221]['deletions']:'[]';_0x317852['model'][_0x470221]={'insertions':this['_utils']['_makeModelFromViewString'](_0xfd92d4),'deletions':this['_utils']['_makeModelFromViewString'](_0x5d4bfc)};}}for(const _0x51850b of _0x2a10cc){let _0x397d01=null,_0x1eba7e=0x0;const _0x37d5c9=new Map(Array['from'](_0x10fd5c['model'][_0x51850b]['insertions']['markers'])['filter'](([_0x2439d5])=>!_0x2439d5['startsWith']('revision:')));let _0x76ccb6=0x0;for(const _0x38bcb2 of _0x54fe57){const _0xd7c1c4=this['_makeTape'](_0x38bcb2['model'][_0x51850b]['insertions']);_0x38bcb2==_0x10fd5c?(_0x397d01=_0xd7c1c4,_0x1eba7e=_0x397d01['length'],_0x397d01['forEach'](_0x24a0df=>{_0x24a0df['id']=_0x76ccb6++;}),this['_processTape'](_0x397d01)):this['_markInsertions'](_0x397d01,_0xd7c1c4);const _0x1336a2=_0x397d01['filter'](_0x3e4ec9=>!_0x3e4ec9['isAdded'])['map'](_0xab5746=>_0xab5746['id']);let _0x4d4ba3=0x0;const _0xe33f9=this['_makeTape'](_0x38bcb2['model'][_0x51850b]['deletions']);_0xe33f9['forEach'](_0x4d6a02=>{_0x4d6a02['isRemoved']?_0x4d6a02['id']=_0x1eba7e++:_0x4d6a02['id']=_0x1336a2[_0x4d4ba3++];}),this['_processTape'](_0xe33f9),this['_setDistance'](_0x397d01,'isAdded'),this['_setDistance'](_0xe33f9,'isRemoved'),_0x38bcb2==_0x10fd5c&&this['_markMarkers'](_0x397d01,_0x37d5c9),_0x397d01=this['_joinTapes'](_0x397d01,_0xe33f9),this['_refreshStartEndIndex'](_0x397d01),this['_setDistance'](_0x397d01,'isRemoved');}_0x397d01=_0x397d01['filter'](_0x1aa22=>!(_0x1aa22['isAdded']&&_0x1aa22['isRemoved']));const _0x28fe49=new Map(_0x30975c['model'][_0x51850b]['deletions']['markers']),_0x420914=new Set(_0x37d5c9['keys']());for(const _0x50d0c6 of _0x28fe49['keys']())_0x420914['delete'](_0x50d0c6);this['_markSuggestions'](_0x397d01,_0x420914),this['_fixObsoleteTags'](_0x397d01),_0x397d01=this['_removeMissingPairs'](_0x397d01),_0x397d01=this['_markMismatchedRemovedTags'](_0x397d01),_0x397d01=this['_removeUnsupportedChanges'](_0x397d01);const {root:_0x33b7de,changes:_0x418d79}=this['_makeModelFromTape'](_0x397d01,_0x49ecb1,_0x51850b);_0x3e111f['model'][_0x51850b]=_0x33b7de;const _0x473f1c=_0x22b5e3['get'](_0x51850b);if(_0x473f1c){const _0x9634f9=_0x49ecb1['get'](_0x473f1c['userId']),_0xbb12c4=new r({'author':_0x9634f9,'type':_0x473f1c['isAttached']?'add':'remove','data':{'isOnRoot':!0x0},'createdAt':new Date(),'rootName':_0x51850b});_0x418d79['unshift'](_0xbb12c4),_0x3e111f['attributes'][_0x51850b]['revisionHistoryAttachChange']=_0xbb12c4['id'];}_0x3e111f['changes']=_0x3e111f['changes']['concat'](_0x418d79);}return _0x3e111f;}['_markMarkers'](_0xdf57fe,_0x5b0d77){for(let _0x277f97=0x0;_0x277f97<_0xdf57fe['length'];_0x277f97++)for(const [_0x38abfd,_0x1086ed]of _0x5b0d77)!_0x1086ed['isCollapsed']&&_0x1086ed['start']['isEqual'](_0xdf57fe[_0x277f97]['previousPosition'])&&_0xdf57fe[_0x277f97]['markersStart']['push'](_0x38abfd),_0x1086ed['end']['isEqual'](_0xdf57fe[_0x277f97]['nextPosition'])&&_0xdf57fe[_0x277f97]['markersEnd']['push'](_0x38abfd);}['_joinTapes'](_0x3d0c01,_0x355e58){let _0x5f3c8f=[],_0xce3ec3=0x0,_0x3cd501=0x0;for(;_0xce3ec3<_0x3d0c01['length']||_0x3cd501<_0x355e58['length'];){const _0x4b6c2c=_0x3d0c01[_0xce3ec3]||{},_0x5e88a8=_0x355e58[_0x3cd501]||{};if(_0x4b6c2c['id']==_0x5e88a8['id'])_0xce3ec3++,_0x3cd501++,_0x5f3c8f['push'](_0x4b6c2c);else{if(_0x5e88a8['isRemoved']&&_0x4b6c2c['isAdded']){const {commonTape:_0x4a0436,iEnd:_0x26fd98,jEnd:_0x16acb3}=this['_threeWayMerge'](_0x3d0c01,_0xce3ec3,_0x355e58,_0x3cd501);_0x5f3c8f=_0x5f3c8f['concat'](_0x4a0436),_0xce3ec3=_0x26fd98,_0x3cd501=_0x16acb3;}else _0x5e88a8['isRemoved']?(_0x3cd501++,_0x5f3c8f['push'](_0x5e88a8)):(_0xce3ec3++,_0x5f3c8f['push'](_0x4b6c2c));}}return _0x5f3c8f;}['_markSuggestions'](_0x304485,_0x451c56){const _0x38ef8b=[];for(let _0x2a7307=0x0;_0x2a7307<_0x304485['length'];_0x2a7307++){for(let _0x29d5b8=0x0;_0x29d5b8<_0x304485[_0x2a7307]['markersStart']['length'];_0x29d5b8++){const _0x294b1=_0x304485[_0x2a7307]['markersStart'][_0x29d5b8];if(!_0x451c56['has'](_0x294b1))continue;const {group:_0x554216,type:_0x1cc947,authorId:_0x31f8ed}=_0x5bf4bd(_0x294b1);'revision-suggestion'!=_0x554216||'insertion'!=_0x1cc947&&'deletion'!=_0x1cc947||(_0x38ef8b['unshift']({'type':_0x1cc947,'name':_0x294b1,'userId':_0x31f8ed}),_0x304485[_0x2a7307]['markersStart']['splice'](_0x29d5b8,0x1),_0x29d5b8--);}_0x485c01(_0x304485[_0x2a7307]);for(let _0x751e9=0x0;_0x751e9<_0x304485[_0x2a7307]['markersEnd']['length'];_0x751e9++){const _0x4b9cb4=_0x304485[_0x2a7307]['markersEnd'][_0x751e9];if(!_0x451c56['has'](_0x4b9cb4))continue;const {group:_0x503494,type:_0x66c8c5}=_0x5bf4bd(_0x4b9cb4);if('revision-suggestion'!=_0x503494||'insertion'!=_0x66c8c5&&'deletion'!=_0x66c8c5)continue;_0x304485[_0x2a7307]['markersEnd']['splice'](_0x751e9,0x1),_0x751e9--;const _0x3a759f=_0x38ef8b['findIndex'](_0x50a9f2=>_0x50a9f2['name']==_0x4b9cb4);_0x3a759f>-0x1&&_0x38ef8b['splice'](_0x3a759f,0x1);}}function _0x5bf4bd(_0x242d0a){const _0x416d27=_0x242d0a['split'](':');return{'group':_0x416d27[0x0],'type':_0x416d27[0x1],'subType':_0x416d27['length']>=0x5?_0x416d27[0x2]:null,'id':_0x416d27['length']<0x5?_0x416d27[0x2]:_0x416d27[0x3],'authorId':_0x416d27['length']<0x5?_0x416d27[0x3]:_0x416d27[0x4],'markerCount':0x6==_0x416d27['length']?_0x416d27[0x5]:null};}function _0x485c01(_0x3185a1){for(let _0x2b23ff=0x0;_0x2b23ff<_0x38ef8b['length'];_0x2b23ff++){if(_0x3185a1['isAdded']&&'insertion'==_0x38ef8b[_0x2b23ff]['type']&&_0x3185a1['isAdded']['userId']==_0x38ef8b[_0x2b23ff]['userId'])return _0x3185a1['isAddSuggestion']=_0x38ef8b[_0x2b23ff],void delete _0x3185a1['isAdded'];if(!_0x3185a1['isAdded']&&!_0x3185a1['isRemoved']&&'deletion'==_0x38ef8b[_0x2b23ff]['type'])return void(_0x3185a1['isRemoveSuggestion']=_0x38ef8b[_0x2b23ff]);}}}['_setDistance'](_0x11ee0c,_0xa29380){let _0x2ecee1=0x0,_0x444515=!0x1;const _0x45e87e=new Map();for(const _0x10765a of _0x11ee0c)_0x10765a[_0xa29380]?_0x444515&&(_0x2ecee1++,_0x444515=!0x1):(_0x2ecee1++,_0x444515=!0x0),_0x45e87e['set'](_0x10765a['id'],_0x2ecee1);for(let _0x1c161f=0x0;_0x1c161f<_0x11ee0c['length'];_0x1c161f++){if('isRemoved'==_0xa29380&&_0x11ee0c[_0x1c161f]['isAdded']||'isAdded'==_0xa29380&&_0x11ee0c[_0x1c161f]['isRemoved'])continue;if('text'==_0x11ee0c[_0x1c161f]['type']){_0x11ee0c[_0x1c161f]['distance']=0x0;continue;}const _0x4f651e=_0x45e87e['get'](_0x11ee0c[_0x1c161f]['pairId']),_0x5b795c=_0x45e87e['get'](_0x11ee0c[_0x1c161f]['id']);_0x11ee0c[_0x1c161f]['distance']=_0x4f651e-_0x5b795c;}}['_getRevisionsRange'](_0x3344b1,_0x26961a,_0x4507fd=!0x1){const _0x5ae4b7=[];let _0x30d19c=this['repository']['getIndex'](_0x3344b1),_0x1aef30=this['repository']['getIndex'](_0x26961a);for(-0x1==_0x1aef30&&(_0x1aef30=this['repository']['_revisions']['length'],_0x4507fd=!0x1);_0x30d19c<_0x1aef30;)_0x5ae4b7['push'](this['repository']['getRevision'](_0x30d19c)),_0x30d19c++;return _0x4507fd&&_0x5ae4b7['push'](this['repository']['getRevision'](_0x30d19c)),_0x5ae4b7;}['_threeWayMerge'](_0x51347b,_0x2781eb,_0x461b2a,_0x487b42){const _0x3075be=this['editor']['model']['schema'];let _0x5e51e0=_0x2781eb;for(;_0x51347b[_0x5e51e0]&&_0x51347b[_0x5e51e0]['isAdded'];)_0x5e51e0++;let _0x47e9a1=_0x487b42;for(;_0x461b2a[_0x47e9a1]&&_0x461b2a[_0x47e9a1]['isRemoved'];)_0x47e9a1++;_0x421f3e(_0x51347b,_0x2781eb,_0x5e51e0),_0x421f3e(_0x461b2a,_0x487b42,_0x47e9a1);const _0xc45156=_0x461b2a['slice'](_0x487b42,_0x47e9a1)['concat'](_0x51347b['slice'](_0x2781eb,_0x5e51e0));return _0xc45156['sort']((_0x4ec09e,_0x11398e)=>_0x4ec09e['side']!=_0x11398e['side']?_0x4ec09e['side']-_0x11398e['side']:_0x4ec09e['level']!=_0x11398e['level']?_0x4ec09e['level']-_0x11398e['level']:_0x4ec09e['distance']!=_0x11398e['distance']?_0x11398e['distance']-_0x4ec09e['distance']:!!_0x4ec09e['isAdded']!=!!_0x11398e['isAdded']?-0x1==_0x4ec09e['side']||0x0==_0x4ec09e['side']?_0x4ec09e['isAdded']?-0x1:0x1:_0x4ec09e['isAdded']?0x1:-0x1:_0x4ec09e['index']-_0x11398e['index']),{'commonTape':_0xc45156,'iEnd':_0x5e51e0,'jEnd':_0x47e9a1};function _0x421f3e(_0x10cda3,_0x3c7946,_0x9dcf03){let _0x45e383=-0x1,_0x303147=Number['POSITIVE_INFINITY'],_0xbd6f1e=!0x0;for(let _0x16f01e=_0x3c7946;_0x16f01e<_0x9dcf03;_0x16f01e++)if(_0x3075be['isInline'](_0x10cda3[_0x16f01e]['item'])||(_0xbd6f1e=!0x1),_0x10cda3[_0x16f01e]['item']['startIndex']<_0x3c7946&&(_0x45e383=_0x16f01e),_0x10cda3[_0x16f01e]['item']['endIndex']>=_0x9dcf03){_0x303147=_0x16f01e;break;}_0xbd6f1e&&(_0x45e383=_0x9dcf03-0x1);for(let _0x54b8a6=_0x3c7946;_0x54b8a6<_0x9dcf03;_0x54b8a6++)_0x10cda3[_0x54b8a6]['side']=_0x54b8a6<=_0x45e383?-0x1:_0x54b8a6<_0x303147?0x0:0x1,_0x10cda3[_0x54b8a6]['index']=_0x54b8a6;let _0x18285a=0x0;for(let _0x55eaff=_0x3c7946;_0x55eaff<=_0x45e383;_0x55eaff++)0x0==_0x10cda3[_0x55eaff]['distance']?_0x10cda3[_0x55eaff]['level']=_0x18285a:(_0x18285a++,_0x10cda3[_0x55eaff]['level']=_0x18285a,_0x18285a++);for(let _0x2ce355=_0x3c7946;_0x2ce355<_0x9dcf03;_0x2ce355++)0x0==_0x10cda3[_0x2ce355]['side']&&(_0x10cda3[_0x2ce355]['level']=_0x18285a);_0x18285a=0x0;for(let _0x4fe781=_0x9dcf03-0x1;_0x4fe781>=_0x303147;_0x4fe781--)0x0==_0x10cda3[_0x4fe781]['distance']?_0x10cda3[_0x4fe781]['level']=_0x18285a:(_0x18285a--,_0x10cda3[_0x4fe781]['level']=_0x18285a,_0x18285a--);}}['_fixObsoleteTags'](_0x3b7196){const _0x159561=new Map(),_0x595d07=this['editor']['model']['schema'];for(let _0x229816=0x1;_0x229816<_0x3b7196['length'];_0x229816++){let _0x362fc9,_0x3c4104,_0x4beae5;const _0x231e8a=_0x3b7196[_0x229816],_0x297308=_0x3b7196[_0x229816-0x1];if('text'==_0x231e8a['type'])continue;if(_0x231e8a['type']!=_0x297308['type'])continue;if(!_0x595d07['isBlock'](_0x297308['item'])||_0x595d07['isLimit'](_0x297308['item']))continue;if(!_0x595d07['isBlock'](_0x231e8a['item'])||_0x595d07['isLimit'](_0x231e8a['item']))continue;if((_0x3b7196[_0x229816]['isAdded']||_0x3b7196[_0x229816]['isAddSuggestion'])&&_0x3b7196[_0x229816-0x1]['isRemoved'])_0x362fc9=_0x3b7196[_0x229816],_0x3c4104=_0x3b7196[_0x229816-0x1],_0x4beae5=_0x229816-0x1;else{if(!_0x3b7196[_0x229816]['isRemoved']||!_0x3b7196[_0x229816-0x1]['isAdded']&&!_0x3b7196[_0x229816-0x1]['isAddSuggestion'])continue;_0x362fc9=_0x3b7196[_0x229816-0x1],_0x3c4104=_0x3b7196[_0x229816],_0x4beae5=_0x229816;}const _0x4563e4=_0x362fc9['level']==_0x3c4104['level'],_0x1026db=Math['abs'](_0x362fc9['level'])<Math['abs'](_0x3c4104['level'])&&0x0==_0x3c4104['distance'];(_0x4563e4||_0x1026db)&&(_0x159561['set'](_0x3c4104['id'],_0x362fc9['id']),_0x3b7196['splice'](_0x4beae5,0x1),_0x229816--,_0x362fc9['isAdded']=!0x1);}for(let _0x671b2c=0x0;_0x671b2c<_0x3b7196['length'];_0x671b2c++)_0x159561['has'](_0x3b7196[_0x671b2c]['pairId'])&&(_0x3b7196[_0x671b2c]['pairId']=_0x159561['get'](_0x3b7196[_0x671b2c]['pairId']));}['_removeMissingPairs'](_0x465db8){const _0x1d7fb0=new Set(_0x465db8['map'](_0x3fa06e=>_0x3fa06e['id']));for(let _0xd03997=0x0;_0xd03997<_0x465db8['length'];_0xd03997++)_0x1d7fb0['has'](_0x465db8[_0xd03997]['pairId'])||0x0==_0x465db8[_0xd03997]['distance']||(_0x465db8[_0xd03997]['isIncorrect']=!0x0);return _0x465db8['filter'](_0x7896f=>!_0x7896f['isIncorrect']);}['_markMismatchedRemovedTags'](_0x164457){const _0x3e1a21=new Set();for(let _0x3414f6=0x0;_0x3414f6<_0x164457['length'];_0x3414f6++){if(_0x3e1a21['has'](_0x164457[_0x3414f6]['id'])&&_0x164457[_0x3414f6]['isRemoved']&&(_0x164457[_0x3414f6]['isIncorrect']=!0x0),_0x164457[_0x3414f6]['isIncorrect'])continue;if(0x0==_0x164457[_0x3414f6]['distance'])continue;if('elementStart'!=_0x164457[_0x3414f6]['type'])continue;if(null==_0x164457[_0x3414f6]['pairId'])continue;let _0x228fc2=_0x3414f6+0x1,_0xaa5258=0x0;for(;_0x164457[_0x228fc2]['id']!=_0x164457[_0x3414f6]['pairId'];)'elementStart'==_0x164457[_0x228fc2]['type']?_0xaa5258++:'elementEnd'==_0x164457[_0x228fc2]['type']&&_0xaa5258--,_0x228fc2++;if(0x0!=_0xaa5258){if(_0x164457[_0x3414f6]['isRemoved'])_0x164457[_0x3414f6]['isIncorrect']=!0x0;else{for(;_0x228fc2!=_0x3414f6;)_0x164457[_0x228fc2]['isRemoved']&&0x0!=_0x164457[_0x228fc2]['distance']&&(_0x164457[_0x228fc2]['isIncorrect']=!0x0,_0x3e1a21['add'](_0x164457[_0x228fc2]['pairId'])),_0x228fc2--;}}}return _0x164457['filter'](_0x369a20=>!_0x369a20['isIncorrect']);}['_removeUnsupportedChanges'](_0x489f08){const _0x123912=this['editor']['model']['schema'];for(let _0x336b52=0x0;_0x336b52<_0x489f08['length'];_0x336b52++){if(!(_0x489f08[_0x336b52]['isAdded']||_0x489f08[_0x336b52]['isAddSuggestion']||_0x489f08[_0x336b52]['isRemoved']||_0x489f08[_0x336b52]['isRemoveSuggestion']))continue;if(0x0==_0x489f08[_0x336b52]['distance'])continue;const _0x4b0f29=_0x489f08[_0x336b52]['item'];_0x123912['isBlock'](_0x4b0f29)||_0x123912['isLimit'](_0x4b0f29)||(_0x489f08[_0x336b52]['isAdded']&&delete _0x489f08[_0x336b52]['isAdded'],_0x489f08[_0x336b52]['isAddSuggestion']&&delete _0x489f08[_0x336b52]['isAddSuggestion'],_0x489f08[_0x336b52]['isRemoveSuggestion']&&delete _0x489f08[_0x336b52]['isRemoveSuggestion'],_0x489f08[_0x336b52]['isRemoved']&&(_0x489f08[_0x336b52]['isIncorrect']=!0x0));}return _0x489f08['filter'](_0xeb2cd7=>!_0xeb2cd7['isIncorrect']);}['_makeModelFromTape'](_0x140d2a,_0x5317c3,_0x5e1fc9){const _0x248d6f=new gt(),_0x2ca0a3=[],_0x5e7b47=new Map(),_0xa6385e=this['editor']['model'],_0x451185=_0xa6385e['schema'],_0xfffb70=[_0x248d6f],_0x1af14b={},_0x70cdb={'isAdded':[],'isRemoved':[],'isAddSuggestion':[],'isRemoveSuggestion':[]};let _0x23b1b1=null;const _0x63b648=[0x0];for(let _0x20d81f=0x0;_0x20d81f<_0x140d2a['length'];_0x20d81f++)if('elementStart'===_0x140d2a[_0x20d81f]['type']){_0x140d2a[_0x20d81f]['previousPosition']=_0xa6385e['createPositionFromPath'](_0x248d6f,_0x63b648);const _0x52558f=new ut(_0x140d2a[_0x20d81f]['item']['name'],_0x140d2a[_0x20d81f]['item']['getAttributes']());_0xfffb70[0x0]['_appendChild'](_0x52558f),_0x63b648['push'](0x0),_0xfffb70['unshift'](_0x52558f),_0x140d2a[_0x20d81f]['nextPosition']=_0xa6385e['createPositionFromPath'](_0x248d6f,_0x63b648);}else'elementEnd'===_0x140d2a[_0x20d81f]['type']?(_0xfffb70['shift'](),_0x140d2a[_0x20d81f]['previousPosition']=_0xa6385e['createPositionFromPath'](_0x248d6f,_0x63b648),_0x63b648['pop'](),_0x63b648[_0x63b648['length']-0x1]++,_0x140d2a[_0x20d81f]['nextPosition']=_0xa6385e['createPositionFromPath'](_0x248d6f,_0x63b648)):(_0x140d2a[_0x20d81f]['previousPosition']=_0xa6385e['createPositionFromPath'](_0x248d6f,_0x63b648),_0x23b1b1?_0x23b1b1['_data']+=_0x140d2a[_0x20d81f]['item']['data']:_0x23b1b1=new mt(_0x140d2a[_0x20d81f]['item']['data'],_0x140d2a[_0x20d81f]['item']['getAttributes']()),_0x140d2a[_0x20d81f+0x1]&&'text'===_0x140d2a[_0x20d81f+0x1]['type']&&_0x83134(_0x23b1b1,_0x140d2a[_0x20d81f+0x1]['item'])||(_0xfffb70[0x0]['_appendChild'](_0x23b1b1),_0x23b1b1=null),_0x63b648[_0x63b648['length']-0x1]+=_0x140d2a[_0x20d81f]['item']['offsetSize'],_0x140d2a[_0x20d81f]['nextPosition']=_0xa6385e['createPositionFromPath'](_0x248d6f,_0x63b648));for(let _0xfbeb06=0x0;_0xfbeb06<_0x140d2a['length'];_0xfbeb06++){const _0x11ece0=_0x140d2a[_0xfbeb06]['previousPosition'],_0x4d44d4=_0x140d2a[_0xfbeb06]['nextPosition'];for(const _0x10163c of _0x140d2a[_0xfbeb06]['markersStart'])_0x5e7b47['set'](_0x10163c,{'start':_0x11ece0,'end':null});_0x9ada07('isRemoveSuggestion',_0xfbeb06,_0x11ece0,_0x4d44d4),_0x9ada07('isAddSuggestion',_0xfbeb06,_0x11ece0,_0x4d44d4),_0x9ada07('isRemoved',_0xfbeb06,_0x11ece0,_0x4d44d4),_0x9ada07('isAdded',_0xfbeb06,_0x11ece0,_0x4d44d4);for(const _0x35ef0f of _0x140d2a[_0xfbeb06]['markersEnd']){const _0x22a8d0=_0x5e7b47['get'](_0x35ef0f);_0x22a8d0?_0x22a8d0['end']=_0x4d44d4:_0x5e7b47['set'](_0x35ef0f,{'start':_0x4d44d4,'end':_0x4d44d4});}}for(const [_0x1512f6,_0x5ba34a]of _0x5e7b47){const _0x16b385=this['editor']['model']['createRange'](_0x5ba34a['start'],_0x5ba34a['end']);_0x248d6f['markers']['set'](_0x1512f6,_0x16b385);}return _0x2ca0a3['sort']((_0x455d86,_0x27a9ef)=>{const _0x121c72=_0x248d6f['markers']['get']('revision:'+_0x455d86['id']),_0x126524=_0x248d6f['markers']['get']('revision:'+_0x27a9ef['id']);return _0x121c72['start']['isBefore'](_0x126524['start'])?-0x1:_0x121c72['start']['isAfter'](_0x126524['start'])?0x1:_0x121c72['end']['isBefore'](_0x126524['end'])?-0x1:_0x121c72['end']['isAfter'](_0x126524['end'])?0x1:'add'===_0x455d86['type']?-0x1:0x1;}),{'root':_0x248d6f,'changes':_0x2ca0a3};function _0x9ada07(_0xbb4de7,_0x5306cd,_0x2140ec,_0x427be5){const _0x2429d4=!!_0x140d2a[_0x5306cd][_0xbb4de7],_0x5d590a=_0x2429d4?_0x140d2a[_0x5306cd][_0xbb4de7]['userId']:null,_0x4a9ad1=_0x5306cd===_0x140d2a['length']-0x1,_0x109d77=_0x70cdb[_0xbb4de7][0x0],_0x188d10=_0x451185['isObject'](_0x140d2a[_0x5306cd]['item']);!_0x1af14b[_0xbb4de7]&&_0x2429d4?_0x1af14b[_0xbb4de7]={'start':_0x2140ec,'tapeItem':_0x140d2a[_0x5306cd],'userId':_0x5d590a,'type':_0xbb4de7}:_0x1af14b[_0xbb4de7]&&!_0x2429d4?(_0x1af14b[_0xbb4de7]['end']=_0x2140ec,_0x8a74f1(_0x1af14b[_0xbb4de7]),_0x1af14b[_0xbb4de7]=null):_0x1af14b[_0xbb4de7]&&_0x2429d4&&_0x1af14b[_0xbb4de7]['userId']!==_0x5d590a&&(_0x1af14b[_0xbb4de7]['end']=_0x2140ec,_0x109d77&&_0x109d77['userId']===_0x1af14b[_0xbb4de7]['userId']||_0x8a74f1(_0x1af14b[_0xbb4de7]),_0x1af14b[_0xbb4de7]={'start':_0x2140ec,'tapeItem':_0x140d2a[_0x5306cd],'userId':_0x5d590a,'type':_0xbb4de7}),_0x1af14b[_0xbb4de7]&&_0x188d10&&('elementStart'!==_0x140d2a[_0x5306cd]['type']||_0x109d77&&_0x109d77['userId']===_0x5d590a||_0x70cdb[_0xbb4de7]['unshift']({'userId':_0x5d590a,'object':_0x140d2a[_0x5306cd]['item'],'change':_0x1af14b[_0xbb4de7]}),'elementEnd'===_0x140d2a[_0x5306cd]['type']&&_0x109d77&&_0x109d77['object']===_0x140d2a[_0x5306cd]['item']&&(_0x70cdb[_0xbb4de7]['shift'](),_0x1af14b[_0xbb4de7]=_0x109d77['change'])),_0x1af14b[_0xbb4de7]&&_0x4a9ad1&&(_0x1af14b[_0xbb4de7]['end']=_0x427be5,_0x8a74f1(_0x1af14b[_0xbb4de7]),_0x1af14b[_0xbb4de7]=null);}function _0x8a74f1({start:_0x639e0a,end:_0x18d0fd,tapeItem:_0x2c2a2f,userId:_0x5997ab,type:_0x44c232}){const _0x2e645b=_0x2c2a2f['item'],_0x27afdf=_0xa6385e['schema']['isBlock'](_0x2e645b)&&!_0xa6385e['schema']['isLimit'](_0x2e645b),_0x1580a8=_0x639e0a['nodeAfter']==_0x18d0fd['parent']&&_0x18d0fd['isAtStart'];if(_0x27afdf&&_0x1580a8)return;const _0x3150ef=_0xa6385e['createRange'](_0x639e0a,_0x18d0fd),_0x159eb2=_0x5317c3['get'](_0x5997ab),_0x39774a=new r({'author':_0x159eb2,'type':'isAdded'==_0x44c232||'isAddSuggestion'==_0x44c232?'add':'remove','data':{'isSuggestion':'isAddSuggestion'==_0x44c232||'isRemoveSuggestion'==_0x44c232},'createdAt':new Date(),'rootName':_0x5e1fc9});_0x2ca0a3['push'](_0x39774a),_0x248d6f['markers']['set']('revision:'+_0x39774a['id'],_0x3150ef);}function _0x83134(_0x6abd08,_0x38a2cc){const _0x4c6119=_0x6abd08['getAttributes'](),_0x4c0266=_0x38a2cc['getAttributes']();for(const _0x45d04c of _0x4c6119){if(_0x45d04c[0x1]!==_0x38a2cc['getAttribute'](_0x45d04c[0x0]))return!0x1;_0x4c0266['next']();}return _0x4c0266['next']()['done'];}}['_setConversion'](){this['editor']['conversion']['for']('upcast')['dataToMarker']({'view':'revision'}),this['editor']['conversion']['for']('editingDowncast')['markerToHighlight']({'model':'revision','view':_0x509b17=>{const _0x5737ff=_0x509b17['markerName']['split'](':')[0x1],_0x588605=this['_getChangeFromId'](_0x5737ff);if(!_0x588605)return null;const _0x1bd6cf='add'==_0x588605['type']?'insertion':'deletion',_0x4b4235=['ck-suggestion-marker','ck-suggestion-marker-'+_0x1bd6cf];return _0x588605['data']['isSuggestion']&&_0x4b4235['push']('ck-suggestion-marker-'+_0x1bd6cf+'-new'),this['activeChange']==_0x588605&&_0x4b4235['push']('ck-suggestion-marker--active'),{'classes':_0x4b4235,'attributes':{'data-change-id':_0x5737ff}};}}),this['editor']['conversion']['for']('upcast')['add'](_0x4fefb2=>{_0x4fefb2['on']('element:pre',(_0x400c18,_0xbd6120,_0x3458b0)=>{const _0x555294=_0xbd6120['viewItem']['getChild'](0x0);if(!_0x555294||!_0x555294['is']('element','code'))return;if(!_0x3458b0['consumable']['consume'](_0x555294,{'attributes':['vid_start','vid_end']}))return;const _0x510481=_0xbd6120['modelRange']['start']['nodeAfter'];_0x3458b0['writer']['setAttribute']('vid_start',_0x555294['getAttribute']('vid_start'),_0x510481),_0x3458b0['writer']['setAttribute']('vid_end',_0x555294['getAttribute']('vid_end'),_0x510481);},{'priority':'low'});}),this['editor']['conversion']['for']('upcast')['add'](_0x2c9aa2=>{_0x2c9aa2['on']('element',(_0x147cc2,_0x4ec899,_0x3e1334)=>{if(!_0x3e1334['consumable']['consume'](_0x4ec899['viewItem'],{'attributes':['vid_start','vid_end']}))return;if(_0x4ec899['modelRange']['isCollapsed'])return;const _0x1d21f8=_0x4ec899['modelRange']['start']['nodeAfter'];_0x1d21f8['hasAttribute']('vid_start')||_0x1d21f8['hasAttribute']('vid')||(_0x3e1334['writer']['setAttribute']('vid_start',_0x4ec899['viewItem']['getAttribute']('vid_start'),_0x1d21f8),_0x3e1334['writer']['setAttribute']('vid_end',_0x4ec899['viewItem']['getAttribute']('vid_end'),_0x1d21f8));},{'priority':'low'});}),this['editor']['conversion']['for']('upcast')['elementToAttribute']({'view':{'name':'span','attributes':{'vid':!0x0}},'model':{'key':'vid','value':_0x135e34=>_0x135e34['getAttribute']('vid')}}),this['editor']['model']['schema']['on']('checkAttribute',(_0x1400e4,[,_0x3343b0])=>{['vid_start','vid_end','vid']['includes'](_0x3343b0)&&(_0x1400e4['return']=!0x0,_0x1400e4['stop']());},{'priority':'highest'}),this['editor']['conversion']['for']('dataDowncast')['add'](_0x5f0e8c=>{_0x5f0e8c['on']('attribute:vid',(_0x1ede2d,_0x59e735,_0x415c04)=>{if('\x20'!=_0x59e735['item']['data']||_0x59e735['item']['parent']['maxOffset']>0x1)return;if(!_0x415c04['consumable']['consume'](_0x59e735['item'],_0x1ede2d['name']))return;const _0x51d667=_0x415c04['writer'],_0x18e131=_0x415c04['mapper']['toViewRange'](_0x59e735['range']);_0x51d667['wrap'](_0x18e131,_0x51d667['createAttributeElement']('span'));});}),this['editor']['conversion']['for']('dataDowncast')['markerToData']({'model':'revision'}),this['editor']['editing']['downcastDispatcher']['on']('addMarker:revision',function(_0x3411ab){const _0xf9a2ba=_0x3411ab['plugins']['get']('RevisionViewer');return(_0x1f826e,_0x104fcf,_0x35bf99)=>{const _0xc2be2c=_0x104fcf['markerName']['split'](':')[0x1],_0x25039d=_0xf9a2ba['_getChangeFromId'](_0xc2be2c);if(!_0x25039d)return null;const _0x75a29e='add'==_0x25039d['type']?'split':'merge';if(!_0x35bf99['consumable']['test'](_0x104fcf['markerRange'],_0x1f826e['name']))return;const _0x97567b=_0x104fcf['markerRange']['getWalker'](),_0x341363=_0x104fcf['markerRange']['start'],_0x543358=_0x3411ab['model']['schema'];let _0x270582=null,_0x55d323=null,_0x34af50=!0x1,_0x5771ca=!0x1;for(const _0x2dc5d8 of _0x97567b){const _0x47a091=_0x2dc5d8['item'];_0x34af50=_0x34af50||_0x543358['isContent'](_0x47a091);const _0x2b67de=_0x35bf99['mapper']['toViewElement'](_0x47a091);if(_0x2b67de&&_0x2b67de['getCustomProperty']('addHighlight'))return;'elementEnd'==_0x2dc5d8['type']&&(_0x543358['isBlock'](_0x47a091)&&!_0x543358['isLimit'](_0x47a091)&&(_0x47a091['nextSibling']||_0x341363['isAtEnd']?_0x270582&&_0x270582['parent']==_0x47a091||(_0x270582=_0x47a091,_0x155dda(_0x2dc5d8['previousPosition']),_0x5771ca=!0x0):_0x55d323=_0x55d323||_0x2dc5d8['previousPosition']));}function _0x155dda(_0x485b7f){const _0x17362d=_0x35bf99['writer']['createUIElement']('span',{'class':'ck-suggestion-marker-'+_0x75a29e}),_0x12db14=_0x35bf99['mapper']['toViewPosition'](_0x485b7f);_0x25039d['data']['isSuggestion']&&_0x35bf99['writer']['addClass']('ck-suggestion-marker-'+_0x75a29e+'-new',_0x17362d),_0xf9a2ba['activeChange']==_0x25039d&&_0x35bf99['writer']['addClass']('ck-suggestion-marker--active',_0x17362d),_0x35bf99['writer']['insert'](_0x12db14,_0x17362d),_0x35bf99['mapper']['bindElementToMarker'](_0x17362d,_0x104fcf['markerName']);}_0x34af50||_0x5771ca||!_0x55d323||_0x155dda(_0x55d323);};}(this['editor']),{'priority':'high'}),this['editor']['editing']['downcastDispatcher']['on']('removeMarker:revision',(_0x188d04,_0x52a5fa,_0x57192d)=>{const _0x5d077f=_0x57192d['mapper']['markerNameToElements'](_0x52a5fa['markerName']);if(_0x5d077f){for(const _0x34f12d of _0x5d077f)(_0x34f12d['hasClass']('ck-suggestion-marker-split')||_0x34f12d['hasClass']('ck-suggestion-marker-merge'))&&(_0x57192d['mapper']['unbindElementFromMarkerName'](_0x34f12d,_0x52a5fa['markerName']),_0x57192d['writer']['remove'](_0x34f12d));}},{'priority':'high'}),this['editor']['editing']['downcastDispatcher']['on']('addMarker:revision',(_0x32352d,_0x46f19f,_0x5e3a96)=>{const _0x5fb24f=_0x46f19f['markerName']['split'](':')[0x1],_0x1669a8=this['_getChangeFromId'](_0x5fb24f);if(!_0x1669a8)return null;const _0xeece1e='add'==_0x1669a8['type']?'split':'merge';if(_0x5e3a96['consumable']['test'](_0x46f19f['markerRange'],_0x32352d['name']))for(const _0x40a982 of _0x46f19f['markerRange']['getItems']()){if(!_0x40a982['is']('element','softBreak'))continue;const _0x412050=_0x5e3a96['writer']['createUIElement']('span',{'class':'ck-suggestion-marker-'+_0xeece1e}),_0x3fe1fd=_0x5e3a96['mapper']['toViewPosition'](this['editor']['model']['createPositionBefore'](_0x40a982));_0x1669a8['data']['isSuggestion']&&_0x5e3a96['writer']['addClass']('ck-suggestion-marker-'+_0xeece1e+'-new',_0x412050),this['activeChange']==_0x1669a8&&_0x5e3a96['writer']['addClass']('ck-suggestion-marker--active',_0x412050),_0x5e3a96['writer']['insert'](_0x3fe1fd,_0x412050),_0x5e3a96['mapper']['bindElementToMarker'](_0x412050,_0x46f19f['markerName']);}},{'priority':'high'}),this['editor']['model']['document']['on']('change',()=>{this['editor']['editing']['view']['change'](_0x3123af=>{for(const _0x1fb343 of this['editor']['model']['document']['getRootNames']()){const _0x18417e=this['editor']['model']['document']['getRoot'](_0x1fb343),_0x35766c=this['editor']['editing']['view']['document']['getRoot'](_0x1fb343);if(_0x35766c){const _0x53014c=_0x18417e['getAttribute']('revisionHistoryAttachChange');if(_0x3123af['removeAttribute']('data-change-id',_0x35766c),_0x3123af['removeClass']('ck-revision-history-root-add',_0x35766c),_0x3123af['removeClass']('ck-revision-history-root-remove',_0x35766c),_0x3123af['removeClass']('ck-revision-history-root--active',_0x35766c),_0x53014c){const _0x19ba72=this['_getChangeFromId'](_0x53014c);if(!_0x19ba72)return null;_0x3123af['setAttribute']('data-change-id',_0x53014c,_0x35766c),_0x3123af['addClass']('ck-revision-history-root-'+_0x19ba72['type'],_0x35766c),this['activeChange']==_0x19ba72&&_0x3123af['addClass']('ck-revision-history-root--active',_0x35766c);}}}});}),this['editor']['conversion']['for']('upcast')['dataToMarker']({'view':'comment','model':_0xa674ae=>'revision-comment:'+_0xa674ae,'converterPriority':'highest'}),this['editor']['conversion']['for']('upcast')['dataToMarker']({'view':'suggestion','model':_0x54c110=>'revision-suggestion:'+_0x54c110,'converterPriority':'highest'}),this['editor']['conversion']['for']('dataDowncast')['markerToData']({'model':'revision-suggestion','view':_0x505b96=>({'name':'suggestion:'+_0x505b96,'group':'revision-suggestion'}),'converterPriority':'highest'}),this['editor']['conversion']['for']('editingDowncast')['markerToHighlight']({'model':'revision-suggestion','view':_0x452b7a=>{const _0x2d3d94=_0x452b7a['markerName']['split'](':')[0x1];return'insertion'!=_0x2d3d94&&'deletion'!=_0x2d3d94?null:{'classes':['ck-suggestion-preview-marker','ck-suggestion-preview-marker-'+_0x2d3d94]};}}),this['editor']['editing']['downcastDispatcher']['on']('addMarker:revision-suggestion:deletion',X(this['editor'],'merge'),{'priority':'high'}),this['editor']['editing']['downcastDispatcher']['on']('addMarker:revision-suggestion:insertion',X(this['editor'],'split'),{'priority':'high'}),this['editor']['editing']['downcastDispatcher']['on']('removeMarker:revision-suggestion',(_0x598f39,_0x45fd7b,_0x10e7b1)=>{const _0x215212=_0x10e7b1['mapper']['markerNameToElements'](_0x45fd7b['markerName']);if(_0x215212){for(const _0x4f3f0b of _0x215212)_0x4f3f0b['is']('uiElement')&&(_0x10e7b1['mapper']['unbindElementFromMarkerName'](_0x4f3f0b,_0x45fd7b['markerName']),_0x10e7b1['writer']['remove'](_0x4f3f0b));}},{'priority':'high'});}['_getChangeFromId'](_0x22fe81){return this['_changeIdToChange']['get'](_0x22fe81);}['_getViewForChange'](_0x2782a4){return this['_changeView']&&this['_changeView']['destroy'](),this['_changeView']=new Q(this['editor']['locale'],_0x2782a4),this['_changeView'];}['_initInteractions'](){this['editor']['model']['document']['selection']['observeMarkers']('revision'),this['on']('change:activeView',(_0xdf9e36,_0x11245e,_0x295cd5,_0x4baedb)=>{_0x4baedb&&this['_balloon']['remove'](_0x4baedb),_0x295cd5&&(this['_balloon']['add']({'view':_0x295cd5,'stackId':'revisionHistoryLabel','position':{'target':()=>{const _0x1ed7af=this['editor']['editing'],_0x4bc1bc=this['_getChangeFromId'](_0x295cd5['changeId']);let _0x5bc099;if(_0x4bc1bc['data']['isOnRoot']){const _0x5e774b=_0x1ed7af['view']['getDomRoot'](_0x4bc1bc['rootName']);_0x5bc099=Array['from'](_0x5e774b['getClientRects']());}else{const _0x1e6390=this['editor']['model']['markers']['get']('revision:'+_0x295cd5['changeId']);_0x5bc099=Array['from'](_0x1ed7af['mapper']['markerNameToElements'](_0x1e6390['name']))['map'](_0x2c276c=>_0x1ed7af['view']['domConverter']['mapViewToDom'](_0x2c276c))['map'](_0xc00ca=>Array['from'](_0xc00ca['getClientRects']()))['flat']();}if(!this['_activeViewTarget'])return _0x5bc099[0x0];return _0x5bc099['find'](_0x3e72c9=>_0x3e72c9['top']-0x3<=this['_activeViewTarget']['y']&&_0x3e72c9['bottom']+0x3>=this['_activeViewTarget']['y']&&_0x3e72c9['left']-0x3<=this['_activeViewTarget']['x']&&_0x3e72c9['right']+0x3>=this['_activeViewTarget']['x'])||_0x5bc099[0x0];}}}),this['_balloon']['showStack']('revisionHistoryLabel'));}),this['on']('change:activeChange',(_0x571150,_0x59ef3c,_0x18f446,_0x10f6fa)=>{this['activeView']=_0x18f446?this['_getViewForChange'](_0x18f446):null,this['editor']['model']['change'](()=>{const _0x142263=this['editor']['editing'];_0x10f6fa&&(_0x10f6fa['data']['isOnRoot']?_0x142263['view']['change'](_0xbebe3d=>{_0xbebe3d['removeClass']('ck-revision-history-root--active',_0x142263['view']['document']['getRoot'](_0x10f6fa['rootName']));}):_0x142263['reconvertMarker']('revision:'+_0x10f6fa['id'])),_0x18f446&&(_0x18f446['data']['isOnRoot']?_0x142263['view']['change'](_0x142a3a=>{_0x142a3a['addClass']('ck-revision-history-root--active',_0x142263['view']['document']['getRoot'](_0x18f446['rootName']));}):_0x142263['reconvertMarker']('revision:'+_0x18f446['id']));});}),this['listenTo'](this['editor']['editing']['view']['document'],'mouseover',(_0x190f45,_0x5d1947)=>{if(this['activeChange'])return;const _0x507b90=this['_findChangeIdFromDomTarget'](_0x5d1947['target']),_0x1957d0=this['_changeIdToChange']['get'](_0x507b90);_0x1957d0?(this['_activeViewTarget']={'x':_0x5d1947['domEvent']['x'],'y':_0x5d1947['domEvent']['y']},this['activeView']=this['_getViewForChange'](_0x1957d0)):(this['_activeViewTarget']=null,this['activeView']=null);}),this['listenTo'](this['editor']['editing']['view']['document'],'mousedown',(_0xa1e68b,_0x3127f9)=>{const _0x5b0a21=this['_findChangeIdFromDomTarget'](_0x3127f9['target']),_0x4c5152=this['_changeIdToChange']['get'](_0x5b0a21);_0x4c5152?(this['_activeViewTarget']={'x':_0x3127f9['domEvent']['x'],'y':_0x3127f9['domEvent']['y']},_0x4c5152===this['activeChange']?this['_balloon']['updatePosition']():this['activeChange']=_0x4c5152):(this['_activeViewTarget']=null,this['activeChange']=null);});}['_findChangeIdFromDomTarget'](_0x4e5d63){do{const _0x1993d5=_0x4e5d63['getAttribute']('data-change-id');if(_0x1993d5)return _0x1993d5;_0x4e5d63=_0x4e5d63['parent'];}while(_0x4e5d63);return null;}['_cleanMarkers'](){this['editor']['model']['change'](_0x3d9ed4=>{for(const _0x470ea1 of this['editor']['model']['markers'])_0x3d9ed4['removeMarker'](_0x470ea1);});}}function X(_0x3f32fa,_0x4bdf51){return(_0x37b6be,_0x25b0d0,_0x2541da)=>{if(!_0x2541da['consumable']['test'](_0x25b0d0['markerRange'],_0x37b6be['name']))return;const _0x2de2d2=_0x25b0d0['markerRange']['getWalker'](),_0x1e813a=_0x25b0d0['markerRange']['start'],_0x490862=_0x3f32fa['model']['schema'];let _0x274fb1=null,_0x5a7e1d=null,_0x126a3b=!0x1,_0x254e40=!0x1;for(const _0x52473d of _0x2de2d2){const _0x23402c=_0x52473d['item'];_0x126a3b=_0x126a3b||_0x490862['isContent'](_0x23402c);const _0x42347b=_0x2541da['mapper']['toViewElement'](_0x23402c);if(_0x42347b&&_0x42347b['getCustomProperty']('addHighlight'))return;'elementEnd'==_0x52473d['type']&&(_0x490862['isBlock'](_0x23402c)&&!_0x490862['isLimit'](_0x23402c)&&(_0x23402c['nextSibling']||_0x1e813a['isAtEnd']?_0x274fb1&&_0x274fb1['parent']==_0x23402c||(_0x274fb1=_0x23402c,_0x2956ff(_0x52473d['previousPosition']),_0x254e40=!0x0):_0x5a7e1d=_0x5a7e1d||_0x52473d['previousPosition']));}function _0x2956ff(_0xe526b9){const _0x517f8a=_0x2541da['mapper']['toViewPosition'](_0xe526b9),_0xf3198e=_0x2541da['writer']['createUIElement']('span',{'class':'ck-suggestion-preview-marker-'+_0x4bdf51});_0x2541da['writer']['insert'](_0x517f8a,_0xf3198e),_0x2541da['mapper']['bindElementToMarker'](_0xf3198e,_0x25b0d0['markerName']);}_0x126a3b||_0x254e40||!_0x5a7e1d||_0x2956ff(_0x5a7e1d);};}class wt extends _0x112594{constructor(_0x546a2a){super(_0x546a2a);const _0x61d4fb=_0x546a2a['plugins']['get'](m);this['affectsData']=!0x1,this['listenTo'](_0x61d4fb,'change:isReady',()=>this['refresh']()),this['listenTo'](_0x61d4fb,'change:isEnabled',()=>this['refresh']());}['execute'](){const _0x59aa1e=this['editor'],_0x58a067=_0x59aa1e['plugins']['get'](m),_0xac137f=_0x58a067['isReady']?_0x58a067['diff']['newRevisionId']:null;_0x59aa1e['config']['get']('revisionHistory')['restoreRevisionCallback'](_0xac137f);}['refresh'](){const {isReady:_0x2cad0f,isEnabled:_0xac9dd2,repository:_0x4cd8d,diff:_0x38adcd}=this['editor']['plugins']['get'](m),_0x5aacd4=_0x38adcd&&_0x4cd8d['getLaterVisibleRevision'](_0x38adcd['newRevisionId']);this['isEnabled']=_0x2cad0f&&_0xac9dd2&&Boolean(_0x5aacd4);}}class pt extends _0x112594{['_step'];constructor(_0x1eede6,{direction:_0x590770}){super(_0x1eede6);const _0x324c08=_0x1eede6['plugins']['get'](m);this['affectsData']=!0x1,this['_step']='forward'===_0x590770?0x1:-0x1,this['listenTo'](_0x324c08,'change:isReady',()=>this['refresh']()),this['listenTo'](_0x324c08,'change:isEnabled',()=>this['refresh']()),this['listenTo'](_0x324c08,'change:activeChange',()=>this['refresh']());}['execute'](){const _0x293bb9=this['editor'],_0x15f0de=_0x293bb9['plugins']['get'](m),{isNavigationMode:_0x1ced30,currentChangeNumber:_0x59596b}=_0x15f0de;let _0x3c1f18;if(_0x15f0de['activeChange']=_0x1ced30?_0x15f0de['diff']['changes']['get'](_0x59596b+this['_step']):_0x15f0de['diff']['changes']['first'],_0x15f0de['activeChange']['data']['isOnRoot'])_0x3c1f18=_0x293bb9['editing']['view']['getDomRoot'](_0x15f0de['activeChange']['rootName']);else{const _0x3afcca=_0x293bb9['model']['markers']['get']('revision:'+_0x15f0de['activeChange']['id']);_0x3c1f18=_0x4b1dc2(_0x293bb9['editing'],_0x3afcca);}_0x21d49f({'target':_0x3c1f18,'viewportOffset':0x28});}['refresh'](){const {isNavigationMode:_0x5d2e48,currentChangeNumber:_0x59f75c,numberOfChanges:_0x38f4b4,isReady:_0x3b130f,isEnabled:_0x517d2a}=this['editor']['plugins']['get'](m);this['isEnabled']=!!(_0x517d2a&&_0x3b130f&&_0x38f4b4)&&(!_0x5d2e48||(0x1===this['_step']?_0x59f75c<_0x38f4b4-0x1:_0x59f75c>0x0));}}class _i extends _0x19ab0f{constructor(_0x57ce9e){super(_0x57ce9e);const _0xa8c937=this['bindTemplate'],_0x86f207=new _0x5aa74d(_0x57ce9e),_0x580a0b=new _0x5aa74d(_0x57ce9e);this['set']('isNavigationMode',!0x1),this['set']('isReady',!0x1),this['set']('currentChangeNumber',0x0),this['set']('numberOfChanges',0x0),this['set']('isForwardNavigationEnabled',!0x1),this['set']('isBackwardNavigationEnabled',!0x1),this['bind']('_isStatusLabelVisible')['to'](this,'isReady',this,'numberOfChanges',(_0x313044,_0x55f655)=>_0x313044&&_0x55f655>0x0),this['bind']('_statusText')['to'](this,'isReady',this,'currentChangeNumber',this,'numberOfChanges',this,'isNavigationMode',(_0x3ebccf,_0xfe728b,_0x306ed8,_0x2dfb4a)=>{if(!_0x3ebccf)return g(_0x57ce9e,'Loading...');if(!_0x306ed8)return g(_0x57ce9e,'No\x20changes');const _0x35da8c=g(_0x57ce9e,'NUMBER_OF_CHANGES',_0x306ed8);return _0x2dfb4a?g(_0x57ce9e,'X_OF_Y_CHANGES',[_0xfe728b+0x1,_0x306ed8]):_0x35da8c;}),_0x86f207['set']({'label':g(_0x57ce9e,'Show\x20previous\x20change'),'tooltip':!0x0,'icon':_0x45d321}),_0x580a0b['set']({'label':g(_0x57ce9e,'Show\x20next\x20change'),'tooltip':!0x0,'icon':_0x528fe4}),_0x86f207['bind']('isEnabled')['to'](this,'isBackwardNavigationEnabled'),_0x580a0b['bind']('isEnabled')['to'](this,'isForwardNavigationEnabled'),_0x86f207['on']('execute',()=>this['fire']('execute','backward')),_0x580a0b['on']('execute',()=>this['fire']('execute','forward')),this['setTemplate']({'tag':'div','attributes':{'class':['ck','ck-revision-history-ui','ck-revision-history-ui__changes-navigation']},'children':[{'tag':'span','attributes':{'class':['ck-revision-history-ui__changes-navigation__wrapper']},'children':[{'tag':'span','attributes':{'class':['ck-revision-history-ui__changes-navigation__label',_0xa8c937['if']('_isStatusLabelVisible','ck-hidden',_0x3e80bf=>!_0x3e80bf)]},'children':[{'text':_0xa8c937['to']('isNavigationMode',_0x3351e1=>_0x3351e1?g(_0x57ce9e,'EDIT_X_OF_Y_REVISIONS')+':\x20':g(_0x57ce9e,'Total')+':\x20')}]},{'text':_0xa8c937['to']('_statusText')}]},new _0x113a97(),{'tag':'div','attributes':{'class':['ck-revision-history-ui__changes-navigation__navigation']},'children':[_0x86f207,_0x580a0b]}]});}}const ce='ck-editor__editable__loading-overlay';class le extends _0x4f3c67{static get['pluginName'](){return'RevisionViewerLoadingOverlay';}static get['isOfficialPlugin'](){return!0x0;}static get['isPremiumPlugin'](){return!0x0;}['show'](){const _0x50bc01=this['editor']['editing']['view'];_0x50bc01['change'](_0x2f7972=>{for(const _0x296206 of _0x50bc01['document']['roots'])_0x2f7972['addClass'](ce,_0x296206);});}['hide'](){const _0x17fe35=this['editor']['editing']['view'];_0x17fe35['change'](_0x7d6f2=>{for(const _0x9b1e47 of _0x17fe35['document']['roots'])_0x7d6f2['removeClass'](ce,_0x9b1e47);});}}class R extends _0x4f3c67{static get['pluginName'](){return'RevisionViewerUI';}static get['isOfficialPlugin'](){return!0x0;}static get['isPremiumPlugin'](){return!0x0;}static get['requires'](){return[m,le];}['init'](){const _0x3c59d0=this['editor'],_0x390020=_0x3c59d0['plugins']['get'](m),_0x3e5066=_0x3c59d0['plugins']['get'](le);_0x3c59d0['ui']['componentFactory']['add']('exitToEditing',_0x184f44=>{const _0x24c355=new _0x5aa74d(_0x184f44);return _0x24c355['set']({'label':g(_0x184f44,'Back\x20to\x20editing'),'icon':_0x1c8a94,'withText':!0x0,'tooltip':!0x0,'class':'ck-revision-history-ui__back-to-editing'}),this['listenTo'](_0x24c355,'execute',()=>{_0x3c59d0['config']['get']('revisionHistory')['closeRevisionViewerCallback']();}),_0x24c355;}),_0x3c59d0['ui']['componentFactory']['add']('restoreRevision',_0x29af67=>{const _0x70bfe3=new _0x5aa74d(_0x29af67);return _0x70bfe3['set']({'label':g(_0x29af67,'Restore\x20this\x20revision'),'withText':!0x0,'tooltip':!0x0}),_0x70bfe3['bind']('isEnabled')['to'](_0x3c59d0['commands']['get']('restoreRevision')),this['listenTo'](_0x70bfe3,'execute',()=>_0x3c59d0['execute']('restoreRevision')),_0x70bfe3;}),_0x3c59d0['ui']['componentFactory']['add']('changesNavigation',_0x8dc63b=>{const _0xecc0d0=new _i(_0x8dc63b),_0x1dcbbe=_0x3c59d0['commands']['get']('showPreviousChange'),_0x5b7b52=_0x3c59d0['commands']['get']('showNextChange');return _0xecc0d0['bind']('isBackwardNavigationEnabled')['to'](_0x1dcbbe,'isEnabled'),_0xecc0d0['bind']('isForwardNavigationEnabled')['to'](_0x5b7b52,'isEnabled'),_0xecc0d0['bind']('isReady','currentChangeNumber','numberOfChanges','isNavigationMode')['to'](_0x390020),this['listenTo'](_0xecc0d0,'execute',(_0x18fd65,_0x4545f2)=>{_0x3c59d0['execute']('forward'===_0x4545f2?'showNextChange':'showPreviousChange');}),_0xecc0d0;}),_0x3e5066['show'](),_0x390020['on']('change:isReady',(_0x2a3786,_0x2f31fa,_0x241e12)=>{_0x241e12?_0x3e5066['hide']():_0x3e5066['show']();});}}class lt extends nt{['_resizeObserver']=null;constructor(_0x5f2111,_0x1d3d85){super(_0x5f2111,_0x1d3d85);const _0x2a9369=this['bindTemplate'];this['set']({'label':g(_0x5f2111,'Revision\x20name'),'_tooltipString':''}),this['fieldView']['placeholder']=g(_0x5f2111,'Enter\x20the\x20revision\x20name'),this['extendTemplate']({'tag':'span','attributes':{'class':['ck-revision-history-sidebar__revision-name'],'data-cke-tooltip-text':_0x2a9369['to']('_tooltipString'),'data-cke-tooltip-position':'s','data-cke-tooltip-class':'ck-tooltip_multi-line'}});}['render'](){super['render'](),this['_resizeObserver']=new at(this['fieldView']['element'],()=>this['_updateTooltipText']()),this['listenTo'](this['fieldView'],'input',()=>this['_updateTooltipText']());}['destroy'](){super['destroy'](),this['_resizeObserver']&&this['_resizeObserver']['destroy']();}['_updateTooltipText'](){const _0x4cf964=this['fieldView']['element'];this['_tooltipString']=_0x4cf964['scrollWidth']>_0x4cf964['clientWidth']&&_0x4cf964['value']||'';}}class oi extends _0x19ab0f{constructor(_0x15a0a5,_0x137ef3,_0x1fee56){super(_0x15a0a5);const _0x1026f5=new _0x5c8c80();_0x1026f5['set']({'content':_0x209bf3,'viewBox':'0\x200\x2011\x2010'});const _0x3a7c31=['ck','ck-revision-history-sidebar__revision-author'];_0x1fee56&&_0x3a7c31['push']('ck-revision-history-sidebar__revision-author_creator');const _0x1f8ab0=[{'tag':'span','attributes':{'class':['ck','ck-revision-history-sidebar__revision-author__name'],'title':g(_0x15a0a5,_0x1fee56?'Revision\x20creator':'Revision\x20author')},'children':[_0x1026f5,_0x137ef3['name']]}];this['setTemplate']({'tag':'li','attributes':{'class':_0x3a7c31},'children':_0x1f8ab0});}}function ni(_0x36a41e,_0x5c34fd){const _0x326bfe=_0x36a41e['bindTemplate'],_0x14aaff=_0x36a41e['locale'],_0x47246f=_0x12ccea(_0x14aaff);_0x47246f['panelPosition']='sw';const _0x9272ca=function(_0x42196b,_0x2b4d2f){const _0x4eef13=function(_0x17d7b4,_0x5ece13){const _0x1364eb=_0x17d7b4['locale'],_0x1181b8={'Compare\x20against\x20selected':g(_0x1364eb,'Compare\x20against\x20selected'),'Name\x20this\x20revision':g(_0x1364eb,'Name\x20this\x20revision'),'Restore\x20this\x20revision':g(_0x1364eb,'Restore\x20this\x20revision')};return _0x5ece13['map'](_0x4a087a=>{const _0x330848=_0x1181b8[_0x4a087a['name']];return _0x330848&&_0x330848!==_0x4a087a['name']&&(_0x4a087a['name']=_0x330848),_0x4a087a;});}(_0x42196b,_0x2b4d2f),_0x3d5e74=new _0x162b6b();for(const _0x3935f1 of _0x4eef13){const _0x4d5948={'type':'button','model':new to({'label':_0x3935f1['name'],'class':_0x3935f1['class'],'withText':!0x0,'role':'menuitem','_action':_0x3935f1['action']})};_0x4d5948['model']['bind']('isEnabled')['to'](_0x42196b,'isActionsDropdownOpen',_0x3e020c=>'function'!=typeof _0x3935f1['isEnabled']||(!_0x3e020c||_0x3935f1['isEnabled'](_0x42196b))),_0x3d5e74['add'](_0x4d5948);}return _0x3d5e74;}(_0x36a41e,_0x5c34fd);return _0x36a41e['bind']('isActionsDropdownOpen')['to'](_0x47246f,'isOpen'),_0x47246f['buttonView']['set']({'label':g(_0x14aaff,'Show\x20more\x20items'),'tooltip':!0x0,'tooltipPosition':'sw','icon':_0x2def39}),_0x47246f['extendTemplate']({'attributes':{'class':['ck-revision-history-sidebar__revision__actions',_0x326bfe['if']('isActionsDropdownOpen','ck-on')]},'on':{'click':_0x326bfe['to'](_0x89666d=>_0x89666d['stopPropagation']())}}),_0x47246f['on']('execute',_0x5c1ddc=>{_0x36a41e['isReady']&&'function'==typeof _0x5c1ddc['source']['_action']&&_0x5c1ddc['source']['_action'](_0x36a41e);}),_0x1bb89d(_0x47246f,_0x9272ca,{'role':'menu'}),_0x47246f['listenTo'](_0x36a41e,'change:isActionsDropdownOpen',(_0x4d77ab,_0x4c1a01,_0x5d48f6)=>{if(_0x5d48f6)for(const _0x4a4239 of _0x47246f['listView']['items']){const _0x22902e=_0x4a4239['children']['first'],_0x17cc67=_0x5c34fd['find'](_0x5a488e=>_0x5a488e['action']===_0x22902e['_action'])['isVisible'];_0x4a4239['isVisible']=void 0x0===_0x17cc67||_0x17cc67(_0x36a41e);}}),_0x47246f;}class ai extends/* #__PURE__ -- @preserve */
_0x3ef6a4(_0x19ab0f){['id'];['revisionNameView'];['revisionActionsView'];['_revision'];['_requireRevisionName'];constructor(_0x46a63d,_0x4f06cb,_0x1376b2,_0x2dc7d5){super(_0x46a63d);const _0x20dbac=this['bindTemplate'],_0x1987e8=function(_0x4be51d,_0x1d030b){const _0x31764d=Array['from'](_0x1d030b['authors'])['filter'](_0x31585f=>_0x31585f!=_0x1d030b['creator']);return _0x1d030b['creator']&&_0x31764d['unshift'](_0x1d030b['creator']),_0x31764d['map'](_0x3aa5bc=>new oi(_0x4be51d,_0x3aa5bc,_0x3aa5bc==_0x1d030b['creator']));}(_0x46a63d,_0x4f06cb);this['id']=_0x4f06cb['id'],this['_revision']=_0x4f06cb,this['_requireRevisionName']=_0x2dc7d5,this['bind']('name','createdAt')['to'](_0x4f06cb),this['bind']('_createdAtFormatted')['to'](this,'createdAt',_0x272962=>{return _0x2be0e0=_0x46a63d['uiLanguage'],(_0x2bd73a=_0x272962)['toLocaleDateString'](_0x2be0e0,{'month':'long','day':'numeric'})+',\x20'+_0x2bd73a['toLocaleTimeString'](_0x2be0e0,{'hour':'numeric','minute':'numeric'});var _0x2be0e0,_0x2bd73a;}),this['set']('isSelected',!0x1),this['set']('isHighlighted',!0x1),this['set']('isActionsDropdownOpen',!0x1),this['set']('isReady',!0x1),this['set']('isEnabled',!0x1),this['revisionNameView']=new lt(_0x46a63d,ti),this['revisionNameView']['fieldView']['extendTemplate']({'attributes':{'maxlength':'220'}}),this['revisionNameView']['fieldView']['bind']('value')['to'](this,'name',_0x282d46=>_0x282d46||this['_createdAtFormatted']),this['revisionNameView']['bind']('isEnabled')['to'](this,'isSelected',this,'isEnabled',(_0x49644a,_0xf2537c)=>_0x49644a&&_0xf2537c),this['revisionActionsView']=_0x1376b2&&_0x1376b2['length']?ni(this,_0x1376b2):'',this['revisionActionsView']&&this['revisionActionsView']['bind']('isEnabled')['to'](this),this['setTemplate']({'tag':'div','attributes':{'class':['ck','ck-reset','ck-revision-history-sidebar__revision-wrapper',_0x20dbac['if']('isConfirm','ck-revision-history-sidebar__revision-wrapper_confirmation_visible')]},'children':[{'tag':'div','attributes':{'class':['ck','ck-reset','ck-revision-history-sidebar__revision',_0x20dbac['if']('isEnabled','ck-disabled',_0x3c8d08=>!_0x3c8d08),_0x20dbac['if']('isSelected','ck-revision-history-sidebar__revision_selected'),_0x20dbac['if']('isHighlighted','ck-revision-history-sidebar__revision_highlighted'),_0x20dbac['if']('isActionsDropdownOpen','ck-revision-history-sidebar__actions_dropdown_open')]},'children':[this['revisionNameView'],{'tag':'span','attributes':{'class':['ck','ck-revision-history-sidebar__revision__date']},'children':[{'text':_0x20dbac['to']('_createdAtFormatted')}]},{'tag':'div','attributes':{'class':['ck','ck-revision-history-sidebar__revision__controls-wrapper']},'children':[{'tag':'ul','attributes':{'class':['ck','ck-revision-history-sidebar__revision-authors']},'children':_0x1987e8}]},this['revisionActionsView']],'on':{'click':_0x20dbac['to'](_0x507fbc=>{_0x507fbc['srcElement']['closest']('.ck-thread__remove-confirm')||this['isReady']&&this['isEnabled']&&this['fire']('select',{'id':this['id']});})}}]});}['render'](){super['render']();const _0x1f65a6=this['revisionNameView']['fieldView']['element'];this['listenTo'](_0x1f65a6,'change',()=>{this['_requireRevisionName']&&!_0x1f65a6['value']||this['fire']('setName',{'id':this['id'],'name':_0x1f65a6['value']}),_0x1f65a6['value']||(_0x1f65a6['value']=this['name']?this['name']:this['_createdAtFormatted']);});}['select'](){this['isSelected']=!0x0;}['deselect'](){this['isSelected']=!0x1;}['highlight'](){this['isHighlighted']=!0x0;}['unhighlight'](){this['isHighlighted']=!0x1;}}function vi(_0xad0351,_0x4e9be4){const _0x37f1fd=_0x145edb['fromJSDate'](_0xad0351)['setLocale'](_0x4e9be4),_0x5cc625=_0x145edb['local'](),_0xf85f8d=_0x5cc625['minus']({'days':0x1})['startOf']('day');let _0x2d65d9,_0x4d3464;return _0x37f1fd['hasSame'](_0x5cc625,'day')?(_0x2d65d9=_0x37f1fd['startOf']('day')['toJSDate'](),_0x4d3464=_0x37f1fd['toRelativeCalendar']()):_0x37f1fd['hasSame'](_0xf85f8d,'day')?(_0x2d65d9=_0xf85f8d['toJSDate'](),_0x4d3464=_0x37f1fd['toRelativeCalendar']()):_0x37f1fd['hasSame'](_0x5cc625,'week')?(_0x2d65d9=_0x37f1fd['startOf']('week')['toJSDate'](),_0x4d3464=_0x37f1fd['weekdayLong']||''):_0x37f1fd['hasSame'](_0x5cc625,'year')?(_0x2d65d9=_0x37f1fd['startOf']('month')['toJSDate'](),_0x4d3464=_0x37f1fd['monthLong']||''):(_0x2d65d9=_0x37f1fd['startOf']('year')['toJSDate'](),_0x4d3464=String(_0x37f1fd['year'])),{'startDate':_0x2d65d9,'localizedPeriodName':_0x4d3464};}class mi extends _0x19ab0f{['startDate'];['revisionViews'];['_revisionActions'];['_requireRevisionName'];constructor(_0x4dce07,_0x175c8c,_0x2fa38f,_0x3a0ce1){super(_0x4dce07);const _0x5b6dff=vi(_0x175c8c,this['locale']['uiLanguage'])['localizedPeriodName'];this['startDate']=_0x175c8c,this['revisionViews']=this['createCollection'](),this['_revisionActions']=_0x2fa38f,this['_requireRevisionName']=_0x3a0ce1,this['revisionViews']['delegate']('select')['to'](this),this['revisionViews']['delegate']('setName')['to'](this),this['setTemplate']({'tag':'div','attributes':{'class':['ck','ck-revision-history-sidebar__time-period']},'children':[{'tag':'span','attributes':{'class':['ck','ck-revision-history-sidebar__time-period__label']},'children':[{'text':_0x5b6dff}]},{'tag':'div','attributes':{'class':['ck','ck-revision-history-sidebar__time-period__revisions']},'children':this['revisionViews']}]});}['addRevision'](_0x55f3e8){const _0x324852=new ai(this['locale'],_0x55f3e8,this['_revisionActions'],this['_requireRevisionName']);this['revisionViews']['add'](_0x324852);}['removeRevision'](_0x1cf793){const _0x3c3114=this['revisionViews']['find'](_0x174fee=>_0x174fee['id']===_0x1cf793['id']);this['revisionViews']['remove'](_0x3c3114);}}class as extends _0x19ab0f{constructor(_0xafce72){super(_0xafce72);const _0x2591f9=new _0x5c8c80();_0x2591f9['content']=_0x52a100,this['setTemplate']({'tag':'div','attributes':{'class':['ck','ck-reset_all','ck-revision-history-sidebar__header']},'children':[_0x2591f9,{'tag':'span','attributes':{'class':['ck','ck-revision-history-sidebar__header__label']},'children':[g(_0xafce72,'Revision\x20history')]}]});}}class di extends _0x19ab0f{['timePeriodViews'];['_revisions'];['_revisionActions'];['_requireRevisionName'];constructor(_0x327f01,_0x66184f,_0x4b0325,_0x49555e){super(_0x327f01);const _0x575b23=this['bindTemplate'];this['timePeriodViews']=this['createCollection'](),this['timePeriodViews']['delegate']('select')['to'](this),this['timePeriodViews']['delegate']('setName')['to'](this),this['_revisions']=_0x66184f,this['_revisionActions']=_0x4b0325,this['_requireRevisionName']=_0x49555e,this['on']('select',(_0x33a170,_0x438d05)=>{this['fire']('revisionSelected',_0x438d05);}),this['on']('setName',(_0x131259,_0x5bf50f)=>{this['fire']('revisionSetName',_0x5bf50f);}),this['set']('isEnabled',!0x1),this['setTemplate']({'tag':'div','attributes':{'class':['ck','ck-reset','ck-rounded-corners','ck-revision-history-sidebar']},'children':[new as(_0x327f01),{'tag':'div','attributes':{'class':['ck','ck-revision-history-sidebar__timeline',_0x575b23['if']('isEnabled','ck-disabled',_0x57732e=>!_0x57732e)]},'children':this['timePeriodViews']}]});}['render'](){super['render']();for(const _0x36b994 of this['_revisions'])this['_addRevision'](_0x36b994);this['_revisions']['on']('add',(_0x2d2f7e,_0x132f82)=>{this['_addRevision'](_0x132f82);}),this['_revisions']['on']('remove',(_0x127394,_0x280947)=>{this['_removeRevision'](_0x280947);});}get['revisionViews'](){return this['timePeriodViews']['map'](_0xf9b52b=>_0xf9b52b['revisionViews']['map'](_0x238c00=>_0x238c00))['flat']();}['selectRevision'](_0x482f04){for(const _0x2d36f8 of this['revisionViews'])_0x482f04&&_0x482f04['id']===_0x2d36f8['id']?_0x2d36f8['select']():_0x2d36f8['deselect']();}['highlightRevisions'](_0x43307b){for(const _0x258298 of this['revisionViews'])_0x43307b['some'](({id:_0x21cdb7})=>_0x21cdb7===_0x258298['id'])?_0x258298['highlight']():_0x258298['unhighlight']();}['_addRevision'](_0x1fad29){const _0x7615bf=vi(_0x1fad29['createdAt'],this['locale']['uiLanguage'])['startDate'];let _0x581189=this['timePeriodViews']['get'](0x0);_0x581189&&_0x581189['startDate']['getTime']()===_0x7615bf['getTime']()||(_0x581189=new mi(this['locale'],_0x7615bf,this['_revisionActions'],this['_requireRevisionName']),this['timePeriodViews']['add'](_0x581189)),_0x581189['addRevision'](_0x1fad29);}['_removeRevision'](_0x116f47){const _0x335bc7=vi(_0x116f47['createdAt'],this['locale']['uiLanguage'])['startDate'];this['_getTimePeriodViewByStartDate'](_0x335bc7)['removeRevision'](_0x116f47);}['_getTimePeriodViewByStartDate'](_0x3741d2){return this['timePeriodViews']['find'](_0x2b9f9f=>_0x2b9f9f['startDate']['getTime']()===_0x3741d2['getTime']());}}class d extends _0x4f3c67{['_revisionViewer'];['_revisionsRepository'];['_sidebarView'];static ['defaultRevisionActions']=/* #__PURE__ -- @preserve */
((()=>['compareAgainstSelected','restoreRevision','nameRevision'])());static ['availableRevisionActions']=/* #__PURE__ -- @preserve */
_t();static get['pluginName'](){return'RevisionsSidebar';}static get['isOfficialPlugin'](){return!0x0;}static get['isPremiumPlugin'](){return!0x0;}static get['requires'](){return[m];}constructor(_0x5b9f22){super(_0x5b9f22),this['_revisionViewer']=_0x5b9f22['plugins']['get'](m),this['_revisionsRepository']=this['_revisionViewer']['repository'],this['_sidebarView']=null;}['init'](){const _0x442846=this['_revisionsRepository']['_revisions'],_0x514746=this['_createRevisionActions'](),_0x1ebe45=this['editor']['config']['get']('revisionHistory.viewerSidebarContainer');this['_sidebarView']=new di(this['editor']['locale'],_0x442846,_0x514746,this['editor']['config']['get']('revisionHistory.requireRevisionName')),this['_sidebarView']['on']('revisionSelected',this['_handleRevisionSelected']['bind'](this)),this['_sidebarView']['on']('revisionSetName',this['_handleRevisionSetName']['bind'](this)),this['_sidebarView']['bind']('isEnabled')['to'](this['_revisionViewer']),this['_sidebarView']['timePeriodViews']['on']('add',(_0x298be1,_0xcda991)=>{_0xcda991['revisionViews']['on']('add',(_0x28e15c,_0xfee43f)=>{_0xfee43f['bind']('isEnabled','isReady')['to'](this['_revisionViewer']);});}),this['_sidebarView']['render'](),this['listenTo'](this['editor']['data'],'ready',this['_handleEditorDataReady']['bind'](this)),this['listenTo'](this['_revisionViewer'],'change:diff',this['_handleDiffChange']['bind'](this)),_0x1ebe45['appendChild'](this['_sidebarView']['element']);}['destroy'](){this['_sidebarView']['element']['remove'](),this['_sidebarView']['destroy']();}['_handleEditorDataReady'](){const _0x2992d3=this['_revisionsRepository']['getRevision'](0x0);if(_0x2992d3){const _0x541c86=this['_revisionsRepository']['getEarlierVisibleRevision'](_0x2992d3['id']);this['_revisionViewer']['compare'](_0x2992d3,_0x541c86);}}['_handleRevisionSelected'](_0x22b8ca,_0x111b69){const _0x3a09f6=this['_revisionsRepository']['getRevision'](_0x111b69['id']),_0x415d67=this['_revisionsRepository']['getEarlierVisibleRevision'](_0x3a09f6['id']);this['_revisionViewer']['compare'](_0x3a09f6,_0x415d67);}['_handleRevisionSetName'](_0x2661de,_0x1a29eb){this['_revisionsRepository']['getRevision'](_0x1a29eb['id'])['setName'](_0x1a29eb['name']);}['_handleDiffChange'](_0xb55d39,_0x5dd989,_0x5d345f){const _0x340339=this['_revisionsRepository']['getRevisionsInDiff'](_0x5d345f);_0x340339['length']>0x2?(this['_sidebarView']['highlightRevisions'](_0x340339),this['_sidebarView']['selectRevision'](null)):(this['_sidebarView']['highlightRevisions']([]),this['_sidebarView']['selectRevision'](_0x340339[0x0]));}['_createRevisionActions'](){const _0x263638=this['editor'],_0xa21f8e=d['availableRevisionActions'],_0x2f1283=_0x263638['config']['get']('revisionHistory.revisionActions')||d['defaultRevisionActions'];if(_0x2f1283['length'])return _0x2f1283['map'](_0x4b4b00=>{const _0x1ef301='string'==typeof _0x4b4b00?Object['assign']({},_0xa21f8e[_0x4b4b00]):_0x4b4b00;return _0x1ef301['action']=_0x1ef301['action']['bind'](this,_0x263638),_0x1ef301['isVisible']&&(_0x1ef301['isVisible']=_0x1ef301['isVisible']['bind'](this,_0x263638)),_0x1ef301;});}}function _t(){return{'compareAgainstSelected':{'name':'Compare\x20against\x20selected','action':({plugins:_0x25050f},_0x20584b)=>{const _0x27a3d5=_0x25050f['get'](m),_0x57bc0b=_0x27a3d5['repository'];let _0xe33c80=_0x27a3d5['diff']['newRevisionId'],_0x22d43c=_0x20584b['id'];_0x57bc0b['getIndex'](_0xe33c80)>_0x57bc0b['getIndex'](_0x22d43c)&&([_0xe33c80,_0x22d43c]=[_0x22d43c,_0xe33c80]),_0x27a3d5['compare'](_0xe33c80,_0x22d43c);},'isVisible':({plugins:_0x13c8ad},_0x2d78bf)=>{const _0x9261fa=_0x13c8ad['get'](m);return!(_0x9261fa['repository']['getRevisionsInDiff'](_0x9261fa['diff'])['length']>0x2)&&!_0x2d78bf['isSelected'];}},'restoreRevision':{'name':'Restore\x20this\x20revision','action':(_0x7803ae,{id:_0x13e66c})=>{_0x7803ae['config']['get']('revisionHistory')['restoreRevisionCallback'](_0x13e66c);},'isVisible':({plugins:_0x545286},_0x46e133)=>!!_0x545286['get'](m)['repository']['getLaterVisibleRevision'](_0x46e133['id'])},'nameRevision':{'name':'Name\x20this\x20revision','action':({plugins:_0x4c009a},{id:_0x23c3da,revisionNameView:_0x4811d0})=>{const _0x2ad592=_0x4c009a['get'](m),_0x326697=_0x2ad592['repository']['getEarlierVisibleRevision'](_0x23c3da);_0x2ad592['compare'](_0x23c3da,_0x326697),_0x4811d0['focus'](),_0x4811d0['fieldView']['select']();}}};}class tt extends st{['_view'];['_toolbarConfig'];['_elementReplacer'];get['view'](){return this['_view'];}constructor(_0x339a74,_0x136ee0){super(_0x339a74),this['_view']=_0x136ee0,this['_toolbarConfig']=et(_0x339a74['config']['get']('toolbar')),this['_elementReplacer']=new ot();}get['element'](){return this['view']['element'];}['init'](_0x477890){const _0x1f6c1e=this['editor'],_0x5349b5=this['view'],_0x4e0bba=_0x1f6c1e['editing']['view'],_0x3d67f6=_0x5349b5['editable'],_0x1cafd2=_0x4e0bba['document']['getRoot']();_0x3d67f6['name']=_0x1cafd2['rootName'],_0x5349b5['render']();const _0x5ee926=_0x3d67f6['element'];this['setEditableElement'](_0x3d67f6['name'],_0x5ee926),_0x5349b5['editable']['bind']('isFocused')['to'](this['focusTracker']),_0x4e0bba['attachDomRoot'](_0x5ee926),this['_elementReplacer']['replace'](_0x477890,this['element']),this['_initToolbar'](),this['fire']('ready');}['destroy'](){super['destroy']();const _0x4e6b15=this['view'],_0x4ee5e5=this['editor']['editing']['view'];this['_elementReplacer']['restore'](),_0x4ee5e5['detachDomRoot'](_0x4e6b15['editable']['name']),_0x4e6b15['destroy']();}['_initToolbar'](){const _0xe8bccf=this['view'];_0xe8bccf['stickyPanel']['bind']('isActive')['to'](this['focusTracker'],'isFocused'),_0xe8bccf['stickyPanel']['limiterElement']=_0xe8bccf['element'],_0xe8bccf['stickyPanel']['bind']('viewportTopOffset')['to'](this,'viewportOffset',({top:_0x3711ee})=>_0x3711ee),_0xe8bccf['toolbar']['fillFromConfig'](this['_toolbarConfig'],this['componentFactory']),this['addToolbar'](_0xe8bccf['toolbar']);}}class it extends rt{['_editable'];['stickyPanel'];['toolbar'];get['editable'](){return this['_editable'];}constructor(_0x3b78c8,_0xd671df,_0xf28325={}){super(_0x3b78c8),this['stickyPanel']=new ht(_0x3b78c8),this['toolbar']=new dt(_0x3b78c8,{'shouldGroupWhenFull':_0xf28325['shouldToolbarGroupWhenFull']}),this['_editable']=new ct(_0x3b78c8,_0xd671df);}['render'](){super['render'](),this['stickyPanel']['content']['add'](this['toolbar']),this['top']['add'](this['stickyPanel']),this['main']['add'](this['editable']);}}class w extends/* #__PURE__ -- @preserve */
_0x35f471(_0x21dcfe){['_ui'];get['ui'](){return this['_ui'];}constructor(_0x1c9ba7,_0x24e7d9){super(_0x24e7d9),this['sourceElement']=_0x1c9ba7,this['model']['document']['createRoot']();const _0x6a673e=new it(this['locale'],this['editing']['view'],{'shouldToolbarGroupWhenFull':!0x0});this['_ui']=new tt(this,_0x6a673e);}['destroy'](){return this['updateSourceElement'](),this['ui']['destroy'](),super['destroy']();}static async['create'](_0xf28c0b,_0x1390aa){const _0x5e8058=new this(_0xf28c0b,_0x1390aa);return await _0x5e8058['initPlugins'](),await _0x5e8058['ui']['init'](_0xf28c0b),await _0x5e8058['data']['init'](_0x5e8058['config']['get']('initialData')||''),_0x5e8058['fire']('ready'),_0x5e8058;}}const p=['RevisionHistoryUI','RestrictedEditingMode'];class yt extends _0x4f3c67{['result'];static get['pluginName'](){return'RevisionViewerIntegration';}static get['isOfficialPlugin'](){return!0x0;}static get['isPremiumPlugin'](){return!0x0;}constructor(_0x5c0d4d){function _0x266eb4(_0xf71c07){return _0xf71c07['map'](_0x1a2fef=>String['fromCharCode'](_0x1a2fef))['join']('');}super(_0x5c0d4d),this['result']='end',_0x5c0d4d[_0x266eb4([0x65,0x64,0x69,0x74,0x69,0x6e,0x67])][_0x266eb4([0x76,0x69,0x65,0x77])][_0x266eb4([0x5f,0x6f,0x76,0x65,0x72,0x6c,0x61,0x79,0x4d,0x6f,0x64,0x65,0x48,0x69,0x6e,0x74])]=_0x266eb4([0x61,0x75,0x74,0x6f]),_0x5c0d4d[_0x266eb4([0x5f,0x73,0x65,0x6e,0x64,0x55,0x73,0x61,0x67,0x65,0x52,0x65,0x71,0x75,0x65,0x73,0x74])]=()=>window[_0x266eb4([0x50,0x72,0x6f,0x6d,0x69,0x73,0x65])][_0x266eb4([0x72,0x65,0x73,0x6f,0x6c,0x76,0x65])]({[_0x266eb4([0x73,0x74,0x61,0x74,0x75,0x73])]:_0x266eb4([0x6f,0x6b])});}}class k extends _0x4f3c67{['_viewerEditor'];static get['pluginName'](){return'RevisionHistory';}static get['isOfficialPlugin'](){return!0x0;}static get['isPremiumPlugin'](){return!0x0;}static get['requires'](){return[u,f];}constructor(_0x44601d){if(super(_0x44601d),!this['editor']['config']['get']('revisionHistory'))throw new _0x843912('revision-history-missing-configuration',this);this['_viewerEditor']=null,this['set']('isRevisionViewerOpen',!0x1),this['editor']['config']['define']('revisionHistory.showRevisionViewerCallback',_0x601afc=>this['_showRevisionViewer']({..._0x601afc,'translations':this['editor']['locale']['translations']})),this['editor']['config']['define']('revisionHistory.closeRevisionViewerCallback',_0x3b5ae7=>this['_closeRevisionViewer'](_0x3b5ae7)),this['editor']['config']['define']('revisionHistory.restoreRevisionCallback',_0x6a31d5=>this['_restoreRevision'](_0x6a31d5)),this['editor']['config']['define']('revisionHistory.requireRevisionName',!0x1),this['_enhanceShowRevisionViewerCallback'](),this['_enhanceCloseRevisionViewerCallback']();}set['adapter'](_0x4a2646){this['editor']['plugins']['get']('RevisionTracker')['adapter']=_0x4a2646;}get['adapter'](){return this['editor']['plugins']['get']('RevisionTracker')['adapter'];}['addRevisionData'](_0x5b5c43){return this['editor']['plugins']['get']('RevisionTracker')['addRevisionData'](_0x5b5c43);}['getRevision'](_0x3ec4ed){return this['editor']['plugins']['get']('RevisionsRepository')['getRevision'](_0x3ec4ed);}['getRevisions'](_0x4df3ad){return this['editor']['plugins']['get']('RevisionsRepository')['getRevisions'](_0x4df3ad||{'toJSON':!0x1});}['_getRevisionViewerEditorConfig'](){const _0x54096b=this['editor'],_0x2d6bd9=_0x51485a(_0x54096b,p),_0x3c54c9=_0x54096b['plugins']['get']('RevisionTracker'),_0x12ba05=_0x54096b['plugins']['get']('Users')['users'];return _0x2d6bd9['toolbar']=['exitToEditing','restoreRevision','changesNavigation'],delete _0x2d6bd9['lazyRoots'],(_0x2d6bd9['plugins']['push'](yt,m,R,class extends _0x4f3c67{static get['requires'](){return[m,'Users'];}['init'](){const _0x4d523a=this['editor']['plugins']['get']('Users');for(const _0x57967e of _0x12ba05)_0x57967e['isAnonymous']||_0x4d523a['getUser'](_0x57967e['id'])||_0x4d523a['addUser'](_0x57967e);const _0x4c531c=_0x3c54c9['repository']['getRevisions']();let _0x3face3=null;const _0x499181=this['editor']['plugins']['get']('RevisionViewer');_0x499181['adapter']=_0x3c54c9['adapter'],_0x499181['bind']('isEnabled')['to'](_0x3c54c9),this['editor']['commands']['get']('restoreRevision')['bind']('isEnabled')['to'](_0x54096b,'isReadOnly',_0xa87b28=>!_0xa87b28);for(const _0xae896 of _0x4c531c){const _0x339763=null===_0xae896['creator'];if(_0x339763&&_0xae896['toVersion']===_0xae896['fromVersion'])continue;const _0x48f5c9=_0xae896['toJSON']();_0x499181['addRevisionData'](_0x48f5c9,(_0x120098,_0x52cd53,_0x30a03a)=>{if(_0x339763){if(_0x3face3)_0x3face3['_update'](_0x120098,_0x52cd53);else{if(!_0x52cd53){const _0x2a6ffd=_0x30a03a['toJSON']();_0x2a6ffd['id']=_0x344b24(),_0x3c54c9['saveRevision'](_0x2a6ffd,_0x30a03a['toVersion'])['then'](_0xba4112=>{_0x3face3=_0xba4112;});}}}else _0xae896['_update'](_0x120098,_0x52cd53);});}}},d),_0x2d6bd9);}['_enhanceShowRevisionViewerCallback'](){const _0x5641df=this['editor']['config']['get']('revisionHistory')['showRevisionViewerCallback'];this['editor']['config']['set']('revisionHistory.showRevisionViewerCallback',async()=>{this['editor']['enableReadOnlyMode']('revision-history-viewer-opened');const _0xd53d60=this['editor']['plugins']['get']('RevisionTracker');if(this['editor']['plugins']['has']('Autosave')){const _0x902279=this['editor']['plugins']['get']('Autosave');await _0x902279['save']();}else await _0xd53d60['update']();if(this['editor']['plugins']['has']('PaginationLookup')&&this['editor']['plugins']['get']('PaginationLookup')['_recalculatePageBreaks'](),this['editor']['plugins']['has']('Dialog')){const _0x5f0c51=this['editor']['plugins']['get']('Dialog');_0x5f0c51['isOpen']&&_0x5f0c51['hide']();}const _0xb71b1b=this['_getRevisionViewerEditorConfig']();return _0x5641df(_0xb71b1b)['then'](_0x56828=>{return(this['_viewerEditor']=_0x56828,this['editor']['plugins']['has']('Annotations'))&&this['editor']['plugins']['get']('Annotations')['refreshVisibility'](),(this['editor']['plugins']['has']('DocumentOutline')&&(this['editor']['plugins']['get']('DocumentOutlineUI')['view']['element']['style']['display']='none'),_0x56828);})['catch'](_0x2b5e97=>(console['error'](_0x2b5e97),this['editor']['disableReadOnlyMode']('revision-history-viewer-opened'),null));});}['_enhanceCloseRevisionViewerCallback'](){const _0x530940=this['editor']['config']['get']('revisionHistory')['closeRevisionViewerCallback'];this['editor']['config']['set']('revisionHistory.closeRevisionViewerCallback',()=>(this['editor']['plugins']['has']('PaginationLookup')&&this['editor']['plugins']['get']('PaginationLookup')['_recalculatePageBreaks'](),this['editor']['plugins']['has']('DocumentOutline')&&(this['editor']['plugins']['get']('DocumentOutlineUI')['view']['element']['style']['display']=''),this['_viewerEditor']['plugins']['get']('RevisionViewer')['_cleanUp'](),_0x530940(this['_viewerEditor'])['then'](()=>{if(this['editor']['disableReadOnlyMode']('revision-history-viewer-opened'),this['_viewerEditor']=null,this['editor']['plugins']['has']('Annotations')){const _0x5032=this['editor']['plugins']['get']('Annotations');_0x5032['refreshVisibility'](),_0x5032['refreshPositioning']();}})));}['_showRevisionViewer'](_0x51cb5a){const _0x5b394d=this['editor']['config']['get']('revisionHistory.editorContainer'),_0x4c26d2=this['editor']['config']['get']('revisionHistory.viewerContainer'),_0x183d23=this['editor']['config']['get']('revisionHistory.viewerEditorElement');return w['create'](_0x183d23,_0x51cb5a)['then'](_0x1402d1=>(_0x4c26d2['style']['display']='block',_0x5b394d['style']['display']='none',this['isRevisionViewerOpen']=!0x0,_0x1402d1));}['_closeRevisionViewer'](_0x244152){const _0x42ae5e=this['editor']['config']['get']('revisionHistory.editorContainer');return this['editor']['config']['get']('revisionHistory.viewerContainer')['style']['display']='none',_0x42ae5e['style']['display']='',this['isRevisionViewerOpen']=!0x1,_0x244152['destroy']();}async['_restoreRevision'](_0x574ed3){const _0x23572d=this['editor'],_0x12e981=this['_viewerEditor']['plugins']['get']('RevisionViewer'),_0x542abc=_0x23572d['plugins']['get']('RevisionTracker'),_0x24d466=_0x23572d['plugins']['get']('RevisionHistoryUtils'),_0x5a216f=_0x12e981['repository']['getRevision'](_0x574ed3);let _0x970441,_0x1b713d,_0x1f3d63;try{await _0x24d466['loadRevisionData'](_0x5a216f,this['adapter']),_0x970441=_0x24d466['getRevisionDocumentData'](_0x5a216f),_0x1b713d=_0x24d466['getRevisionRootsAttributes'](_0x5a216f);}catch(_0x52d896){return void console['error'](_0x52d896);}_0x23572d['model']['change'](_0xced9f8=>{for(const _0x396625 of Array['from'](_0x23572d['model']['markers']['getMarkersGroup']('restrictedEditingException')))_0xced9f8['removeMarker'](_0x396625);}),_0x12e981['isReady']=!0x1,_0x23572d['model']['enqueueChange'](_0x5ddb58=>{_0x5ddb58['setSelection'](null),_0x5ddb58['removeSelectionAttribute'](_0x23572d['model']['document']['selection']['getAttributeKeys']());const _0x5f03d0=Object['keys'](_0x970441);for(const _0x160afa of _0x23572d['model']['document']['roots'])'$graveyard'!=_0x160afa['rootName']&&_0x160afa['isAttached']()&&!_0x5f03d0['includes'](_0x160afa['rootName'])&&_0x5ddb58['detachRoot'](_0x160afa);for(const _0x30ac26 of _0x5f03d0){let _0x50f26a=_0x23572d['model']['document']['getRoot'](_0x30ac26);_0x50f26a&&_0x50f26a['isAttached']()||(_0x50f26a=_0x5ddb58['addRoot'](_0x30ac26));const _0x280016=_0x1b713d[_0x30ac26],_0x433fe0=Object['keys'](_0x280016),_0x4a5d3f=_0x970441[_0x30ac26];for(const _0x349900 of _0x50f26a['getAttributeKeys']())_0x433fe0['includes'](_0x349900)||_0x5ddb58['removeAttribute'](_0x349900,_0x50f26a);for(const _0x412009 of _0x433fe0)_0x5ddb58['setAttribute'](_0x412009,_0x1b713d[_0x30ac26][_0x412009],_0x50f26a);_0x5ddb58['remove'](_0x5ddb58['createRangeIn'](_0x50f26a)),_0x5ddb58['insert'](_0x23572d['data']['parse'](_0x4a5d3f,_0x50f26a),_0x50f26a,0x0);}});const _0x33e367=g(_0x23572d['locale'],'Restored');if(_0x5a216f['name'])_0x1f3d63=-0x1==_0x5a216f['name']['indexOf'](_0x33e367)?_0x33e367+':\x20'+_0x5a216f['name']:_0x5a216f['name'];else _0x1f3d63=_0x33e367+':\x20'+(_0x5a216f['createdAt']['toLocaleDateString'](_0x23572d['locale']['uiLanguage'],{'month':'long','day':'numeric'})+',\x20'+_0x5a216f['createdAt']['toLocaleTimeString'](_0x23572d['locale']['uiLanguage'],{'hour':'numeric','minute':'numeric'}));return await _0x542abc['saveRevision']({'name':_0x1f3d63}),_0x12e981['isReady']=!0x0,_0x23572d['config']['get']('revisionHistory')['closeRevisionViewerCallback']();}}export{h as Revision,k as RevisionHistory,f as RevisionHistoryUI,V as RevisionHistoryUtils,u as RevisionTracker,m as RevisionViewer,w as RevisionViewerEditor,le as RevisionViewerLoadingOverlay,R as RevisionViewerUI,I as RevisionsRepository,d as RevisionsSidebar};